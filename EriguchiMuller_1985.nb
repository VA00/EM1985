(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    212664,       5053]
NotebookOptionsPosition[    203870,       4833]
NotebookOutlinePosition[    204343,       4851]
CellTagsIndexPosition[    204300,       4848]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Quit", "[", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.507275123100278*^9, 3.507275124377351*^9}, {
   3.507516405718161*^9, 3.5075164068292246`*^9}, 3.658661243355674*^9}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "TODO", "\[IndentingNewLine]", "\[IndentingNewLine]", "1.", " ", "Update", 
    " ", "trapezoidal", " ", "integration", " ", "with", " ", "something", 
    " ", "more", " ", "accurate"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "Gauss"}], " ", "integration", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"EM1985", " ", "used", " ", "Simpson", " ", "rule"}], ",", " ", 
       RowBox[{
       "but", " ", "only", " ", "in", " ", "radial", " ", "direction"}]}], 
      ")"}], "\[IndentingNewLine]", "2.", " ", "Update", " ", "to", " ", 
     "handle", " ", "n"}], "\[NotEqual]", 
    RowBox[{"1", " ", "polytropic", " ", 
     RowBox[{"index", ".", "\[IndentingNewLine]", "3."}], " ", "Replace", " ",
      "LegendereP", " ", "with", " ", "stable", " ", 
     RowBox[{"implementation", ".", "\[IndentingNewLine]", "4."}], " ", 
     "Replace", " ", "kernels", " ", "with", " ", "something", " ", "free", 
     " ", "of", " ", "Legendere", " ", "expansion"}]}], ",", " ", 
   RowBox[{
    RowBox[{"e", ".", "g", ".", " ", "EllipticK"}], " ", "kernels"}]}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.663583144203021*^9, 3.663583338288122*^9}}],

Cell[BoxData[
 RowBox[{"totalTimer", " ", "=", " ", 
  RowBox[{"AbsoluteTime", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.661426013983589*^9, 3.661426023978047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<http://adsabs.harvard.edu/abs/1985A%26A...146..260E\>\"", ",", 
      "\"\<HTML\>\""}], "]"}], ";"}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Uncomment", " ", "line", " ", "above", " ", "to", " ", "get", " ", 
     "main", " ", "reference", " ", "for", " ", "the", " ", 
     RowBox[{"method", ".", " ", "\[IndentingNewLine]", "Eriguchi"}]}], ",", 
    RowBox[{
     RowBox[{"Y", "."}], ";", "Mueller"}], ",", 
    RowBox[{"E", "."}], ",", " ", 
    RowBox[{"Astronomy", " ", "and", " ", "Astrophysics", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ISSN", " ", "0004"}], "-", "6361"}], ")"}]}], ",", 
    RowBox[{"vol", ".", "146"}], ",", 
    RowBox[{"no", ".", "2"}], ",", 
    RowBox[{"May", " ", "1985"}], ",", 
    RowBox[{
     RowBox[{"p", ".", "260"}], "-", "268."}]}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070894618835497`*^9, 3.507089487266001*^9}, {
   3.5070895585460787`*^9, 3.5070895775531654`*^9}, {3.5070898472195897`*^9, 
   3.507089858139214*^9}, {3.507093004962202*^9, 3.507093010187501*^9}, {
   3.641640499664193*^9, 3.64164051394601*^9}, 3.658486283601878*^9, 
   3.6584943465411386`*^9, 3.663572772720806*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"conv", " ", "\[Rule]", " ", 
     RowBox[{
     "convert", " ", "rationals", " ", "onto", " ", "machine", " ", 
      "precision", " ", "numbers"}]}], ";", " ", 
    RowBox[{
    "if", " ", "you", " ", "prefer", " ", "to", " ", "keep", " ", 
     "rationals"}]}], ",", " ", "use", " ", ",", ",", 
   RowBox[{
    RowBox[{"identity", "''"}], " ", "conv"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5077785992268653`*^9, 3.507778656450138*^9}}],

Cell[BoxData["$OperatingSystem"], "Input",
 CellChangeTimes->{{3.6578705493581047`*^9, 3.6578705527542987`*^9}}],

Cell[BoxData["$HomeDirectory"], "Input",
 CellChangeTimes->{{3.658484359260812*^9, 3.658484360819901*^9}}],

Cell[BoxData[
 RowBox[{"dir", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$OperatingSystem", "==", "\"\<Windows\>\""}], ",", 
    "\"\<H:\\\\misiek/RotatingStars/EM/SolidRotation/\>\"", ",", " ", 
    "\"\</home/misiek/RotatingStars/EM/SolidRotation/\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.657346712678154*^9, 3.65734672862111*^9}, {
  3.657437235641415*^9, 3.657437244809177*^9}, {3.65787054333876*^9, 
  3.657870589762415*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"conv", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"N", "[", "#", "]"}], "&"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.507692044454732*^9, 3.507692056254407*^9}, {
   3.507692114099715*^9, 3.507692114388732*^9}, 3.659261504592897*^9, 
   3.663566625799223*^9, 3.6635689394425554`*^9}],

Cell[BoxData[
 RowBox[{"conv", "=", 
  RowBox[{"(", 
   RowBox[{"#", " ", "&"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.507692108428391*^9, 3.5076921254843664`*^9}, 
   3.6635666229770613`*^9, 3.6635689426737404`*^9}],

Cell[BoxData[
 RowBox[{"NT", "=", "6", 
  RowBox[{"(*", " ", 
   RowBox[{"angular", " ", "rays", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"MAX", " ", "NT"}], "=", 
      RowBox[{"32", " ", "tested"}]}], ")"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5069999391570945`*^9, 3.506999940024144*^9}, {
   3.5070872597915974`*^9, 3.507087273088358*^9}, {3.507088373617304*^9, 
   3.5070883773745193`*^9}, {3.507091257554256*^9, 3.5070912576542616`*^9}, {
   3.5070914434238873`*^9, 3.50709146200895*^9}, {3.5071013966661797`*^9, 
   3.5071013967751865`*^9}, {3.5071022943815265`*^9, 
   3.5071022952205744`*^9}, {3.5072072782850547`*^9, 3.507207278568071*^9}, {
   3.5072714146471663`*^9, 3.5072714147641735`*^9}, {3.507271535965105*^9, 
   3.5072715360491104`*^9}, {3.5072751124826703`*^9, 
   3.5072751142767735`*^9}, {3.507277250019931*^9, 3.507277251340006*^9}, {
   3.507285186155386*^9, 3.507285186234396*^9}, {3.507286271639225*^9, 
   3.507286273807*^9}, {3.507286380520051*^9, 3.507286380838092*^9}, {
   3.5072945761304164`*^9, 3.5072945851729336`*^9}, {3.5072963943164105`*^9, 
   3.5072963952804656`*^9}, {3.5073073659769535`*^9, 3.507307366048958*^9}, {
   3.507438273803265*^9, 3.50743829661957*^9}, {3.507438747277346*^9, 
   3.5074387476483674`*^9}, {3.5074404160177927`*^9, 3.507440416391814*^9}, {
   3.507445302789632*^9, 3.507445306766859*^9}, {3.5074735847524505`*^9, 
   3.5074735848744574`*^9}, {3.5074740968487406`*^9, 
   3.5074740977157907`*^9}, {3.5075147686495256`*^9, 3.507514772305735*^9}, {
   3.507515843162985*^9, 3.5075158434900036`*^9}, {3.507516398653757*^9, 
   3.5075164036060405`*^9}, {3.507517486078954*^9, 3.5075174885660963`*^9}, {
   3.507546831205659*^9, 3.50754683174969*^9}, {3.507550666249011*^9, 
   3.507550667588088*^9}, {3.5075594011716204`*^9, 3.5075594036437616`*^9}, {
   3.5076085447829485`*^9, 3.507608545657999*^9}, {3.5076090661767707`*^9, 
   3.507609066670799*^9}, {3.5076094666806784`*^9, 3.5076094673517165`*^9}, {
   3.5076097443935623`*^9, 3.5076097447795844`*^9}, {3.5076126358009415`*^9, 
   3.5076126366759915`*^9}, {3.507647851236143*^9, 3.5076478522492013`*^9}, {
   3.5076493789035206`*^9, 3.507649379267542*^9}, {3.507650111710435*^9, 
   3.5076501120374537`*^9}, {3.5076507699360833`*^9, 
   3.5076507704241114`*^9}, {3.50768833616263*^9, 3.5076883377807226`*^9}, {
   3.5076905989840555`*^9, 3.50769059957909*^9}, {3.5076924641851215`*^9, 
   3.5076924647271523`*^9}, {3.507694476743233*^9, 3.507694477311266*^9}, {
   3.507695106591258*^9, 3.5076951076253176`*^9}, {3.5076977541396894`*^9, 
   3.507697754290698*^9}, {3.507698468644557*^9, 3.5076984690015774`*^9}, {
   3.5077027493664*^9, 3.5077027498684287`*^9}, 3.5077078120729704`*^9, {
   3.507708789843896*^9, 3.507708790058908*^9}, {3.5077194507418413`*^9, 
   3.5077194514088793`*^9}, 3.507720269608678*^9, {3.507720440969479*^9, 
   3.5077204418715305`*^9}, {3.5077215736542645`*^9, 3.5077215737512703`*^9}, 
   3.507734399144841*^9, {3.507735192213202*^9, 3.5077351928632393`*^9}, {
   3.507778700099635*^9, 3.507778701497715*^9}, {3.5078948226079855`*^9, 
   3.507894823527038*^9}, {3.507905574224943*^9, 3.5079055747759743`*^9}, {
   3.508136938787391*^9, 3.5081369391024094`*^9}, {3.5089079653014755`*^9, 
   3.50890796538348*^9}, {3.5255048094689565`*^9, 3.525504810454013*^9}, {
   3.657280008943184*^9, 3.657280009686226*^9}, {3.6572810220961328`*^9, 
   3.657281045383465*^9}, {3.657286140764904*^9, 3.6572861419549723`*^9}, {
   3.657437250937127*^9, 3.657437251753129*^9}, {3.657439378690579*^9, 
   3.6574393862419643`*^9}, {3.657446588005608*^9, 3.657446602340404*^9}, {
   3.65752372649645*^9, 3.657523731888152*^9}, {3.657524245739304*^9, 
   3.657524246554991*^9}, {3.658482980745965*^9, 3.6584829810729837`*^9}, {
   3.65848501609138*^9, 3.6584850171224394`*^9}, {3.658643026674111*^9, 
   3.658643039041862*^9}, {3.658661229780395*^9, 3.658661230226905*^9}, {
   3.659251949408882*^9, 3.659251950800624*^9}, {3.6592591726884127`*^9, 
   3.65925917460809*^9}, {3.659261657268848*^9, 3.659261661428274*^9}, 
   3.659337226271578*^9, 3.659337787674045*^9, {3.6596905701770563`*^9, 
   3.659690582784438*^9}, {3.660974197747651*^9, 3.6609741981948557`*^9}, {
   3.6609745871838913`*^9, 3.6609745872788353`*^9}, {3.6609747236462393`*^9, 
   3.660974723981893*^9}, {3.6609752338011208`*^9, 3.660975283207003*^9}, {
   3.660975436294873*^9, 3.660975436694044*^9}, {3.660975501766226*^9, 
   3.6609755093488417`*^9}, {3.660975609797689*^9, 3.6609756116994963`*^9}, {
   3.660975772226019*^9, 3.660975772353629*^9}, {3.6609761257588882`*^9, 
   3.660976126286375*^9}, {3.6609766406495028`*^9, 3.660976643192506*^9}, {
   3.6609776237592907`*^9, 3.660977624638331*^9}, {3.6609779123003283`*^9, 
   3.6609779125865088`*^9}, {3.660978264855836*^9, 3.660978265111657*^9}, {
   3.6609930833466797`*^9, 3.660993084322166*^9}, {3.6613411219134293`*^9, 
   3.661341122281067*^9}, {3.66142051241676*^9, 3.661420513416648*^9}, {
   3.661420972917644*^9, 3.661420973333199*^9}, {3.6614232746384277`*^9, 
   3.661423275205963*^9}, {3.6614253770700827`*^9, 3.661425378029893*^9}, {
   3.661425702043994*^9, 3.6614257027397137`*^9}, {3.661426242024844*^9, 
   3.661426242840111*^9}, {3.661427291169406*^9, 3.661427291441064*^9}, {
   3.661492414738125*^9, 3.661492415337737*^9}, {3.661593022849976*^9, 
   3.661593024304572*^9}, {3.661658434303123*^9, 3.661658436378724*^9}, {
   3.661859133843308*^9, 3.6618591342901583`*^9}, {3.6622699007083063`*^9, 
   3.6622699021479397`*^9}, {3.6635662497367134`*^9, 3.663566250536759*^9}, {
   3.663569116957709*^9, 3.663569117540742*^9}, {3.6635693919634385`*^9, 
   3.663569392498469*^9}, {3.6635727407229767`*^9, 3.6635727410359945`*^9}, {
   3.6705628322975388`*^9, 3.670562832616557*^9}}],

Cell[BoxData[
 RowBox[{"NR", "=", "7", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"radial", " ", "slices"}], ",", " ", 
    RowBox[{"including", " ", "surface"}], ",", " ", 
    RowBox[{"without", " ", "center", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAX", " ", "NR"}], "=", 
       RowBox[{"32", " ", "tested"}]}], " ", ")"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.507000077681018*^9, 3.507000079730135*^9}, {
   3.50700320429585*^9, 3.507003204507862*^9}, {3.5070872747834544`*^9, 
   3.5070873028100576`*^9}, {3.507088379533643*^9, 3.5070883798556614`*^9}, {
   3.5071013987502995`*^9, 3.5071013997593565`*^9}, {3.507102297657714*^9, 
   3.507102297847725*^9}, {3.5072072812942266`*^9, 3.5072072813922324`*^9}, {
   3.507271416766288*^9, 3.5072714172373147`*^9}, {3.5072718084056883`*^9, 
   3.5072718089177175`*^9}, {3.5072725679671326`*^9, 3.507272569724233*^9}, {
   3.507274700158087*^9, 3.5072747002380915`*^9}, {3.507275117174939*^9, 
   3.507275117283945*^9}, {3.5072772536591387`*^9, 3.5072772540391607`*^9}, {
   3.5072782411236186`*^9, 3.5072782412216244`*^9}, {3.5072851880631285`*^9, 
   3.5072851888927336`*^9}, {3.507286275820256*^9, 3.5072862765083437`*^9}, {
   3.5072863832228947`*^9, 3.5072863842725277`*^9}, {3.5072945788615723`*^9, 
   3.5072945797186213`*^9}, {3.507296397364585*^9, 3.5072963979186163`*^9}, {
   3.507307368732111*^9, 3.507307369221139*^9}, {3.507433169800333*^9, 
   3.5074331703903666`*^9}, {3.507434265493003*^9, 3.507434266420056*^9}, {
   3.5074382762554054`*^9, 3.5074383067501497`*^9}, {3.5074387496184797`*^9, 
   3.50743875976206*^9}, 3.507439980006854*^9, 3.5074404182129183`*^9, 
   3.5074453115891347`*^9, {3.5074730513239403`*^9, 3.5074730530580397`*^9}, {
   3.5074735876546164`*^9, 3.507473587800625*^9}, {3.507474100118928*^9, 
   3.507474100589955*^9}, {3.507514774089837*^9, 3.507514774208844*^9}, {
   3.5075158483542814`*^9, 3.507515849122326*^9}, {3.5075164116545005`*^9, 
   3.507516412893572*^9}, {3.50751749195829*^9, 3.5075174937743945`*^9}, {
   3.50751770331738*^9, 3.5075177044444437`*^9}, {3.5075231882631006`*^9, 
   3.5075231889291387`*^9}, {3.507550669756212*^9, 3.5075506706132607`*^9}, {
   3.507559407249968*^9, 3.5075594098661175`*^9}, {3.507609068643912*^9, 
   3.507609069722974*^9}, {3.5076094697458534`*^9, 3.5076094712319384`*^9}, {
   3.507609746636691*^9, 3.5076097470027113`*^9}, {3.5076126384280915`*^9, 
   3.50761263927814*^9}, {3.507647853647281*^9, 3.5076478540513043`*^9}, {
   3.507649381966696*^9, 3.507649382840746*^9}, {3.5076501135355396`*^9, 
   3.5076501136045437`*^9}, {3.507650771935198*^9, 3.5076507725592337`*^9}, {
   3.5076883415629387`*^9, 3.5076883418029523`*^9}, {3.507690601733213*^9, 
   3.5076906021542373`*^9}, {3.5076924668462734`*^9, 3.507692468231353*^9}, {
   3.5076944726239977`*^9, 3.5076944737960644`*^9}, {3.507702752040553*^9, 
   3.5077027531466165`*^9}, {3.507707814543112*^9, 3.5077078149251337`*^9}, {
   3.507708791706002*^9, 3.5077087920650225`*^9}, {3.5077194529669685`*^9, 
   3.5077194536100054`*^9}, 3.507720271602792*^9, {3.507720444363673*^9, 
   3.5077204445026813`*^9}, {3.5077215755653744`*^9, 3.5077215782265263`*^9}, 
   3.5077351952163734`*^9, 3.507778703930854*^9, {3.5077798356555853`*^9, 
   3.507779836858654*^9}, {3.50780110548645*^9, 3.507801106129487*^9}, {
   3.5078095248940125`*^9, 3.507809528906242*^9}, {3.5078948249121175`*^9, 
   3.5078948256941624`*^9}, {3.507905576984101*^9, 3.5079055771551104`*^9}, {
   3.5081369410985236`*^9, 3.5081369419425716`*^9}, {3.5089079676376085`*^9, 
   3.5089079681216364`*^9}, {3.508909038274846*^9, 3.5089090385158596`*^9}, 
   3.525504812389124*^9, {3.6572800123583794`*^9, 3.657280012630395*^9}, {
   3.6572810478396053`*^9, 3.6572810486396513`*^9}, {3.6572861439950886`*^9, 
   3.6572861449471436`*^9}, {3.657437254041092*^9, 3.657437257528936*^9}, {
   3.6574393817145033`*^9, 3.657439389601565*^9}, {3.657446604869203*^9, 
   3.6574466059409447`*^9}, {3.657523734480571*^9, 3.657523735744114*^9}, {
   3.65752424906739*^9, 3.65752425005939*^9}, {3.6584830087055645`*^9, 
   3.658483009048584*^9}, {3.658485019075551*^9, 3.658485020338623*^9}, {
   3.65864303313802*^9, 3.658643047505837*^9}, {3.658661232483818*^9, 
   3.6586612334269*^9}, {3.659251954704706*^9, 3.659251956093524*^9}, {
   3.659259176944697*^9, 3.659259178176139*^9}, {3.659261664084529*^9, 
   3.659261664692492*^9}, 3.659337228559617*^9, 3.659337793305519*^9, {
   3.659690585040484*^9, 3.659690585136026*^9}, {3.660974200307626*^9, 
   3.660974202179605*^9}, {3.660974589231779*^9, 3.66097458931087*^9}, {
   3.660974725470244*^9, 3.660974725549371*^9}, {3.660975235848104*^9, 
   3.660975285015432*^9}, {3.660975438230484*^9, 3.660975438309503*^9}, {
   3.660975503381742*^9, 3.660975511092698*^9}, {3.660975613300621*^9, 
   3.6609756133953953`*^9}, {3.660975774002877*^9, 3.6609757740662622`*^9}, {
   3.660976128142992*^9, 3.660976128398233*^9}, {3.660976644777296*^9, 
   3.6609766449207487`*^9}, {3.660977626206708*^9, 3.6609776266857147`*^9}, {
   3.66097778918143*^9, 3.6609777893879147`*^9}, {3.6609779142387447`*^9, 
   3.660977914666565*^9}, {3.6609782668563433`*^9, 3.66097826762376*^9}, {
   3.660993086434203*^9, 3.660993086833665*^9}, {3.661341124016808*^9, 
   3.6613411242331867`*^9}, {3.661420515888693*^9, 3.661420520792575*^9}, {
   3.661420975381627*^9, 3.661420975653425*^9}, {3.661423278197856*^9, 
   3.661423279845893*^9}, {3.661425379589943*^9, 3.661425380573811*^9}, {
   3.6614257044439898`*^9, 3.6614257055317373`*^9}, {3.661426873252619*^9, 
   3.661426873755838*^9}, {3.661427457048348*^9, 3.6614274578715763`*^9}, {
   3.6614924171537247`*^9, 3.661492418033716*^9}, {3.661593026545248*^9, 
   3.6615930268484*^9}, {3.661658438270952*^9, 3.6616584404786377`*^9}, {
   3.6618591369468307`*^9, 3.661859137522015*^9}, {3.6635662522968597`*^9, 
   3.6635662526088777`*^9}, {3.6635691203409023`*^9, 
   3.6635691218849907`*^9}, {3.6635693943715763`*^9, 3.663569394698595*^9}, {
   3.66357274270709*^9, 3.663572743091112*^9}, {3.670562834312654*^9, 
   3.6705628350726976`*^9}}],

Cell[BoxData[
 RowBox[{"NL", "=", "8", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "Legendre", " ", "polynomials", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAX", " ", "NL"}], "=", 
       RowBox[{"20", " ", "tested"}]}], ")"}], ".", " ", 
     RowBox[{"WARNING", ":", " ", 
      RowBox[{"too", " ", "large", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "NL"}], "=", "32"}], ")"}], " ", 
       "number", " ", "of", " ", "Legendere", " ", "polynomials", " ", 
       "might", " ", "cause", " ", "numerical", " ", "instability", " ", 
       "and", " ", "catastrophic", " ", 
       RowBox[{"errors", " ", "!"}]}]}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070926671708813`*^9, 3.5070926792195706`*^9}, {
   3.5072072870955586`*^9, 3.5072072884746375`*^9}, {3.507277186070273*^9, 
   3.5072771861632786`*^9}, {3.5072863895416965`*^9, 
   3.5072863896927156`*^9}, {3.5072945899312057`*^9, 
   3.5072945900132103`*^9}, {3.507296401851842*^9, 3.5072964020618534`*^9}, {
   3.507306351360921*^9, 3.5073063519179525`*^9}, {3.507438279746605*^9, 
   3.507438319326869*^9}, {3.5074403859320717`*^9, 3.5074403864451013`*^9}, {
   3.507440420097026*^9, 3.5074404204360456`*^9}, {3.5074453131592245`*^9, 
   3.5074453137352576`*^9}, {3.5074735944540052`*^9, 
   3.5074735948210263`*^9}, {3.50747410208304*^9, 3.507474103265108*^9}, {
   3.507514775865939*^9, 3.507514775960944*^9}, {3.507515851738475*^9, 
   3.507515852209502*^9}, {3.5075225426391726`*^9, 3.5075225429641914`*^9}, {
   3.5076085371745133`*^9, 3.507608538287577*^9}, 3.507647857313491*^9, 
   3.5076507779605427`*^9, 3.5076883443390975`*^9, 3.5076903139567533`*^9, {
   3.5077352011287117`*^9, 3.507735201476732*^9}, {3.507779840043836*^9, 
   3.507779883141301*^9}, {3.5077911438173747`*^9, 3.50779114408339*^9}, {
   3.507801114384959*^9, 3.5078011145999713`*^9}, {3.5079055794792433`*^9, 
   3.5079055795682487`*^9}, {3.6575237392323503`*^9, 3.657523739664226*^9}, {
   3.657524252554977*^9, 3.65752425337064*^9}, {3.658483028065672*^9, 
   3.658483028136676*^9}, {3.658661236675501*^9, 3.658661236803491*^9}, {
   3.659259180032249*^9, 3.6592591805441628`*^9}, {3.6592616676685658`*^9, 
   3.6592616761963177`*^9}, {3.6593372308154907`*^9, 
   3.6593372341272383`*^9}, {3.659337795337673*^9, 3.6593377958645287`*^9}, {
   3.659347632879388*^9, 3.6593476339341784`*^9}, {3.659675593168861*^9, 
   3.659675600192498*^9}, {3.6596757175157003`*^9, 3.6596757197905197`*^9}, {
   3.659676257896892*^9, 3.659676258456184*^9}, {3.659677023054994*^9, 
   3.659677023934681*^9}, {3.659777040911091*^9, 3.65977704711804*^9}, {
   3.660974204323566*^9, 3.660974204738798*^9}, {3.6609745909110203`*^9, 
   3.66097459099111*^9}, {3.660974727006548*^9, 3.660974727069388*^9}, {
   3.6609752376570253`*^9, 3.6609752865833607`*^9}, {3.6609754397986383`*^9, 
   3.660975439861511*^9}, {3.6609755050778637`*^9, 3.6609755127248383`*^9}, {
   3.6609756150606194`*^9, 3.6609756152194977`*^9}, {3.660975775554927*^9, 
   3.6609757756178913`*^9}, {3.660976130238997*^9, 3.660976130686082*^9}, {
   3.660976646520727*^9, 3.660976646584858*^9}, {3.660977526624569*^9, 
   3.6609775271355953`*^9}, {3.6609776283674383`*^9, 3.660977628653458*^9}, {
   3.6609782691122017`*^9, 3.660978269463797*^9}, {3.660993089058323*^9, 
   3.660993089426*^9}, {3.66142052257675*^9, 3.6614205235446577`*^9}, {
   3.6614209774536963`*^9, 3.661420977693576*^9}, {3.661423281654078*^9, 
   3.6614232826460648`*^9}, {3.6614257068200073`*^9, 3.661425708419799*^9}, 
   3.661492419529724*^9, {3.661593029681493*^9, 3.6615930300329943`*^9}, {
   3.6616584431189547`*^9, 3.661658443566958*^9}, {3.66185913968281*^9, 
   3.6618591409141607`*^9}, {3.6635662539609547`*^9, 3.66356625423297*^9}, {
   3.66356912519718*^9, 3.6635691255331993`*^9}, {3.6635693968027153`*^9, 
   3.6635693971307335`*^9}, {3.6635727450032215`*^9, 3.66357274585927*^9}}],

Cell[BoxData[
 RowBox[{"R", " ", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"\"\<R\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"radius", " ", "of", " ", "the", " ", "stellar", " ", "surface"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.506999862689721*^9, 3.5069998789156485`*^9}, {
   3.506999929860563*^9, 3.5069999357138977`*^9}, {3.506999965950627*^9, 
   3.506999994067235*^9}, {3.5076126405472126`*^9, 3.507612641739281*^9}, {
   3.5077014139120164`*^9, 3.507701452824242*^9}, {3.5077787189717145`*^9, 
   3.507778723534975*^9}, 3.657446616356412*^9, 3.658483035514098*^9, 
   3.658643060146208*^9, 3.66097524788*^9, 3.660975306999943*^9, 
   3.670564574405182*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"j", "/", "NR"}], "*", 
        RowBox[{"R", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], "//", "conv"}]}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"discretized", " ", "radial", " ", "grid", " ", "coordinates"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.50700001338834*^9, 3.5070001173872886`*^9}, {
   3.5074335677190924`*^9, 3.507433568136116*^9}, {3.5074383234761057`*^9, 
   3.507438323745122*^9}, {3.5074460003825316`*^9, 3.507446000771554*^9}, {
   3.507688351675517*^9, 3.5076883577788663`*^9}, {3.5077014548063555`*^9, 
   3.50770145575841*^9}, {3.5077787369807444`*^9, 3.5077787555988092`*^9}, 
   3.657446627445154*^9, 3.660975253032539*^9, 3.6609753112559757`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]r", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/", "NR"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], "//", "conv"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"trapezoidal", " ", "integration", " ", "rule"}], ",", " ", 
    RowBox[{"central", " ", "point", " ", "not", " ", "included"}], ",", " ", 
    RowBox[{"surface", " ", "weigth", " ", "assumed", " ", "ZERO"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.507005420112587*^9, 3.5070054568346877`*^9}, {
   3.507091619952984*^9, 3.507091672230974*^9}, {3.507433574042454*^9, 
   3.507433574468478*^9}, {3.507438331202548*^9, 3.507438331634573*^9}, {
   3.5074460061698627`*^9, 3.507446006508882*^9}, {3.5076883623241262`*^9, 
   3.507688362684147*^9}, {3.507701465362959*^9, 3.507701467877103*^9}, 
   3.657446630676011*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "*", 
        RowBox[{"i", "/", 
         RowBox[{"(", 
          RowBox[{"NT", "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"NT", "-", "1"}]}], "}"}]}], "]"}], "//", "conv"}]}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   RowBox[{"angular", " ", "grid"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070001792198253`*^9, 3.5070002821447124`*^9}, {
   3.5074335813638725`*^9, 3.507433582003909*^9}, {3.50743833578281*^9, 
   3.5074383384729643`*^9}, {3.5074460113021564`*^9, 
   3.5074460116571765`*^9}, {3.5076883672114058`*^9, 3.507688367563426*^9}, {
   3.5077014832869844`*^9, 3.507701484331044*^9}, {3.5077787717937355`*^9, 
   3.507778776172986*^9}, 3.660975316135915*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]\[Theta]", "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], "/", "2"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"NT", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], "/", "2"}], "}"}]}], "]"}], " ",
      "//", "conv"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"trapezoidal", " ", "rule"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.50700534603835*^9, 3.507005369691703*^9}, {
   3.5070911960887403`*^9, 3.5070912214471908`*^9}, {3.5070912537560387`*^9, 
   3.507091270163977*^9}, {3.5070913382078695`*^9, 3.5070913704017105`*^9}, {
   3.5070914763377695`*^9, 3.5070914831491594`*^9}, {3.5074335899803658`*^9, 
   3.50743359040739*^9}, {3.5074383423961887`*^9, 3.507438342667204*^9}, {
   3.507446015634404*^9, 3.507446016017426*^9}, {3.50768837270072*^9, 
   3.507688373004737*^9}, {3.507701487939251*^9, 3.507701489240325*^9}, 
   3.657446639509211*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<\[Rho]\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<x\>\"", "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "unknown", " ", "densities", " ", "at", " ", "grid", " ", "points"}], ";",
     " ", 
    RowBox[{"zero", " ", "at", " ", "surface"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070013888920145`*^9, 3.5070014724917965`*^9}, {
   3.5070015040926037`*^9, 3.507001520266529*^9}, {3.507546951397534*^9, 
   3.5075469814592533`*^9}, {3.507547058276647*^9, 3.507547062508889*^9}, {
   3.5077787993833137`*^9, 3.507778829751051*^9}, 3.6574466456691427`*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"\[CapitalOmega]", "=", 
   RowBox[{"(", 
    RowBox[{"\[CapitalOmega]0", "&"}], ")"}], " ", 
   RowBox[{"(*", 
    RowBox[{"solid", " ", "body", " ", "rotation"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5074452177997704`*^9, 3.507445232325601*^9}, {
   3.5074452789072657`*^9, 3.5074452869117236`*^9}, {3.5076131645981865`*^9, 
   3.507613172058614*^9}, {3.5079055990643635`*^9, 3.5079056054237275`*^9}, 
   3.6572800346566544`*^9, 3.657281082105565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[CapitalOmega]", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalOmega]0", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"#", "^", "2"}], "/", 
          RowBox[{"A", "^", "2"}]}]}], ")"}]}], "&"}], ")"}]}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"j", "-", 
    RowBox[{"const", " ", "rotation", " ", "law"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072952811287403`*^9, 3.5072953005858526`*^9}, {
   3.50744520486003*^9, 3.507445212186449*^9}, {3.507778837502494*^9, 
   3.5077788460819845`*^9}, 3.6572810746401377`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"-", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Zeta]", " ", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "\[Zeta]", "]"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]", ",", "0", ",", "x"}], "}"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5072749843903437`*^9, 3.5072749847063622`*^9}, {
   3.507275149987816*^9, 3.5072751501248236`*^9}, {3.507278140165844*^9, 
   3.5072781406658726`*^9}, 3.5072782637329116`*^9, 3.507278337904154*^9, {
   3.507278403673916*^9, 3.50727840374292*^9}, 3.5072786230424633`*^9, {
   3.5072787122795672`*^9, 3.5072787124285755`*^9}, {3.507295401903648*^9, 
   3.507295467771415*^9}, 3.6575237568182487`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Refine", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{"x", ">", "0"}], "&&", 
     RowBox[{"A", ">", "0"}]}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5074453477942057`*^9, 3.507445378954988*^9}, 
   3.65752375920151*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"\[CapitalPhi]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     SuperscriptBox["#", "2"], " ", 
     SuperscriptBox["\[CapitalOmega]0", "2"]}], "&"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"solid", " ", "body", " ", "rotation"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.507295486700498*^9, 3.50729550666364*^9}, {
   3.50729572258899*^9, 3.5072957358227468`*^9}, {3.507690614948969*^9, 
   3.507690618049146*^9}, {3.5079056097499747`*^9, 3.507905614274234*^9}, 
   3.6572800606901436`*^9, 3.6572810965443907`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[CapitalPhi]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "^", "2"}], 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalOmega]0", "^", "2"}], "/", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"#", "^", "2"}], "/", 
          RowBox[{"A", "^", "2"}]}]}], ")"}]}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["A", "2"], " ", 
      SuperscriptBox["\[CapitalOmega]0", "2"]}]}], "&"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"centrifugal", " ", "potential"}], ";", " ", 
    RowBox[{"normalized", " ", "to", " ", "zero", " ", "at", " ", 
     RowBox[{"center", " ", "!"}]}]}], " ", "*)"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5074404308956437`*^9, 3.507440452738893*^9}, {
   3.5074406692812786`*^9, 3.50744068417113*^9}, 3.5074454044374456`*^9, {
   3.5074731040269547`*^9, 3.507473107182135*^9}, {3.5074738537558365`*^9, 
   3.507473859466163*^9}, {3.507778850292226*^9, 3.507778865650104*^9}, 
   3.657281090854066*^9}],

Cell[BoxData[
 RowBox[{"\[CapitalPhi]C", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.507778873122531*^9, 3.5077788762367096`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"\[CapitalPhi]C", "[", "x", "]"}], ",", 
    RowBox[{"x", "\[Rule]", "Infinity"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.507778884357174*^9, 3.507778894691765*^9}, 
   3.657523764015202*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"kernel0", "[", 
     RowBox[{
      RowBox[{"ra_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
      RowBox[{"rb_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
      RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"rb", "^", 
           RowBox[{"(", 
            RowBox[{"2", "n"}], ")"}]}], "/", 
          RowBox[{"ra", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", " ", "n"}], ",", " ", "Cos\[Theta]a"}], "]"}], "*", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", "n"}], " ", ",", "Cos\[Theta]b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "nLeg"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ra", "^", 
           RowBox[{"(", 
            RowBox[{"2", "n"}], ")"}]}], "/", 
          RowBox[{"rb", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", " ", "n"}], ",", " ", "Cos\[Theta]a"}], "]"}], "*", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", "n"}], " ", ",", "Cos\[Theta]b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "nLeg"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.507438428518114*^9, 3.5074385456068115`*^9}, {
   3.5074386156118155`*^9, 3.507438628039526*^9}, {3.5074388330972548`*^9, 
   3.5074388360294223`*^9}, 3.507439050142669*^9, 3.5074391073129387`*^9, {
   3.5074398373596954`*^9, 3.5074398488463526`*^9}, 3.507461132722235*^9, {
   3.5075221409411974`*^9, 3.507522215945487*^9}, {3.5076133116856003`*^9, 
   3.507613316710887*^9}, {3.5076478832459745`*^9, 3.5076478855041037`*^9}, {
   3.507650506376009*^9, 3.507650515165511*^9}, {3.5076508003818245`*^9, 
   3.5076508042450457`*^9}, {3.507702785886489*^9, 3.5077027943709745`*^9}, {
   3.659675776733437*^9, 3.659675782350647*^9}, {3.659689392639531*^9, 
   3.6596893975658293`*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CCompilerDriver`\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DefaultCCompiler", "[", "]"}]], "Input"],

Cell[BoxData["$CCompiler"], "Input",
 CellChangeTimes->{{3.5076487220409503`*^9, 3.5076487220419507`*^9}}],

Cell[BoxData[
 RowBox[{"$CCompiler", "=", 
  RowBox[{"DefaultCCompiler", "[", "]"}]}]], "Input",
 CellChangeTimes->{3.5076488032365947`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rb", "^", 
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}]}], "/", 
       RowBox[{"ra", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507689464916191*^9, 3.507689509395735*^9}, 
   3.5076906369382267`*^9, {3.5076950391223993`*^9, 3.5076950423725853`*^9}, 
   3.6596886062641478`*^9, {3.659688814053831*^9, 3.6596888164206743`*^9}, {
   3.659689126738173*^9, 3.659689128033052*^9}, {3.6596892247531013`*^9, 
   3.659689237839781*^9}, {3.659689621500389*^9, 3.6596896513353357`*^9}, {
   3.659690342085038*^9, 3.659690342434844*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1NEW", "=", 
   RowBox[{"part1", "//", "HornerForm"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659688613585133*^9, 3.659688617526916*^9}, 
   3.659688656408658*^9, {3.659689130210526*^9, 3.659689136433375*^9}, {
   3.659689228144617*^9, 3.659689232576748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ra", "^", 
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}]}], "/", 
       RowBox[{"rb", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076895216674366`*^9, 3.5076895310359726`*^9}, 
   3.507690639825392*^9, {3.5076950474138737`*^9, 3.5076950489799633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2NEW", "=", 
   RowBox[{"part2", "//", "HornerForm"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6596769704956617`*^9, 3.659676986222657*^9}, {
  3.659689177425458*^9, 3.6596891839848003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1Da", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "ra"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507689902179201*^9, 3.507689927845669*^9}, 
   3.5076906419355125`*^9, {3.507695051809125*^9, 3.507695053255208*^9}, {
   3.657437286856653*^9, 3.657437287992927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1Db", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "rb"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899397653503`*^9, 3.5076899421784887`*^9}, 
   3.507690644229644*^9, {3.5076950585145082`*^9, 3.507695060200605*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2Da", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "ra"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899598585*^9, 3.5076899784725647`*^9}, 
   3.5076906468167915`*^9, {3.507695063993822*^9, 3.5076950653539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2Db", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "rb"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899944314775`*^9, 3.5076900005278263`*^9}, 
   3.5076906493359356`*^9, {3.507695069766152*^9, 3.5076950713472424`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kernel5", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
         RowBox[{
          RowBox[{"Evaluate", "[", "part1", "]"}], "//", "Evaluate"}], ",", 
         RowBox[{"Evaluate", "[", "part2", "]"}]}], "]"}], "//", "Evaluate"}],
       ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "False"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "kernel", " ", "seems", " ", "to", " ", "be", " ", 
     "fastest"}], ";", " ", 
    RowBox[{
    "tested", " ", "on", " ", "Microsoft", " ", "Visual", " ", "Studio", " ", 
     "Compiler"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5076895352162113`*^9, 3.507689569843192*^9}, {
   3.507689612955658*^9, 3.5076896698039093`*^9}, 3.507690367556819*^9, {
   3.507778970571105*^9, 3.5077789939484425`*^9}, {3.6596760297236147`*^9, 
   3.659676044298897*^9}, 3.6596760853555*^9, {3.659676139402717*^9, 
   3.659676140569154*^9}, {3.659676614276845*^9, 3.65967661558779*^9}, {
   3.659677045678934*^9, 3.65967704902274*^9}, {3.6609769578147573`*^9, 
   3.6609769662457523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kernel5Da", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
         RowBox[{"Evaluate", "[", "part1Da", "]"}], ",", 
         RowBox[{"Evaluate", "[", "part2Da", "]"}]}], "]"}], "//", 
       "Evaluate"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"derivatives", " ", "of", " ", "the", " ", "kernel"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5076900708688493`*^9, 3.507690080796417*^9}, 
   3.5076903715680485`*^9, {3.5077790051120806`*^9, 3.507779014526619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kernel5Db", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
        RowBox[{"Evaluate", "[", "part1Db", "]"}], ",", 
        RowBox[{"Evaluate", "[", "part2Db", "]"}]}], "]"}], "//", 
      "Evaluate"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507690092574091*^9, 3.5076900974423695`*^9}, 
   3.5076903737211714`*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"kernel", "[", 
     RowBox[{
      RowBox[{"ra_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
      RowBox[{"rb_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
      RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"kernel5", "[", 
     RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "wrapper", " ", "for", " ", "convenient", " ", "use", " ", "within", " ",
       "Mathematica"}], ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "this", " ", "slow", " ", "down", " ", "by", 
      " ", "a", " ", "factor", " ", "of", " ", "two"}]}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.50769012141274*^9, 3.507690121493745*^9}, {
  3.5077790203389516`*^9, 3.507779053585853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"kernel0", "[", 
     RowBox[{
      RowBox[{"9", "/", "10"}], ",", 
      RowBox[{"4", "/", "10"}], ",", 
      RowBox[{"3", "/", "10"}], ",", 
      RowBox[{"1", "/", "10"}], ",", 
      RowBox[{"2", "^", "nl"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"nl", ",", "0", ",", "10", ",", "1"}], "}"}]}], "]"}], "//", 
  "N"}]], "Input",
 CellChangeTimes->{{3.659675249435577*^9, 3.659675266259985*^9}, {
  3.6596753186772203`*^9, 3.659675319891897*^9}, {3.659675802814102*^9, 
  3.659675868716927*^9}, {3.659675940940585*^9, 3.659675954988961*^9}, {
  3.6596761663138323`*^9, 3.659676188953122*^9}}],

Cell[BoxData[
 RowBox[{"kernel5", "[", 
  RowBox[{
   RowBox[{"9", "/", "10"}], ",", 
   RowBox[{"4", "/", "10"}], ",", 
   RowBox[{"3", "/", "10"}], ",", 
   RowBox[{"1", "/", "10"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.659675269292261*^9, 3.659675283588792*^9}, {
  3.659675968860121*^9, 3.659675977195347*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"kernel5", "@@", 
     RowBox[{"Join", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", "10000", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.5075202161841073`*^9, 3.507520277435611*^9}, {
   3.5075205180253716`*^9, 3.5075205183213882`*^9}, {3.507520772799944*^9, 
   3.507520778463268*^9}, {3.5075211912608786`*^9, 3.507521191539894*^9}, {
   3.507521564234211*^9, 3.5075215726756945`*^9}, 3.507612674988183*^9, {
   3.507689578650696*^9, 3.5076895791137223`*^9}, 3.661420562608382*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"kernel0", "@@", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", "4"}], "]"}], ",", 
       RowBox[{"{", "NL", "}"}]}], "]"}]}], ",", 
    RowBox[{"{", "10000", "}"}]}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.50752028896327*^9, 3.507520302283032*^9}, {
   3.507520508977854*^9, 3.5075205307290983`*^9}, 3.507612684855747*^9, {
   3.507651843267474*^9, 3.507651843549491*^9}, {3.507690399499646*^9, 
   3.507690400027676*^9}, {3.659689439981823*^9, 3.659689451454234*^9}, 
   3.661420566600706*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
    "kernel", "]"}], "[", 
   RowBox[{
    RowBox[{"ra_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
    RowBox[{"rb_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
    RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"kernel5Da", "[", 
   RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "derivatives", " ", "of", " ", "the", " ", "kernel", " ", "required", " ", 
    "for", " ", "Jacobian", " ", "generation"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5076901733117085`*^9, 3.5076902045174932`*^9}, {
  3.5077790819574757`*^9, 3.5077790948512135`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], "[", 
    "kernel", "]"}], "[", 
   RowBox[{
    RowBox[{"ra_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
    RowBox[{"rb_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
    RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"kernel5Db", "[", 
   RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5076902147770805`*^9, 3.5076902213224545`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vars", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"R", ",", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "\[Rho]", "]"}], ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"C", ",", "\[Rho]C", ",", "\[CapitalOmega]0"}], "}"}]}], 
     "]"}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"unknown", " ", 
     RowBox[{"variables", ":", " ", "density"}]}], ",", " ", "surface", ",", 
    " ", 
    RowBox[{"central", " ", "density"}], ",", " ", 
    RowBox[{"parameter", " ", "of", " ", "the", " ", "rotation", " ", "law"}],
     ",", " ", 
    RowBox[{"and", " ", "constant", " ", "C"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.507779102294639*^9, 3.5077791559577084`*^9}, {
   3.5079016905188074`*^9, 3.507901692352913*^9}, 3.6586431036022673`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"kernel", "[", 
    RowBox[{"ra_", ",", "\[Theta]a_", ",", "rb_", ",", "\[Theta]b_"}], "]"}], 
   ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ra", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"4", "Pi", " ", "rb", " ", 
      RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Theta]a", "\[NotEqual]", "\[Theta]b"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"4", 
            RowBox[{"EllipticK", "[", 
             FractionBox[
              RowBox[{"4", " ", "ra", " ", "rb", " ", 
               RowBox[{"Sin", "[", "\[Theta]a", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
              RowBox[{
               SuperscriptBox["ra", "2"], "+", 
               SuperscriptBox["rb", "2"], "-", 
               RowBox[{"2", " ", "ra", " ", "rb", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]a", "+", "\[Theta]b"}], "]"}]}]}]], "]"}]}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox["ra", "2"], "+", 
             SuperscriptBox["rb", "2"], "-", 
             RowBox[{"2", " ", "ra", " ", "rb", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]a", "+", "\[Theta]b"}], "]"}]}]}]]], "+", 
          FractionBox[
           RowBox[{"4", 
            RowBox[{"EllipticK", "[", 
             FractionBox[
              RowBox[{"4", " ", "ra", " ", "rb", " ", 
               RowBox[{"Sin", "[", "\[Theta]a", "]"}], " ", 
               RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], 
              RowBox[{
               SuperscriptBox["ra", "2"], "+", 
               SuperscriptBox["rb", "2"], "+", 
               RowBox[{"2", " ", "ra", " ", "rb", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]a", "-", "\[Theta]b"}], "]"}]}]}]], "]"}]}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox["ra", "2"], "+", 
             SuperscriptBox["rb", "2"], "+", 
             RowBox[{"2", " ", "ra", " ", "rb", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]a", "-", "\[Theta]b"}], "]"}]}]}]]]}], ")"}], 
        RowBox[{"rb", "^", "2"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]b", "]"}]}], "\[IndentingNewLine]", ",", 
       "0"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.507295743532188*^9, 3.507295751295632*^9}}],

Cell[BoxData["R"], "Input",
 CellChangeTimes->{3.663668522811954*^9}],

Cell[BoxData[
 RowBox[{"Most", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.6636685186457157`*^9, 3.663668520039796*^9}}],

Cell[BoxData[
 RowBox[{"vars2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Most", "[", "R", "]"}], ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "\[Rho]", "]"}], ",", "0"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"C", ",", "\[Rho]C", ",", "K"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6636685100182223`*^9, 3.663668566951479*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"potencjal", " ", "w", " ", "centrum"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.507006050245629*^9, 3.5070060558899517`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalPhi]0", "=", 
   RowBox[{
    RowBox[{"-", "4"}], " ", "Pi", " ", "G", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "l", "]"}], "]"}], "]"}], " ", 
       RowBox[{"\[CapitalDelta]\[Theta]", "[", 
        RowBox[{"[", "l", "]"}], "]"}], " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], 
          RowBox[{"\[CapitalDelta]r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
          RowBox[{"\[Rho]", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "NT"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "gravitational", " ", "potential", " ", "at", " ", "the", " ", 
      "center"}], ";", " ", 
     RowBox[{"NOTE", ":", " ", 
      RowBox[{
      "this", " ", "is", " ", "exact", " ", "discretized", " ", 
       "formula"}]}]}], ",", " ", 
    RowBox[{"no", " ", "Legendre", " ", "expansion", " ", "used"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.507087785548669*^9, 3.5070878951099353`*^9}, {
   3.507088438005987*^9, 3.507088439508073*^9}, {3.507271843024668*^9, 
   3.5072718499210625`*^9}, {3.50768843424424*^9, 3.50768843651637*^9}, {
   3.507691442954328*^9, 3.5076914504817586`*^9}, 3.507692564284847*^9, {
   3.5077791799270797`*^9, 3.5077792316950407`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eq0", "=", 
     RowBox[{
      RowBox[{"\[Rho]C", "+", 
       RowBox[{"\[CapitalPhi]C", "[", "0", "]"}], "+", "\[CapitalPhi]0"}], "==",
       "C"}]}], ";"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"center", " ", "is", " ", "treated", " ", "separately"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070879466178813`*^9, 3.507087963346838*^9}, {
   3.5072747571753483`*^9, 3.5072747622886405`*^9}, {3.5073468001420126`*^9, 
   3.507346801772106*^9}, {3.5075155591557407`*^9, 3.5075155622439175`*^9}, {
   3.507518686541617*^9, 3.5075186869736414`*^9}, {3.5075224108066325`*^9, 
   3.507522412062704*^9}, {3.507522654806588*^9, 3.507522655160609*^9}, {
   3.507550087919933*^9, 3.5075500893050117`*^9}, {3.507550805290964*^9, 
   3.5075508062800207`*^9}, {3.507612002640727*^9, 3.507612003900799*^9}, {
   3.507613339555194*^9, 3.5076133403992424`*^9}, {3.507691459630282*^9, 
   3.50769146116637*^9}, 3.507692569951171*^9, {3.5077792390764627`*^9, 
   3.507779247838964*^9}, {3.508137402416909*^9, 3.508137406818161*^9}, 
   3.6635662832816315`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eqMASS", "=", 
     RowBox[{"M", "==", 
      RowBox[{"4", " ", "Pi", " ", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "]"}], 
          RowBox[{"\[CapitalDelta]\[Theta]", "[", 
           RowBox[{"[", "l", "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", 
             RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
          RowBox[{"\[CapitalDelta]r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]",
           "*", 
          RowBox[{"\[Rho]", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}]}], ";"}], 
   "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"equation", " ", "to", " ", "set", " ", "total", " ", "mass"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072946116574483`*^9, 3.507294652123763*^9}, {
   3.50730596513383*^9, 3.507305973911332*^9}, {3.507306335528015*^9, 
   3.5073063359130373`*^9}, {3.507306601161209*^9, 3.507306602281273*^9}, {
   3.5075157331656933`*^9, 3.507515734909793*^9}, {3.5075186323545175`*^9, 
   3.507518632817544*^9}, {3.50752241531189*^9, 3.5075224164409547`*^9}, {
   3.5075226584978*^9, 3.5075226702994747`*^9}, {3.5075500934252477`*^9, 
   3.5075500944003034`*^9}, {3.5075508099192286`*^9, 3.507550810739276*^9}, {
   3.507612008873083*^9, 3.5076120107801924`*^9}, {3.5076133443584685`*^9, 
   3.507613344885499*^9}, {3.5076884439257936`*^9, 3.507688453964368*^9}, {
   3.507691473563079*^9, 3.5076914751301684`*^9}, 3.507692574091408*^9, 
   3.663566268465784*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"eqANGMOM", "=", 
     RowBox[{"J", "==", 
      RowBox[{"4", " ", "Pi", " ", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "]"}], 
          RowBox[{"\[CapitalDelta]\[Theta]", "[", 
           RowBox[{"[", "l", "]"}], "]"}], " ", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"[", 
             RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "4"}], " ", 
          RowBox[{"\[CapitalDelta]r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]",
           "*", 
          RowBox[{"\[Rho]", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalOmega]", "[", "  ", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}]}], " ", 
    ";"}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "equation", " ", "to", " ", "set", " ", "angular", " ", "momentum"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072955292199297`*^9, 3.50729564600861*^9}, {
   3.5073059792476373`*^9, 3.507305989522225*^9}, {3.507306588907508*^9, 
   3.5073065959889126`*^9}, {3.5075157382079816`*^9, 
   3.5075157395910606`*^9}, {3.5075186380588436`*^9, 3.507518638553872*^9}, {
   3.507522421239229*^9, 3.5075224224753*^9}, {3.507522662579033*^9, 
   3.5075226763818226`*^9}, {3.507550097745495*^9, 3.507550098652547*^9}, {
   3.5075508139674606`*^9, 3.5075508147365046`*^9}, {3.507611992978174*^9, 
   3.507611994004233*^9}, {3.5076133491647434`*^9, 3.507613349781779*^9}, {
   3.5076884602407265`*^9, 3.50768846256586*^9}, {3.5076912724765773`*^9, 
   3.5076912729486046`*^9}, 3.507692576789562*^9, 3.6635662630324736`*^9}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NOTE", ":", " ", 
    RowBox[{
    "mass", " ", "and", " ", "angular", " ", "momentu", " ", "are", " ", 
     "driving", " ", 
     RowBox[{"parameters", ".", " ", "Usually"}]}]}], ",", " ", 
   RowBox[{
   "one", " ", "use", " ", "poorly", " ", "justified", " ", "choice", " ", 
    "of", " ", "parameters"}], ",", " ", 
   RowBox[{"like", " ", "central", " ", "density"}], ",", " ", 
   RowBox[{
   "central", " ", "angular", " ", "momentum", " ", "or", " ", "axis", " ", 
    RowBox[{"ratio", ".", " ", "These"}], " ", "sequences", " ", "have", " ", 
    "at", " ", "least", " ", "the", " ", "same", " ", "mass", " ", "and", " ",
     "angular", " ", 
    RowBox[{"momentum", ":", " ", 
     RowBox[{"you", " ", "can", " ", "compare", " ", 
      RowBox[{"them", ".", " ", "Comparison"}], " ", "of", " ", "structures", 
      " ", "with", " ", "different", " ", "mass", " ", "and", " ", "angular", 
      " ", "momentum", " ", "is", " ", 
      RowBox[{"nonsense", "!"}]}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.50777926157475*^9, 3.5077794118413444`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Left", "-", 
    RowBox[{"hand", " ", "side", " ", "of", " ", "equations", " ", 
     RowBox[{"(", 
      RowBox[{"with", " ", "-", "C"}], " ", ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"fLHS", "=", "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", " ", "K", " ", "\[Rho]C"}], "+", 
           RowBox[{"\[CapitalPhi]C", "[", "0", "]"}], "+", "\[CapitalPhi]0", 
           "-", "C"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"M", "-", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "]"}], 
               RowBox[{"\[CapitalDelta]\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
               RowBox[{"\[CapitalDelta]r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
               "\[IndentingNewLine]", "*", 
               RowBox[{"\[Rho]", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"J", "-", 
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "]"}], 
               RowBox[{"\[CapitalDelta]\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "4"}], " ", 
               RowBox[{"\[CapitalDelta]r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
               "\[IndentingNewLine]", "*", 
               RowBox[{"\[Rho]", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", 
               "\[IndentingNewLine]", 
               RowBox[{"\[CapitalOmega]", "[", "  ", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "m"}], "]"}], "]"}], 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "K", " ", 
             RowBox[{"\[Rho]", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{"\[CapitalPhi]C", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "-", 
            RowBox[{"4", " ", "Pi", " ", "G", " ", 
             RowBox[{"Sum", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}], 
                RowBox[{"\[CapitalDelta]\[Theta]", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
                RowBox[{"\[CapitalDelta]r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
                "\[IndentingNewLine]", 
                RowBox[{"kernel", "[", " ", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"r", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}],
                 "\[IndentingNewLine]", "*", 
                RowBox[{"\[Rho]", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "-", 
            "C"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "//", 
       "Flatten"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"CompilationOptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}], 
         "}"}]}], ",", " ", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.507612017645585*^9, 3.507612065484321*^9}, {
   3.5076121809289246`*^9, 3.507612196150795*^9}, {3.5076124463991084`*^9, 
   3.507612446689125*^9}, {3.507612852254322*^9, 3.5076128540664253`*^9}, {
   3.507612884876188*^9, 3.507612916977024*^9}, {3.507612954190152*^9, 
   3.507612981283702*^9}, {3.5076130327306447`*^9, 3.507613040100066*^9}, {
   3.50761314821725*^9, 3.507613150451378*^9}, {3.507648930883896*^9, 
   3.5076489577394314`*^9}, {3.507649015096712*^9, 3.507649046666518*^9}, {
   3.507649571947562*^9, 3.5076495971650047`*^9}, {3.507651067831122*^9, 
   3.5076510700722504`*^9}, {3.5076512042099223`*^9, 
   3.5076512170656576`*^9}, {3.5076515933091774`*^9, 
   3.5076515955803075`*^9}, {3.50765163147336*^9, 3.5076516325394216`*^9}, {
   3.5076518626445827`*^9, 3.5076518652647324`*^9}, {3.5076519395459814`*^9, 
   3.507651941553096*^9}, {3.5076520635350733`*^9, 3.5076521136029367`*^9}, {
   3.507652663430385*^9, 3.507652663742403*^9}, {3.507688477725727*^9, 
   3.5076884812979307`*^9}, {3.507690280264826*^9, 3.5076902822249384`*^9}, {
   3.50769151572449*^9, 3.5076915172735786`*^9}, 3.5076915911178026`*^9, {
   3.507693596852906*^9, 3.507693600312104*^9}, {3.5077794303834047`*^9, 
   3.50777945162862*^9}, 3.6572813461686687`*^9, {3.6635664592656975`*^9, 
   3.663566474849589*^9}, {3.663568503363613*^9, 3.6635685120351095`*^9}, {
   3.6635753157482595`*^9, 3.6635753175473623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fLHS2", "=", "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "vars2", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", "K", " ", "\[Rho]C"}], "+", 
          RowBox[{"\[CapitalPhi]C", "[", "0", "]"}], "+", "\[CapitalPhi]0", 
          "-", "C"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"M", "-", 
          RowBox[{"4", " ", "Pi", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], "]"}], 
              RowBox[{"\[CapitalDelta]\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
              RowBox[{"\[CapitalDelta]r", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "K", " ", 
            RowBox[{"\[Rho]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
           RowBox[{"\[CapitalPhi]C", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"4", " ", "Pi", " ", "G", " ", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], "]"}], 
               RowBox[{"\[CapitalDelta]\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
               RowBox[{"\[CapitalDelta]r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
               "\[IndentingNewLine]", 
               RowBox[{"kernel", "[", " ", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
               "\[IndentingNewLine]", "*", 
               RowBox[{"\[Rho]", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "-", 
           "C"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], "//", "Flatten"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}], 
        "}"}]}], ",", " ", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6636685931449766`*^9, 3.66366860368858*^9}, 
   3.663669030244978*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"fLHS", "@@", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "[", "vars", "]"}]}], "]"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5076978286689525`*^9, 3.5076978316811247`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "I", " ", "have", " ", "still", " ", "troubles", " ", "with", " ", 
    "Jacobian", " ", 
    RowBox[{"generation", ".", " ", "Naively"}]}], ",", " ", 
   RowBox[{
   "you", " ", "can", " ", "just", " ", "differentiate", " ", "equations", 
    " ", "with", " ", "respect", " ", "to", " ", "variables", " ", "using", 
    " ", "symbolic", " ", "capabilities", " ", "of", " ", 
    RowBox[{"Mathematica", ".", " ", "Unfortunately"}], " ", "this", " ", 
    "is", " ", "unusually", " ", 
    RowBox[{"slow", ".", " ", "Below"}], " ", "is", " ", "slightly", " ", 
    "better", " ", "approach", " ", "with", " ", "derived", " ", "formulae", 
    " ", "for", " ", "jacobian"}], ",", " ", 
   RowBox[{
   "but", " ", "still", " ", "generation", " ", "time", " ", "is", " ", 
    "proportional", " ", "to", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"NT", "*", "NR"}], ")"}], "^", "3."}], " ", "Once", " ", 
    "Jacobian", " ", "is", " ", "generated"}], ",", " ", 
   RowBox[{
   "FindRoot", " ", "solves", " ", "system", " ", "of", " ", "equations", " ",
     "in", " ", "few", " ", "steps"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "few", " ", 
     RowBox[{"seconds", ".", " ", "But"}], " ", "you", " ", "must", " ", "do",
      " ", "this", " ", 
     RowBox[{"once", ".", " ", "Pre"}]}], "-", 
    RowBox[{
    "calculated", " ", "Jacobians", " ", "are", "  ", "stored", " ", "on", 
     " ", "disk", "  ", "for", " ", "convenience"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5077794765700464`*^9, 3.5077796984047346`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"jacOLD", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fLHS", "@@", "vars"}], ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"vars", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.663569884991638*^9, 3.663569914127304*^9}, {
   3.6635699566307354`*^9, 3.6635699885845633`*^9}, {3.6635700186402817`*^9, 
   3.663570024775633*^9}, {3.663570060134656*^9, 3.66357006423089*^9}, 
   3.663571396409086*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"jac2", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fLHS2", "@@", "vars"}], ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"vars2", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "vars2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "vars2", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6636686145412006`*^9, 3.663668645894994*^9}, 
   3.663672221121485*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Jacobian", " ", "generation", " ", 
    RowBox[{"starts", ".", " ", "Skip"}], " ", "if", " ", "you", " ", 
    "prefer", " ", "to", " ", "use", " ", "pre"}], "-", 
   RowBox[{"calculated", " ", 
    RowBox[{"one", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.507779705505141*^9, 3.5077797279564247`*^9}}],

Cell[BoxData[
 RowBox[{"drlmk", "=", 
  RowBox[{"SparseArray", "@", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", 
         RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
       RowBox[{"vars", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "NR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5077039955226765`*^9, 3.5077040489867344`*^9}, {
   3.5077040857088346`*^9, 3.5077041082161217`*^9}, 3.5077178574087076`*^9, {
   3.5077182082277737`*^9, 3.507718208589794*^9}, {3.507719141632161*^9, 
   3.507719145037356*^9}, {3.5077344625694685`*^9, 3.507734468256794*^9}, {
   3.508909095089095*^9, 3.5089090960781517`*^9}}],

Cell[BoxData[
 RowBox[{"d\[CapitalDelta]rlmk", "=", 
  RowBox[{"SparseArray", "@", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[CapitalDelta]r", "[", 
        RowBox[{"[", 
         RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
       RowBox[{"vars", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "NR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.507704075572255*^9, 3.507704081523595*^9}, {
   3.507704117587658*^9, 3.5077041282292666`*^9}, 3.507717860716897*^9, 
   3.5077191386449904`*^9, {3.507734489225993*^9, 3.5077344945442977`*^9}, {
   3.508909101159443*^9, 3.5089091020274925`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timer", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", 
    RowBox[{"dir", "<>", "\"\<dKlmijk_\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dKlmijk", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"dir", "<>", "\"\<dKlmijk_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"timer1", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_load_dKlmijk_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer1"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dKlmijk", "=", "\[IndentingNewLine]", 
     RowBox[{"SparseArray", "@", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
            "[", "kernel", "]"}], "[", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
          RowBox[{"drlmk", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Derivative", "[", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
            "[", "kernel", "]"}], "[", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
          RowBox[{"drlmk", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m", ",", "k"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "NR"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NR"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<dKlmijk_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "dKlmijk"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timer1", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_generate_dKlmijk_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer1"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.50770413894588*^9, 3.5077041452242384`*^9}, {
   3.50770430574842*^9, 3.5077044863617506`*^9}, {3.507707528050725*^9, 
   3.507707530697877*^9}, {3.507708634315*^9, 3.5077086389612656`*^9}, {
   3.5077094043010406`*^9, 3.50770940463906*^9}, {3.5077094534658527`*^9, 
   3.5077094537928715`*^9}, 3.5077178994151106`*^9, 3.507718021300082*^9, {
   3.507719128099387*^9, 3.507719129845487*^9}, 3.5077193863911605`*^9, 
   3.507719439214182*^9, {3.507721215381773*^9, 3.5077212379190617`*^9}, {
   3.5077345074650364`*^9, 3.5077345128003416`*^9}, {3.5077345653353467`*^9, 
   3.507734566462411*^9}, {3.657346671838874*^9, 3.657346674817206*^9}, {
   3.658643130992991*^9, 3.658643195201521*^9}, {3.65925991239683*^9, 
   3.659259937128235*^9}, 3.659260041991856*^9, {3.66142592357953*^9, 
   3.661425936803103*^9}, {3.661427714639357*^9, 3.661427760359043*^9}}],

Cell[BoxData[
 RowBox[{"d\[Rho]lmk", "=", 
  RowBox[{"SparseArray", "@", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"\[Rho]", "[", 
        RowBox[{"[", 
         RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
       RowBox[{"vars", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "NR"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5077041640203133`*^9, 3.507704186597605*^9}, 
   3.5077180258353415`*^9, 3.5077191372479105`*^9, {3.5077346036535387`*^9, 
   3.5077346087838316`*^9}, {3.5089091205815535`*^9, 3.508909121499606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timer", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", 
    RowBox[{"dir", "<>", "\"\<dlmijkOLD_\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dlmijkOLD", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"dir", "<>", "\"\<dlmijkOLD_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"timer2", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_load_dlmijkOLD_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer2"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dlmijkOLD", "=", 
     RowBox[{"SparseArray", "@", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
           RowBox[{"\[CapitalDelta]r", "[", 
            RowBox[{"[", 
             RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
           "\[IndentingNewLine]", 
           RowBox[{"kernel", "[", " ", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
           "\[IndentingNewLine]", "*", 
           RowBox[{"\[Rho]", "[", 
            RowBox[{"[", 
             RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"vars", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"D", " ", "ends"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "NR"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NR"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<dlmijkOLD_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "dlmijkOLD"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timer2", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_generate_dlmijkOLD_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5076972285376267`*^9, 3.507697295019429*^9}, {
   3.50769734923853*^9, 3.507697395634184*^9}, {3.5076974275570097`*^9, 
   3.507697469497409*^9}, {3.5076976031320524`*^9, 3.5076976137086573`*^9}, {
   3.5077028567855444`*^9, 3.5077028820849915`*^9}, 3.5077037750630665`*^9, {
   3.5077078741295195`*^9, 3.5077078745925465`*^9}, 3.507718438649953*^9, {
   3.50771866186572*^9, 3.5077186639098372`*^9}, 3.5077187317467175`*^9, {
   3.507718989615466*^9, 3.507718992515632*^9}, {3.5077346581916575`*^9, 
   3.507734665136055*^9}, {3.658643537260208*^9, 3.658643589724058*^9}, {
   3.659260070566908*^9, 3.659260092966606*^9}, {3.661425954875348*^9, 
   3.661425961211143*^9}, {3.661428170428788*^9, 3.6614282128930798`*^9}, {
   3.6616587467820663`*^9, 3.661658747725318*^9}}],

Cell[BoxData["timer2"], "Input",
 CellChangeTimes->{{3.661658766794326*^9, 3.6616587677542467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timer", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "[", 
    RowBox[{"dir", "<>", "\"\<jac_\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jac", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"dir", "<>", "\"\<jac_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"timer3", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_load_jac_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer3"}], "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"jacPARTNEW", "=", 
     RowBox[{
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"D", "[", 
              RowBox[{"C", ",", 
               RowBox[{"vars", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "+", "\[IndentingNewLine]", 
            RowBox[{"2", "K", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"\[Rho]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"vars", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "+", "\[IndentingNewLine]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[CapitalPhi]C", "[", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"end", " ", "of", " ", "NON"}], "-", 
              RowBox[{"gravitational", " ", "part"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "-", "\[IndentingNewLine]", 
            RowBox[{"4", " ", "Pi", " ", "G", " ", 
             RowBox[{"Sum", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}], 
                RowBox[{"\[CapitalDelta]\[Theta]", "[", 
                 RowBox[{"[", "l", "]"}], "]"}], " ", "\[IndentingNewLine]", 
                "*", "\[IndentingNewLine]", 
                RowBox[{"dlmijkOLD", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m", ",", "i", ",", "j", ",", "k"}], 
                  "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}], "//", 
      "Transpose"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"jacCENTER", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "K", " ", "\[Rho]C"}], "+", 
          RowBox[{"\[CapitalPhi]C", "[", "0", "]"}], "+", "\[CapitalPhi]0", 
          "-", "C"}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "    ", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"jacMASS", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", " ", 
        RowBox[{
         RowBox[{"M", "-", 
          RowBox[{"4", " ", "Pi", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], "]"}], 
              RowBox[{"\[CapitalDelta]\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
              RowBox[{"\[CapitalDelta]r", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "    ", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"jacANG", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"J", "-", 
          RowBox[{"4", " ", "Pi", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], "]"}], 
              RowBox[{"\[CapitalDelta]\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "4"}], " ", 
              RowBox[{"\[CapitalDelta]r", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", 
              "\[IndentingNewLine]", 
              RowBox[{"\[CapitalOmega]", "[", "  ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"vars", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"jac", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "jacCENTER", "}"}], ",", 
       RowBox[{"{", "jacMASS", "}"}], ",", 
       RowBox[{"{", "jacANG", "}"}], ",", "jacPARTNEW"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<jac_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "jac"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"timer3", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"dir", "<>", "\"\<timer_generate_jac_\>\"", "<>", 
       RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
       RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], ",", 
      "timer3"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5077017287860265`*^9, 3.507701758066701*^9}, {
   3.5077018290057583`*^9, 3.5077019819445057`*^9}, {3.507702047662265*^9, 
   3.507702050772443*^9}, {3.5077020894216537`*^9, 3.5077020948749657`*^9}, {
   3.507702340516015*^9, 3.5077023539647846`*^9}, {3.507703782561496*^9, 
   3.5077037863007097`*^9}, {3.507720365512163*^9, 3.507720365903186*^9}, {
   3.507721635914826*^9, 3.5077216380579486`*^9}, {3.50773482082296*^9, 
   3.507734839920052*^9}, {3.507734933758419*^9, 3.507734935092496*^9}, {
   3.5090053063999414`*^9, 3.5090053214428024`*^9}, {3.658643663258903*^9, 
   3.658643761502804*^9}, {3.658643826124852*^9, 3.658643828233602*^9}, 
   3.658644347575432*^9, {3.659260173014431*^9, 3.659260194117943*^9}, {
   3.6614259680683947`*^9, 3.6614259746206503`*^9}, {3.661428229893401*^9, 
   3.6614282680701723`*^9}, {3.6616587974080353`*^9, 3.66165879774365*^9}, {
   3.663566515618921*^9, 3.663566522016287*^9}, {3.6635685986520634`*^9, 
   3.66356859912409*^9}}],

Cell[BoxData[
 RowBox[{"MaxMemoryUsed", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6592396691805983`*^9, 3.659239672890931*^9}}],

Cell[BoxData[
 RowBox[{"jac", "//", "ByteCount"}]], "Input",
 CellChangeTimes->{{3.5077908782341843`*^9, 3.507790924190813*^9}, {
  3.507791012877886*^9, 3.5077910129438896`*^9}, {3.507791074518411*^9, 
  3.5077910753324575`*^9}, {3.5078124743477116`*^9, 3.5078124749927483`*^9}, {
  3.5078126524428983`*^9, 3.5078126527829175`*^9}}],

Cell[BoxData[
 RowBox[{"Dimensions", "[", "jac", "]"}]], "Input",
 CellChangeTimes->{{3.5077801238480687`*^9, 3.507780129502392*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", "vars", "]"}]], "Input",
 CellChangeTimes->{{3.658643855723873*^9, 3.6586438618321333`*^9}}],

Cell[BoxData["vars"], "Input",
 CellChangeTimes->{{3.663567997590685*^9, 3.6635679980127087`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"G", ",", "M", ",", "K", ",", "\[Rho]C", ",", "\[Rho]0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6635669380850844`*^9, 3.663566941868301*^9}, {
  3.663567968798038*^9, 3.663567969581083*^9}, {3.663568008381302*^9, 
  3.6635680091243443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"h", "[", "\[Zeta]", "]"}], "/", "2"}], "/", "K"}], "/.", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"\[Zeta]", "^", "2"}]}], 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Zeta]", "^", "2"}], " ", 
                 RowBox[{
                  RowBox[{"h", "'"}], "[", "\[Zeta]", "]"}]}], ",", 
                "\[Zeta]"}], "]"}]}], "+", 
             RowBox[{"4", " ", "Pi", " ", 
              RowBox[{
               RowBox[{"G", " ", "/", "2"}], "/", "K"}], " ", 
              RowBox[{"h", "[", "\[Zeta]", "]"}]}]}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"h", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"2", "K", " ", "\[Rho]0"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"h", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], 
         ",", 
         RowBox[{"h", "[", "\[Zeta]", "]"}], ",", "\[Zeta]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "//", "ComplexExpand"}], ",", 
    RowBox[{
     RowBox[{"K", ">", "0"}], "&&", 
     RowBox[{"G", ">", "0"}]}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"initial", " ", "values", " ", "from", " ", "Lane"}], "-", 
    RowBox[{"Emden", " ", "equation"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.6635669629565067`*^9, 3.663566988811986*^9}, {
  3.663567644671499*^9, 3.663567645703558*^9}, {3.6635676931912737`*^9, 
  3.663567697263507*^9}, {3.663568004710092*^9, 3.6635680050691123`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{
    RowBox[{"G", ">", "0"}], "&&", 
    RowBox[{"K", ">", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6584955726882706`*^9, 3.6584955938204794`*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]LE", "=", 
  RowBox[{"Refine", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{"G", ">", "0"}], "&&", 
     RowBox[{"K", ">", "0"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5072949160838604`*^9, 3.5072949273375044`*^9}, 
   3.507307145808361*^9, {3.508385610018305*^9, 3.5083856111193676`*^9}, 
   3.5083857109110756`*^9, {3.508908177794629*^9, 3.5089081887962584`*^9}, {
   3.5089083391718597`*^9, 3.5089083427400637`*^9}, 3.6635673765211616`*^9}],

Cell[BoxData[
 RowBox[{"r0", "=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"K", " ", 
    RowBox[{
     RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6635682815969286`*^9, 3.6635683087384815`*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]0", "=", 
  RowBox[{"\[Rho]0", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"M", "==", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"\[Zeta]", "^", "2"}], " ", "\[Rho]LE"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Zeta]", ",", "0", ",", "r0"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", ">", "0"}], "&&", 
          RowBox[{"K", ">", "0"}]}]}], "]"}]}], " ", 
      RowBox[{"(*", " ", "MASS", " ", "*)"}], ",", "\[Rho]0"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5072947213767242`*^9, 3.5072947966750307`*^9}, {
  3.5073070750533137`*^9, 3.5073070753603315`*^9}, {3.5073071552389*^9, 
  3.5073071560849485`*^9}, {3.5073072017765617`*^9, 3.507307213001204*^9}, {
  3.50730728601438*^9, 3.5073072867954245`*^9}, {3.5083859298655987`*^9, 
  3.508385941996293*^9}, {3.6635674486172853`*^9, 3.6635674556486874`*^9}, {
  3.6635674952809544`*^9, 3.663567538473425*^9}, {3.6635679031182814`*^9, 
  3.663567904757375*^9}, {3.663567964653801*^9, 3.6635679650288224`*^9}, {
  3.6635680206450033`*^9, 3.6635680548759613`*^9}, {3.663568318747054*^9, 
  3.6635683188270583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[IndentingNewLine]", 
           RowBox[{"Units", " ", 
            RowBox[{"tested", ":", "\[IndentingNewLine]", "1"}]}], ")"}], " ",
           "K"}], "=", 
         RowBox[{"1", "/", "2"}]}], ",", " ", 
        RowBox[{"G", "=", "1"}], ",", " ", 
        RowBox[{"\[Rho]0", "=", 
         RowBox[{"1", "\[IndentingNewLine]", "\t", "2"}]}]}], ")"}], " ", 
      "G"}], " ", "=", " ", 
     RowBox[{"4", " ", 
      RowBox[{"Pi", "^", "2"}]}]}], ",", " ", 
    RowBox[{"M", "=", "Msun"}], ",", " ", 
    RowBox[{"R", "=", "Rsun"}], ",", " ", 
    RowBox[{"Tsun", " ", "=", " ", 
     RowBox[{
      RowBox[{"Keplerian", " ", "period", " ", "at", " ", "R"}], "=", 
      "Rsun"}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.663578755162983*^9, 3.663578856984806*^9}}],

Cell[BoxData[
 RowBox[{"G0", "=", 
  RowBox[{"6.67384", "*", 
   RowBox[{"10", "^", 
    RowBox[{"-", "11", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"From", " ", "CODATA"}], ",", " ", 
       RowBox[{"used", " ", "in", " ", "Kong", " ", 
        RowBox[{"et", ".", " ", "al", "."}]}]}], " ", "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5070880395881987`*^9, 3.5070880400322247`*^9}, {
  3.5077799509011765`*^9, 3.5077799615137835`*^9}, {3.6635665486068077`*^9, 
  3.663566553911111*^9}, {3.6635696569775963`*^9, 3.66356967837682*^9}, {
  3.6635716865466805`*^9, 3.6635716891468296`*^9}, {3.6635722691580043`*^9, 
  3.663572270414076*^9}, {3.6635723198779054`*^9, 3.6635723235901175`*^9}, {
  3.6635790109116106`*^9, 3.6635790719100995`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"G", "=", "1"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6635694801654835`*^9, 3.663569480746516*^9}, 
   3.66357271071526*^9}],

Cell[BoxData[
 RowBox[{"G", "=", 
  RowBox[{"4", " ", 
   RowBox[{"Pi", "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.663571691682975*^9, 3.663571693922103*^9}, 
   3.663573230886012*^9, 3.663574598351227*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"G", "=", "G0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.663573233037135*^9, 3.663573237111368*^9}, 
   3.6635746020064354`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"M", "=", 
    RowBox[{
     RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Lane", "-", 
     RowBox[{"Emden", " ", "with", " ", "R"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}], " ", "radius", " ", 
      "and", " ", "rhoC"}], "=", "1"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072950451642437`*^9, 3.507295047484376*^9}, {
   3.50730709998474*^9, 3.507307129670438*^9}, {3.5073072664902635`*^9, 
   3.507307270265479*^9}, 3.663566780993099*^9, 3.663569488269947*^9, 
   3.6635732514001856`*^9}],

Cell[BoxData[
 RowBox[{"Msun", "=", 
  RowBox[{"1.98855", "*", 
   RowBox[{"10", "^", "30", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"QuantityMagnitude", "@", 
      RowBox[{
       RowBox[{"Entity", "[", 
        RowBox[{"\"\<Star\>\"", ",", "\"\<Sun\>\""}], "]"}], "[", 
       "\"\<Mass\>\"", "]"}]}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.663572189268435*^9, 3.663572191071538*^9}, {
  3.6705631659166207`*^9, 3.6705631745991173`*^9}}],

Cell[BoxData[
 RowBox[{"Rsun", "=", "695700000.0", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"QuantityMagnitude", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Entity", "[", 
       RowBox[{"\"\<Star\>\"", ",", "\"\<Sun\>\""}], "]"}], "[", 
      "\"\<Radius\>\"", "]"}], ",", "\"\<Meters\>\""}], "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.663572195041765*^9, 3.6635722062544065`*^9}, {
  3.663572545860831*^9, 3.663572547300913*^9}, {3.6635725790767307`*^9, 
  3.663572588116248*^9}, {3.670563250380452*^9, 3.670563266486373*^9}}],

Cell[BoxData[
 RowBox[{"Tsun", "=", 
  RowBox[{"2", "Pi", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rsun", "^", "3"}], "/", "Msun"}], "/", "G0"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.663572228814697*^9, 3.6635722637346945`*^9}, {
  3.6635723470864615`*^9, 3.6635723474624834`*^9}}],

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"9.7466", "*", 
   RowBox[{
    RowBox[{"10", "^", "30"}], "/", "Msun", " ", 
    RowBox[{"(*", 
     RowBox[{"\[Alpha]", " ", "Eridani"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6635667841492796`*^9, 3.66356679288478*^9}, {
   3.663569685809245*^9, 3.663569689985484*^9}, {3.6635716998584423`*^9, 
   3.6635717036426587`*^9}, {3.6635718029623394`*^9, 3.66357181713015*^9}, {
   3.663572680028505*^9, 3.6635726812915773`*^9}, 3.663573271973362*^9, {
   3.663574577311023*^9, 3.6635745782460766`*^9}, {3.6635790836067686`*^9, 
   3.6635791062300625`*^9}}],

Cell[BoxData[
 RowBox[{"R\[Alpha]Eri", "=", 
  RowBox[{"8.83520", "*", 
   RowBox[{"10", "^", "9"}]}]}]], "Input",
 CellChangeTimes->{{3.6635792344533963`*^9, 3.663579260412881*^9}}],

Cell[BoxData[
 RowBox[{"R\[Alpha]Eri", "/", "Rsun"}]], "Input",
 CellChangeTimes->{{3.663579265688183*^9, 3.663579272364565*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "=", " ", 
  RowBox[{"2.9725", "*", 
   RowBox[{"10", "^", 
    RowBox[{"-", "5"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6635796174453025`*^9, 3.663579635394329*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "Tsun"}]], "Input",
 CellChangeTimes->{{3.6635796382534924`*^9, 3.663579650850213*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"M", "=", 
   RowBox[{"9.7466", "*", 
    RowBox[{"10", "^", "30"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{3.6635745762669635`*^9}],

Cell[BoxData[
 RowBox[{"K0", "=", 
  RowBox[{"1.75", "*", 
   RowBox[{"10", "^", "9", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"from", " ", "Kong", " ", 
      RowBox[{"et", ".", " ", "al", "."}]}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5089082405452185`*^9, 3.5089082419843006`*^9}, {
   3.663566566118809*^9, 3.66356656979902*^9}, {3.6635696948487625`*^9, 
   3.6635696986169777`*^9}, 3.6635726300996494`*^9, {3.663574612782052*^9, 
   3.663574615638215*^9}, {3.6635791097982664`*^9, 3.663579122501993*^9}}],

Cell[BoxData[
 RowBox[{"Kinit", "=", 
  RowBox[{"K0", " ", 
   RowBox[{"Tsun", "^", "2"}], " ", 
   RowBox[{"Msun", "/", 
    RowBox[{"Rsun", "^", "5"}]}]}]}]], "Input",
 CellChangeTimes->{{3.663668765917859*^9, 3.6636687725662394`*^9}}],

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{"K0", " ", 
   RowBox[{"Tsun", "^", "2"}], " ", 
   RowBox[{"Msun", "/", 
    RowBox[{"Rsun", "^", "5"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6635726330628185`*^9, 3.663572643187398*^9}, 
   3.663573277092655*^9, {3.6635745627111883`*^9, 3.663574569111554*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"K", "=", "K0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.66357328032784*^9, 3.6635732815429096`*^9}, 
   3.663574561393113*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"K", "=", 
   RowBox[{"1", "/", "2"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6635695388768415`*^9, 3.663569540793951*^9}, 
   3.663572705587967*^9}],

Cell[BoxData["r0"], "Input",
 CellChangeTimes->{{3.6635695295233064`*^9, 3.6635695297533197`*^9}}],

Cell[BoxData["M"], "Input",
 CellChangeTimes->{3.663569543417101*^9}],

Cell[BoxData["\[Rho]0"], "Input",
 CellChangeTimes->{{3.663569545232205*^9, 3.663569546361269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NT", "*", "NR"}], "+", "3", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "equations"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.507088462691399*^9, 3.507088466414612*^9}, {
  3.5077799850061274`*^9, 3.5077800033421764`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "[", "vars2", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "variables"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.507779988056302*^9, 3.507780009865549*^9}, 
   3.6705701473909383`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"init", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"NT", "*", "NR"}], "+", "2"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5070880528869596`*^9, 3.5070880676488037`*^9}, {
  3.507088451015731*^9, 3.5070884734550147`*^9}, {3.507294700116508*^9, 
  3.507294700430526*^9}, {3.5073079713755803`*^9, 3.50730797311668*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"initial", " ", "starting", " ", "guess"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5077800186530523`*^9, 3.507780039723257*^9}}],

Cell[BoxData["vars2"], "Input",
 CellChangeTimes->{{3.6636688103754015`*^9, 3.663668811149446*^9}}],

Cell[BoxData[
 RowBox[{"init", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"R", "/.", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"K", " ", 
            RowBox[{
             RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], "&"}], 
       ")"}], "/@", "R"}]}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]LE", "/.", 
          RowBox[{"\[Zeta]", "\[Rule]", 
           RowBox[{"r", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"K", " ", 
                RowBox[{
                 RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], 
            "&"}], ")"}], "/@", "R"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"NR", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "G"}], " ", 
       RowBox[{"M", "/", "r0"}]}], ",", "\[Rho]0", ",", "\[CapitalOmega]0"}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6636722618858166`*^9, 3.663672295621746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"init2", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Most", "[", "R", "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"K", " ", 
              RowBox[{
               RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], "&"}], 
         ")"}], "/@", "R"}]}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]LE", "/.", 
            RowBox[{"\[Zeta]", "\[Rule]", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"K", " ", 
                  RowBox[{
                   RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], 
              "&"}], ")"}], "/@", "R"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"NR", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "G"}], " ", 
         RowBox[{"M", "/", "r0"}]}], ",", "\[Rho]0", ",", "K"}], "}"}]}], 
     "]"}], "/.", 
    RowBox[{"K", "\[Rule]", "Kinit"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Short"}]}], "Input",
 CellChangeTimes->{{3.5071010958159723`*^9, 3.507101098812144*^9}, {
   3.5071011364822984`*^9, 3.5071011652329426`*^9}, 3.507101273724148*^9, {
   3.5071013557798414`*^9, 3.5071013838174453`*^9}, {3.507294861192721*^9, 
   3.507294874896505*^9}, {3.5072956946223907`*^9, 3.5072956948504033`*^9}, {
   3.5073072952639093`*^9, 3.507307297586042*^9}, 3.507434996316804*^9, 
   3.5077885617896914`*^9, 3.507901638681843*^9, {3.5079017835801306`*^9, 
   3.5079018116837378`*^9}, {3.509076667321393*^9, 3.5090766748548236`*^9}, {
   3.663567760673134*^9, 3.6635677852475395`*^9}, {3.6635681735897512`*^9, 
   3.6635681748838253`*^9}, {3.663568257395545*^9, 3.663568263059869*^9}, {
   3.663568350066845*^9, 3.6635683506588793`*^9}, {3.663569738050233*^9, 
   3.66356974936088*^9}, {3.663572934171041*^9, 3.6635729460027175`*^9}, {
   3.663668800486836*^9, 3.6636688567670555`*^9}, {3.6636689490873356`*^9, 
   3.6636689600849648`*^9}}],

Cell[BoxData["init2"], "Input",
 CellChangeTimes->{{3.663567872760545*^9, 3.6635678737176*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rozw", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<E:\\\\temp\\\\EM\\\\Solid_\>\"", "<>", 
      RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_J_\>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", "0.499", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}]}],
    ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.509122394624262*^9, 3.5091224059109073`*^9}, {
   3.657347058977503*^9, 3.6573470595460377`*^9}, 3.657437561539302*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", 
   RowBox[{"init2", "=", 
    RowBox[{"vars", "/.", "rozw"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{"use", " ", "for", " ", "RESTART", " ", 
     RowBox[{"ONLY", " ", "!"}]}], " ", "*)"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5074764024066114`*^9, 3.5074764290831366`*^9}, {
   3.507550837282794*^9, 3.5075508393749137`*^9}, {3.5077836641885643`*^9, 
   3.50778366603767*^9}, 3.5077861701969*^9, {3.507787874193363*^9, 
   3.5077878854780083`*^9}, {3.507905722011396*^9, 3.507905747444851*^9}, {
   3.509122419394678*^9, 3.509122419881706*^9}, 3.657437565086666*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"start", "=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", 
       RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
        RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "0.0", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"vars", ",", 
         RowBox[{"vars", "/.", 
          RowBox[{"Import", "[", 
           RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
            RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", "0.0", "]"}], "]"}], "<>", "\"\<.m\>\""}], 
           "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"vars", ",", "init"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"starting", " ", "guess"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070880690698853`*^9, 3.5070880992526116`*^9}, 
   3.5071013610531435`*^9, {3.5077800553781524`*^9, 3.507780059932413*^9}, 
   3.507786175598209*^9, {3.6572856143687954`*^9, 3.6572856370950956`*^9}, {
   3.6593369210271893`*^9, 3.659336999185604*^9}, {3.659337608588297*^9, 
   3.659337620235021*^9}, {3.659337699339486*^9, 3.6593377002026854`*^9}, {
   3.66097683192801*^9, 3.660976835046419*^9}, 3.663672312542714*^9}],

Cell[BoxData[
 RowBox[{"start", "=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"vars", ",", "init"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6636723270285425`*^9, 3.6636723283006153`*^9}}],

Cell[BoxData[
 RowBox[{"start2", "=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"vars2", ",", "init2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.660976848839204*^9, 3.6609768538793592`*^9}, 
   3.663668870685851*^9, 3.663668924228914*^9, 3.663672324413393*^9}],

Cell[BoxData[
 RowBox[{"start", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "3"}], ";;"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6593376822525177`*^9, 3.6593376839137297`*^9}, {
  3.663572908082549*^9, 3.663572917874109*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]0", "=", 
  RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "Tsun"}]}]], "Input",
 CellChangeTimes->{{3.657444273316474*^9, 3.657444275133006*^9}, {
   3.6636688776692505`*^9, 3.6636688802854004`*^9}, {3.663669236090751*^9, 
   3.6636693182824526`*^9}, 3.663669349722251*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6705645371870527`*^9, 3.6705645432553997`*^9}}],

Cell[BoxData["R"], "Input",
 CellChangeTimes->{{3.6705646492594633`*^9, 3.6705646555638237`*^9}}],

Cell[BoxData[
 RowBox[{"R6", "=", 
  RowBox[{"R\[Alpha]Eri", "/", "Rsun"}]}]], "Input",
 CellChangeTimes->{{3.663669073345443*^9, 3.6636690886673193`*^9}, {
  3.6705645445484743`*^9, 3.670564544949497*^9}, {3.670564590165083*^9, 
  3.670564591628167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wynik", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"e", " ", "=", " ", "0"}], ",", " ", 
       RowBox[{"j", " ", "=", " ", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"fLHS2", "@@", "vars2"}], ",", "start2", ",", 
           RowBox[{"MaxIterations", "\[Rule]", "400"}], ",", 
           RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
            RowBox[{"e", "++"}]}], ",", " ", 
           RowBox[{"StepMonitor", "\[RuleDelayed]", " ", 
            RowBox[{"s", "++"}]}]}], "]"}], "//", "Chop"}], "//", 
        "AbsoluteTiming"}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "e", ",", "j"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5075484415067635`*^9, 3.507548455380557*^9}, {
   3.5075488976198516`*^9, 3.507548897929869*^9}, {3.5075494344995594`*^9, 
   3.507549451853552*^9}, {3.507609292628723*^9, 3.5076093227774477`*^9}, {
   3.507609379596697*^9, 3.507609456108073*^9}, {3.507609698800955*^9, 
   3.50760970396625*^9}, 3.5076099140202646`*^9, {3.5076099902736263`*^9, 
   3.5076099916337037`*^9}, {3.5076102326374884`*^9, 3.507610233607544*^9}, {
   3.5076130750560656`*^9, 3.5076130973133383`*^9}, {3.5076133771443443`*^9, 
   3.5076133798514986`*^9}, {3.507650599301324*^9, 3.5076505996493435`*^9}, {
   3.5076506818860474`*^9, 3.5076507580504036`*^9}, {3.507650960570987*^9, 
   3.507650968036414*^9}, {3.5076510046525087`*^9, 3.50765100502853*^9}, {
   3.507651050536133*^9, 3.5076510521582255`*^9}, {3.5076904848615284`*^9, 
   3.507690485203548*^9}, {3.50769055132833*^9, 3.507690576451767*^9}, {
   3.507693156984747*^9, 3.5076931648952*^9}, {3.507695670794529*^9, 
   3.507695684517314*^9}, {3.5077211112088146`*^9, 3.5077211117158437`*^9}, {
   3.5077800672908335`*^9, 3.5077800675488486`*^9}, {3.5090763948538084`*^9, 
   3.5090763952368307`*^9}, {3.657280381941518*^9, 3.657280382372543*^9}, {
   3.657286657218443*^9, 3.6572866656169233`*^9}, {3.657439132087089*^9, 
   3.6574391323723583`*^9}, {3.65743936389121*^9, 3.657439364257783*^9}, {
   3.657523933983822*^9, 3.657523934271307*^9}, {3.6635691878867655`*^9, 
   3.6635691902939034`*^9}, {3.663569458652253*^9, 3.663569461835435*^9}, {
   3.66356981753778*^9, 3.663569821880028*^9}, {3.663570076423587*^9, 
   3.663570076774607*^9}, {3.6635701251193724`*^9, 3.6635701362780104`*^9}, {
   3.66357406708984*^9, 3.663574067457861*^9}, 3.6635747746783123`*^9, 
   3.663668895421266*^9, 3.6636689889816175`*^9, 3.6705646066120243`*^9}],

Cell[BoxData["wynik"], "Input",
 CellChangeTimes->{{3.6636691053532734`*^9, 3.6636691075073967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R1", "/", "R6"}], "/.", 
  RowBox[{"wynik", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6705649654745493`*^9, 3.6705650139163203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R1", "/", "R6"}], ")"}], "^", "2"}]}], "]"}], "/.", 
  RowBox[{"wynik", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6705651011123075`*^9, 3.670565108057705*^9}}],

Cell[BoxData[
 RowBox[{"Sqrt", "[", 
  RowBox[{"1", "-", 
   RowBox[{"0.745356", "^", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6705687887822304`*^9, 3.67056880083892*^9}}],

Cell[BoxData["vars2"], "Input",
 CellChangeTimes->{{3.6635688622711415`*^9, 3.663568862719167*^9}, 
   3.6705701338451633`*^9}],

Cell[BoxData[
 RowBox[{"wynik", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5075501245490274`*^9, 3.5075501281142316`*^9}, {
  3.6705650084900103`*^9, 3.670565008738024*^9}}],

Cell[BoxData[
 RowBox[{"wynik", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5075497332126446`*^9, 3.507549743306222*^9}}],

Cell[BoxData[
 RowBox[{"MaxMemoryUsed", "[", "]"}]], "Input",
 CellChangeTimes->{{3.507438966114863*^9, 3.5074389691510363`*^9}}],

Cell[BoxData[
 RowBox[{"ByteCount", "[", "jac", "]"}]], "Input",
 CellChangeTimes->{{3.5077801875027094`*^9, 3.507780230550172*^9}, {
  3.5092761860595727`*^9, 3.5092761863825912`*^9}, {3.657439358771555*^9, 
  3.6574393591214857`*^9}}],

Cell[BoxData["Tsun"], "Input",
 CellChangeTimes->{{3.6635739587306423`*^9, 3.663573959346678*^9}}],

Cell[BoxData["Msun"], "Input",
 CellChangeTimes->{{3.6635739697242713`*^9, 3.663573971370365*^9}}],

Cell[BoxData["Rsun"], "Input",
 CellChangeTimes->{{3.663573972938455*^9, 3.663573973466485*^9}}],

Cell[BoxData[
 RowBox[{"Msun", " ", 
  RowBox[{
   RowBox[{"Rsun", "^", "2"}], "/", "Tsun"}]}]], "Input",
 CellChangeTimes->{{3.6635734826174107`*^9, 3.6635734887657623`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "J", "]"}]], "Input",
 CellChangeTimes->{{3.5074346459467635`*^9, 3.5074346482228937`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.5074412570028944`*^9, 3.5074412586149864`*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.662196446308402*^9}],

Cell[BoxData[
 RowBox[{"Jmax", "=", "64"}]], "Input",
 CellChangeTimes->{{3.6635763623671227`*^9, 3.663576363665197*^9}, {
  3.663576549512827*^9, 3.663576550391877*^9}, {3.6635769867418346`*^9, 
  3.663576987428874*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalDelta]J", "=", "1.0"}]], "Input",
 CellChangeTimes->{{3.6635763663903527`*^9, 3.663576369993559*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"J", "=", "0.0"}], ",", 
    RowBox[{"J", "\[LessEqual]", "Jmax"}], ",", 
    RowBox[{"J", "=", 
     RowBox[{"J", "+", "\[CapitalDelta]J"}]}], "  ", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"A", "=", "1.02"}], ",", 
       RowBox[{"A", ">", "0"}], ",", 
       RowBox[{"A", "=", 
        RowBox[{"A", "-", 
         RowBox[{"1", "/", "1000"}]}]}], ","}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timer", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
          RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "J", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
            RowBox[{"e", " ", "=", " ", "0"}], ",", " ", 
            RowBox[{"j", " ", "=", " ", "0"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"FindRoot", "[", 
               RowBox[{
                RowBox[{"fLHS", "@@", "vars"}], ",", "start", ",", 
                RowBox[{"MaxIterations", "\[Rule]", "128"}], ",", 
                RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"e", "++"}]}], ",", " ", 
                RowBox[{"StepMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"s", "++"}]}], ",", 
                RowBox[{"Method", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Newton\>\"", ",", " ", 
                   RowBox[{"\"\<UpdateJacobian\>\"", "\[Rule]", "1"}]}], 
                  "}"}]}], ",", "\[IndentingNewLine]", " ", 
                RowBox[{"Jacobian", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"jac", ",", " ", 
                   RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
                    RowBox[{"j", "++"}]}]}], "}"}]}]}], "]"}], "//", "Chop"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "e", ",", "j"}], "}"}]}], "}"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
           RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", "J", "]"}], "]"}], "<>", "\"\<.m\>\""}], ",", 
          "rozw"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
            RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", "J", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<From disk\>\"", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"initPREV", "=", 
      RowBox[{"vars", "/.", "rozw"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"vars", ",", "initPREV"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<J=\>\"", ",", 
       RowBox[{"N", "[", "J", "]"}], ",", "\"\<\\t Time = \>\"", ",", " ", 
       RowBox[{
        RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}], ",", 
       "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Evaluations=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\\tStep=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\tJac=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "   ", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.507088002317067*^9, 3.5070880080793967`*^9}, {
   3.5070881025297985`*^9, 3.5070881249230795`*^9}, {3.5072715796506042`*^9, 
   3.507271582772783*^9}, {3.50728583343358*^9, 3.5072858338941383`*^9}, {
   3.5072862570973787`*^9, 3.5072862573114057`*^9}, {3.5072958384706182`*^9, 
   3.507295855896615*^9}, {3.507346869473978*^9, 3.5073470260289326`*^9}, {
   3.5073471362062345`*^9, 3.5073471369222755`*^9}, {3.507347453292371*^9, 
   3.507347454785456*^9}, {3.5074345754087286`*^9, 3.5074346034993353`*^9}, 
   3.5074348643852577`*^9, {3.507435127702318*^9, 3.507435131680546*^9}, {
   3.507440775593359*^9, 3.5074407788735466`*^9}, {3.5074408200139*^9, 
   3.5074408798683233`*^9}, {3.5074409256649427`*^9, 3.507440927344039*^9}, {
   3.5074412613641434`*^9, 3.507441321482582*^9}, {3.507445516107833*^9, 
   3.5074455565811477`*^9}, {3.5074461781506996`*^9, 
   3.5074462338388844`*^9}, {3.507447143053889*^9, 3.5074471463430767`*^9}, {
   3.507447482029277*^9, 3.507447483181343*^9}, {3.5074500070577*^9, 
   3.507450043028758*^9}, {3.507450537165021*^9, 3.5074506717457185`*^9}, {
   3.507450702845497*^9, 3.5074507433948164`*^9}, {3.5074726627277136`*^9, 
   3.5074726958066053`*^9}, {3.507473262925043*^9, 3.507473292659744*^9}, 
   3.5074734092974153`*^9, {3.5074749088021817`*^9, 3.50747494461023*^9}, {
   3.5074763708218045`*^9, 3.50747637370597*^9}, {3.507523279821337*^9, 
   3.50752330644886*^9}, {3.5075249642896833`*^9, 3.5075249852358813`*^9}, {
   3.507780502330717*^9, 3.507780589944728*^9}, {3.507780633148199*^9, 
   3.507780652452303*^9}, {3.5077836831936517`*^9, 3.507783724493014*^9}, {
   3.507785747148703*^9, 3.507785751200935*^9}, {3.5077861916701283`*^9, 
   3.5077862055409217`*^9}, {3.5077872368209076`*^9, 3.507787246888483*^9}, {
   3.507787953533901*^9, 3.5077879941872263`*^9}, 3.5077885835449357`*^9, {
   3.5077892106298027`*^9, 3.5077892112848406`*^9}, {3.5077902826261177`*^9, 
   3.507790296949937*^9}, 3.507791863265525*^9, {3.507791940123921*^9, 
   3.5077919402049255`*^9}, {3.507801710345046*^9, 3.5078017140092554`*^9}, {
   3.507805309346897*^9, 3.507805315901272*^9}, {3.5081386962469125`*^9, 
   3.5081387207353125`*^9}, {3.5081390796128397`*^9, 3.5081390799048567`*^9}, 
   3.508921064439703*^9, {3.509076569333788*^9, 3.5090765801294055`*^9}, {
   3.5090766127302704`*^9, 3.509076634983543*^9}, {3.5090943378560896`*^9, 
   3.50909434205433*^9}, {3.50912244354906*^9, 3.509122451622522*^9}, {
   3.509168943168853*^9, 3.5091689569766426`*^9}, 3.509276202770529*^9, 
   3.6572868036268177`*^9, {3.657347837882*^9, 3.657347856355633*^9}, {
   3.657348199376679*^9, 3.6573481999518433`*^9}, 3.657437594758095*^9, 
   3.657444245578903*^9, {3.65925906192588*^9, 3.659259062467723*^9}, {
   3.659260214389264*^9, 3.659260217317024*^9}, {3.659337024387148*^9, 
   3.6593371669783773`*^9}, {3.659337199345705*^9, 3.659337205599896*^9}, 
   3.659337265617404*^9, {3.6593465850879107`*^9, 3.6593465883348503`*^9}, {
   3.659347399973316*^9, 3.659347412964182*^9}, 3.6593475132994347`*^9, {
   3.659760767552936*^9, 3.659760767707492*^9}, {3.659768795489065*^9, 
   3.6597687981602983`*^9}, {3.659776788213683*^9, 3.659776791092033*^9}, {
   3.660974509572277*^9, 3.6609745123553762`*^9}, {3.660978312650793*^9, 
   3.66097831564158*^9}, {3.660991597718031*^9, 3.660991600565589*^9}, 
   3.6609917704366302`*^9, {3.660992258463213*^9, 3.660992260463257*^9}, {
   3.660992571612432*^9, 3.660992589435193*^9}, {3.661341184156969*^9, 
   3.661341224274884*^9}, {3.661420499322473*^9, 3.66142050375839*^9}, {
   3.661420663682588*^9, 3.66142071204136*^9}, {3.661421038344119*^9, 
   3.661421044447249*^9}, 3.661425483335516*^9, {3.661492548604806*^9, 
   3.661492570834787*^9}, {3.661593043393221*^9, 3.6615930496507883`*^9}, {
   3.66166034052385*^9, 3.661660343688787*^9}, {3.662188092366228*^9, 
   3.662188096765811*^9}, {3.662197904738613*^9, 3.662197947327422*^9}, {
   3.662198256828434*^9, 3.662198257675918*^9}, {3.6622640514534388`*^9, 
   3.662264080614355*^9}, {3.6635734696656694`*^9, 3.66357351443023*^9}, {
   3.663573573786625*^9, 3.6635735755757275`*^9}, {3.6635736144529505`*^9, 
   3.6635736203462877`*^9}, {3.6635740096645555`*^9, 3.663574012869739*^9}, {
   3.663574236727543*^9, 3.663574261259946*^9}, {3.6635743545782833`*^9, 
   3.6635743577064624`*^9}, {3.6635743911863775`*^9, 3.663574394225551*^9}, {
   3.663574668273226*^9, 3.663574673551528*^9}, {3.6635747150559015`*^9, 
   3.6635747193021445`*^9}, {3.663574795864524*^9, 3.663574810254347*^9}, {
   3.6635751301656446`*^9, 3.6635751386501303`*^9}, {3.6635761425995526`*^9, 
   3.663576146461774*^9}, {3.663576373293748*^9, 3.6635763789000683`*^9}}],

Cell[BoxData[
 RowBox[{"Jtest", "=", "60.0"}]], "Input",
 CellChangeTimes->{{3.65744473955562*^9, 3.657444740888792*^9}, {
   3.657446853169569*^9, 3.657446853441338*^9}, {3.6575072515129128`*^9, 
   3.657507257193214*^9}, {3.6575208996764107`*^9, 3.657520899772108*^9}, 
   3.657521855779954*^9, 3.657524050349365*^9, 3.6584849666595535`*^9, 
   3.6586449163010073`*^9, {3.658645249577503*^9, 3.658645249752503*^9}, 
   3.6586493776267433`*^9, 3.658649408634366*^9, {3.659760705657612*^9, 
   3.659760706631159*^9}, {3.66097437616175*^9, 3.660974377313401*^9}, 
   3.6609747105425177`*^9, {3.660992055053926*^9, 3.660992055389784*^9}, 
   3.6611349610795813`*^9, 3.6614207572313423`*^9, {3.661421051741228*^9, 
   3.6614210533890142`*^9}, {3.6614929410944242`*^9, 3.661492941214073*^9}, {
   3.662196763516865*^9, 3.662196763644162*^9}, {3.6635737666126537`*^9, 
   3.6635738392428083`*^9}, {3.6635739037154956`*^9, 3.663573914195095*^9}, {
   3.6635741520416994`*^9, 3.663574167872605*^9}, {3.663574199017386*^9, 
   3.663574207920895*^9}, {3.6635742867364035`*^9, 3.6635743064805326`*^9}, {
   3.6635743718562717`*^9, 3.663574371983279*^9}, {3.6635744129756236`*^9, 
   3.663574426143377*^9}, {3.663574685021184*^9, 3.6635746857732267`*^9}, {
   3.6635747361891108`*^9, 3.6635747364851274`*^9}, {3.6635748273973274`*^9, 
   3.663574828524392*^9}, {3.6635755340317445`*^9, 3.6635755353358192`*^9}, {
   3.663576220355*^9, 3.663576222082099*^9}}],

Cell[BoxData[
 RowBox[{"rozw", "=", 
  RowBox[{"wynik", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6636697784017696`*^9, 3.663669831398801*^9}, {
  3.6705651289438996`*^9, 3.6705651305929937`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rozw", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
      RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
      RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
      RowBox[{"ToString", "[", "Jtest", "]"}], "<>", "\"\<.m\>\""}], "]"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5077918939682813`*^9, 3.507791914564459*^9}, {
   3.5089371051661797`*^9, 3.5089371213461056`*^9}, {3.657347744485211*^9, 
   3.6573477462908163`*^9}, {3.6573478107748613`*^9, 3.657347813569992*^9}, {
   3.657347979025044*^9, 3.657347982495798*^9}, {3.6573484564754257`*^9, 
   3.657348457579075*^9}, {3.657444736217266*^9, 3.657444736712901*^9}, {
   3.657507263289003*^9, 3.657507266872979*^9}, {3.6593210514317293`*^9, 
   3.659321053413064*^9}, 3.6705651357582893`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"rozw", "=", 
    RowBox[{"wynik", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5077803251195807`*^9, 3.5077803281427536`*^9}, {
   3.507780372101268*^9, 3.5077803736243553`*^9}, 3.6584850675253224`*^9}],

Cell[BoxData[
 RowBox[{"ListPolarPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", "rozw"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5077854715559397`*^9, 3.507785507907019*^9}, {
  3.5089975087639427`*^9, 3.5089975088959503`*^9}, {3.5092945262695727`*^9, 
  3.50929452639258*^9}}],

Cell[BoxData[
 RowBox[{"rozw", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "3"}], ";;"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6635743212753787`*^9, 3.663574334200118*^9}, {
  3.66357437881667*^9, 3.6635743806477747`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "dat", "]"}]], "Input",
 CellChangeTimes->{{3.5073766055607004`*^9, 3.5073766069147778`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat", "[", "enum_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dat", "[", "enum", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "enum", "]"}], "]"}], "<>", "\"\<.m\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.507376506454032*^9, 3.50737653649475*^9}, {
   3.507476240279338*^9, 3.5074762478937736`*^9}, {3.5078029017491903`*^9, 
   3.507802918369141*^9}, 3.507809332229993*^9, {3.5081397826530514`*^9, 
   3.5081397846691666`*^9}, {3.5090938900794783`*^9, 3.50909389186058*^9}, {
   3.509163596447871*^9, 3.509163601919184*^9}, {3.5091641097632313`*^9, 
   3.509164131001446*^9}, 3.5091899509914317`*^9, 3.5092735230302563`*^9, {
   3.509274718514634*^9, 3.5092747274231434`*^9}, {3.657347773458592*^9, 
   3.657347776754591*^9}, {3.6573480315204372`*^9, 3.657348040015616*^9}, {
   3.657348086111442*^9, 3.657348087999237*^9}, 3.657348183838628*^9, {
   3.6574447513852654`*^9, 3.657444751816897*^9}, {3.659260315555888*^9, 
   3.6592603176834927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat", "[", "Jtest", "]"}], "//", "Short"}]], "Input",
 CellChangeTimes->{{3.6573481041362534`*^9, 3.6573481072463284`*^9}, {
  3.657507313208527*^9, 3.6575073152400846`*^9}, {3.657600210752247*^9, 
  3.657600211967126*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "powSpline", "]"}]], "Input",
 CellChangeTimes->{{3.5078033649266825`*^9, 3.507803368513888*^9}}],

Cell[BoxData[
 RowBox[{"Interpolation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", "rozw"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "3"}], ",", 
   RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6636698863029413`*^9, 3.6636698868139706`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"powSpline", "[", "enum_", "]"}], ":=", 
  RowBox[{
   RowBox[{"powSpline", "[", "enum", "]"}], "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", 
      RowBox[{"Import", "[", 
       RowBox[{"dir", "<>", "\"\<Solid_\>\"", "<>", 
        RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_J_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "enum", "]"}], "]"}], "<>", "\"\<.m\>\""}], 
       "]"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "3"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.50780331261069*^9, 3.507803363194584*^9}, 
   3.507809337412289*^9, {3.507823431531427*^9, 3.507823465711382*^9}, {
   3.5081397953017745`*^9, 3.508139797351892*^9}, {3.508937239999892*^9, 
   3.508937240399915*^9}, {3.508998520477809*^9, 3.5089985218828897`*^9}, {
   3.5090939017401447`*^9, 3.5090939030222187`*^9}, {3.5091573593821316`*^9, 
   3.5091573781502047`*^9}, {3.5091636100836515`*^9, 
   3.5091636120617647`*^9}, {3.509164144583223*^9, 3.509164146144312*^9}, 
   3.5091899555096903`*^9, 3.5092735280545435`*^9, {3.5092747336635003`*^9, 
   3.5092747379817476`*^9}, {3.657347790675351*^9, 3.657347794754449*^9}, {
   3.657348484347722*^9, 3.6573484850182123`*^9}, {3.6573485156390333`*^9, 
   3.657348516858882*^9}, {3.657444760361167*^9, 3.657444761016038*^9}, {
   3.659260335875827*^9, 3.659260339507381*^9}}],

Cell[BoxData[
 RowBox[{"powSpline", "[", "Jtest", "]"}]], "Input",
 CellChangeTimes->{{3.507803379554519*^9, 3.50780338219067*^9}, 
   3.657348491290833*^9, {3.657507327864524*^9, 3.657507330296027*^9}}],

Cell[BoxData[
 RowBox[{"K", "=", 
  RowBox[{"K", "/.", "rozw"}]}]], "Input",
 CellChangeTimes->{{3.6636699240410995`*^9, 3.663669930093446*^9}}],

Cell[BoxData[
 RowBox[{"\[Alpha]Eri", "=", 
  RowBox[{"Interpolation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", "rozw"}], ",", 
    RowBox[{"InterpolationOrder", "\[Rule]", "3"}], ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6636699978373203`*^9, 3.6636700260689354`*^9}}],

Cell[BoxData[
 RowBox[{"surf", "=", 
  RowBox[{"PolarPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]Eri", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
      "r0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
      RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1.5", " ", "r0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"1.5", "r0"}]}], "}"}]}], "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{
  3.5078034370498075`*^9, {3.5078036358421783`*^9, 3.5078036377392864`*^9}, {
   3.507803717961875*^9, 3.5078037229511604`*^9}, 3.507809352408147*^9, {
   3.507823358474248*^9, 3.5078233590662823`*^9}, {3.508139806554418*^9, 
   3.5081398166439953`*^9}, {3.508937490988248*^9, 3.5089374924973345`*^9}, {
   3.508997524931867*^9, 3.508997533999386*^9}, {3.5091119656773434`*^9, 
   3.50911197471086*^9}, {3.50911203923055*^9, 3.5091120423427277`*^9}, {
   3.509156986323794*^9, 3.509156988077894*^9}, {3.509157028937231*^9, 
   3.50915703783674*^9}, {3.5091622456526103`*^9, 3.509162247096693*^9}, {
   3.509163249570031*^9, 3.5091632496390347`*^9}, {3.5091633621214685`*^9, 
   3.5091633621864724`*^9}, {3.5091633965494375`*^9, 
   3.5091633967844515`*^9}, {3.5091634634232626`*^9, 
   3.5091634637082787`*^9}, {3.509163620416242*^9, 3.509163620486246*^9}, {
   3.5091638702555323`*^9, 3.5091638703195357`*^9}, {3.5091641516536274`*^9, 
   3.509164153411728*^9}, {3.509164231128173*^9, 3.5091642326022573`*^9}, {
   3.5091900388774586`*^9, 3.5091900389984655`*^9}, {3.509269065295288*^9, 
   3.509269065535302*^9}, {3.657348530587304*^9, 3.657348563081706*^9}, 
   3.657445458497101*^9, {3.657507474455944*^9, 3.657507477462317*^9}, {
   3.663576271187907*^9, 3.6635762808114576`*^9}, {3.6636699107983427`*^9, 
   3.663669913054471*^9}, {3.663670035901498*^9, 3.6636700711095114`*^9}, {
   3.670565172921415*^9, 3.670565178304723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", "rozw"}]], "Input",
 CellChangeTimes->{{3.663670213377649*^9, 3.663670263619522*^9}}],

Cell[BoxData[
 RowBox[{"R", "[", 
  RowBox[{"[", 
   RowBox[{"-", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.66367025727916*^9, 3.6636702585322313`*^9}}],

Cell[BoxData[
 RowBox[{"%%", "/", "%"}]], "Input",
 CellChangeTimes->{{3.6636702669207115`*^9, 3.6636702742591314`*^9}}],

Cell[BoxData["K"], "Input",
 CellChangeTimes->{3.6636713038890224`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"PolarPlot", ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Medium", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Dotted", ",", "Black", ",", "Medium"}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"r0", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}]}], "}"}]}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.657521095777029*^9, 3.657521110330892*^9}, {
  3.65848109891133*^9, 3.658481100071397*^9}, {3.658645202938484*^9, 
  3.6586452137369547`*^9}, {3.6609914397651043`*^9, 3.660991442004664*^9}, {
  3.660991516532745*^9, 3.660991520436364*^9}, {3.6609921675008993`*^9, 
  3.660992176972555*^9}, {3.661341476895075*^9, 3.661341484102963*^9}, {
  3.66357629134006*^9, 3.663576291499069*^9}}],

Cell[BoxData[
 RowBox[{"surfNEW", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "Jtest", "]"}], "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
        "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
        RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "Jtest", "]"}], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Pi"}], "/", "2"}], "+", "\[Theta]\[Theta]"}], "]"}], 
        ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", 
        RowBox[{"Pi", "/", "2"}], ",", " ", "Pi"}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "Jtest", "]"}], "[", 
         RowBox[{
          RowBox[{"-", "\[Theta]\[Theta]"}], "+", 
          RowBox[{"3", 
           RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", "Pi", ",", 
        RowBox[{"3", " ", 
         RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "Jtest", "]"}], "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}], "Pi"}], "+", "\[Theta]\[Theta]"}],
          "]"}], ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", 
        RowBox[{
         RowBox[{"3", "/", "2"}], "Pi"}], ",", " ", 
        RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.657521041594685*^9, 3.657521393976375*^9}, {
  3.6575214460084553`*^9, 3.657521500134912*^9}, {3.6635762983084583`*^9, 
  3.6635763189546394`*^9}}],

Cell[BoxData[
 RowBox[{"b", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"dat", "[", "Jtest", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.657521518247138*^9, 3.65752156077351*^9}, {
  3.657521632997253*^9, 3.657521633205551*^9}}],

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"dat", "[", "Jtest", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.657521563761141*^9, 3.657521568213973*^9}, {
  3.657521634277841*^9, 3.657521634437419*^9}}],

Cell[BoxData[
 RowBox[{"b", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "/", "3"}], 
    RowBox[{"R", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", "rozw"}]}]], "Input",
 CellChangeTimes->{{3.6705652524289627`*^9, 3.670565260447421*^9}, {
  3.670568877350296*^9, 3.6705688793504105`*^9}}],

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], "/.", "rozw"}]}]], "Input",
 CellChangeTimes->{{3.65760061401073*^9, 3.657600614490794*^9}, {
  3.6705652621675196`*^9, 3.670565266966794*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]0", "/.", 
  RowBox[{"dat", "[", "Jtest", "]"}]}]], "Input",
 CellChangeTimes->{{3.6614928801140347`*^9, 3.661492890895018*^9}}],

Cell[BoxData[
 RowBox[{"elipsa", "=", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"Cos", "[", "t", "]"}]}], ",", 
      RowBox[{"b", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", "Dashed", ",", "Black"}], "}"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6575215708028383`*^9, 3.657521572325902*^9}, {
  3.6575216149496307`*^9, 3.657521646244975*^9}, {3.6584810619122143`*^9, 
  3.658481091279894*^9}, {3.660991427205578*^9, 3.66099142821336*^9}, {
  3.66099150778122*^9, 3.6609915095886908`*^9}, {3.66134149519106*^9, 
  3.661341498135022*^9}, {3.6705653783841667`*^9, 3.670565381872366*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"surf", ",", "elipsa", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\[CurlyPi] [\!\(\*SubscriptBox[\(R\), \(\[CircleDot]\)]\)]\>\"", 
      ",", "\"\<z [\!\(\*SubscriptBox[\(R\), \(\[CircleDot]\)]\)]\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Alpha] Eri\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.657521647945179*^9, 3.657521656101206*^9}, {
   3.6575216908382187`*^9, 3.657521693860387*^9}, {3.658481136086457*^9, 
   3.6584811526144023`*^9}, {3.658484207553135*^9, 3.6584842088092065`*^9}, 
   3.6584851032103634`*^9, {3.6592604334903812`*^9, 3.659260441666088*^9}, {
   3.6705652766073456`*^9, 3.6705652878159866`*^9}, {3.670565456359627*^9, 
   3.6705654584557467`*^9}, {3.670565528173734*^9, 3.670565653877924*^9}, {
   3.670565899974*^9, 3.6705659319958315`*^9}, {3.6705660096912756`*^9, 
   3.670566016498665*^9}}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"dir", "<>", "\"\<Surface_alphaEri.pdf\>\""}], ",", "%"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6584849340926905`*^9, 3.6584849531957827`*^9}, {
   3.6584851128269134`*^9, 3.658485114009981*^9}, {3.658645233705751*^9, 
   3.65864523416912*^9}, {3.658645281545088*^9, 3.658645285256835*^9}, {
   3.659321129411806*^9, 3.659321130403623*^9}, 3.660974421350081*^9, {
   3.660991388725807*^9, 3.660991389861367*^9}, {3.660992084061357*^9, 
   3.660992085084756*^9}, {3.661341512366804*^9, 3.661341513198669*^9}, {
   3.6614228700896587`*^9, 3.661422871417027*^9}, {3.661492682784581*^9, 
   3.6614926839998407`*^9}, {3.661492979446599*^9, 3.661492980341792*^9}, 
   3.6635766055620327`*^9, {3.670565694381241*^9, 3.670565702180687*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PolarPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"powSpline", "[", "i", "]"}], "[", 
        RowBox[{
         RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
       "r0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
       RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1.0"}], "}"}]}], "}"}], "r0"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "\[Rule]", "\[IndentingNewLine]", 
      RowBox[{"\"\<C=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"C", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(c\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[Rho]C", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[CapitalOmega]0", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]",
     "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "Jtest"}], "}"}], ",", "0.0", ",", "Jmax", ",", 
     "\[CapitalDelta]J"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5073762386497145`*^9, 3.507376321035427*^9}, {
   3.507376371246299*^9, 3.5073765028298244`*^9}, {3.5073765539767504`*^9, 
   3.5073765630302677`*^9}, {3.507376653166424*^9, 3.507376809321355*^9}, 
   3.507377022723561*^9, {3.5074359643721733`*^9, 3.5074359649162045`*^9}, {
   3.5074762658698015`*^9, 3.507476269499009*^9}, {3.507479036661282*^9, 
   3.5074790407895184`*^9}, {3.50753580977701*^9, 3.5075358116111145`*^9}, {
   3.507802979980665*^9, 3.507802984839943*^9}, {3.507803450806595*^9, 
   3.507803460832168*^9}, {3.50780370388507*^9, 3.5078037083923273`*^9}, 
   3.5078093624207196`*^9, {3.508139837059163*^9, 3.5081398617355747`*^9}, {
   3.508937200670643*^9, 3.508937202691758*^9}, {3.5089977025800285`*^9, 
   3.5089977092174077`*^9}, {3.5091571489320946`*^9, 3.5091572075504475`*^9}, 
   3.657348620874812*^9, {3.657348857960166*^9, 3.657348859687599*^9}, {
   3.6576002257290487`*^9, 3.657600227088182*^9}, {3.660974450144598*^9, 
   3.6609744532645197`*^9}, {3.661341539791689*^9, 3.661341542703334*^9}, {
   3.6635763490353603`*^9, 3.6635763547626877`*^9}, {3.6635766127534437`*^9, 
   3.663576621096921*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]DISP", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"\[Rho]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "\[Rho]C"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "NR"}], "}"}]}], "]"}], "/.", 
      RowBox[{"dat", "[", "Jtest", "]"}]}], ",", "1"}], "]"}], "//", 
   "Interpolation"}]}]], "Input",
 CellChangeTimes->{{3.507089978040072*^9, 3.5070900570025883`*^9}, {
   3.507090124260435*^9, 3.5070901274706187`*^9}, {3.5070930231232405`*^9, 
   3.5070930458115387`*^9}, {3.507093084615758*^9, 3.507093086659875*^9}, {
   3.5070932665051613`*^9, 3.507093329045738*^9}, {3.5075174495458646`*^9, 
   3.5075174501518993`*^9}, {3.507524633336754*^9, 3.5075246350268507`*^9}, {
   3.5078038908937664`*^9, 3.5078038923988523`*^9}, {3.5078094226361637`*^9, 
   3.507809423639221*^9}, {3.5081399207529497`*^9, 3.508139921699004*^9}, {
   3.5089374672218885`*^9, 3.5089374675869093`*^9}, {3.5091120601607475`*^9, 
   3.5091120630499125`*^9}, {3.5091574270940046`*^9, 3.509157429445139*^9}, {
   3.5091622602274437`*^9, 3.5091622608374786`*^9}, {3.5091629373091707`*^9, 
   3.5091629375151825`*^9}, {3.50916298292578*^9, 3.509162983022785*^9}, {
   3.5091632579365096`*^9, 3.5091632582715287`*^9}, {3.5091633716650143`*^9, 
   3.5091633718550253`*^9}, {3.509163404178874*^9, 3.50916340446189*^9}, {
   3.509163473440836*^9, 3.5091634737888556`*^9}, {3.5091636319098997`*^9, 
   3.5091636321769147`*^9}, {3.5091638800900946`*^9, 
   3.5091638801891003`*^9}, {3.509164161104168*^9, 3.50916416236524*^9}, {
   3.509164239871673*^9, 3.509164240501709*^9}, {3.5091900456268444`*^9, 
   3.5091900458858595`*^9}, {3.5092690365446444`*^9, 3.509269036802659*^9}, 
   3.657348891958817*^9, 3.657445389586131*^9, {3.657507345240912*^9, 
   3.6575073473207808`*^9}, {3.663576690256877*^9, 3.6635766974562883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]DISPXY", "=", 
   RowBox[{
    RowBox[{"\[Rho]DISP", "[", 
     RowBox[{"\[Theta]\[Theta]", ",", "rr"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rr", "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "]"}]}], ",", 
      RowBox[{"\[Theta]\[Theta]", "\[Rule]", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", "/", "y"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5070901426184855`*^9, 3.507090198976709*^9}}],

Cell[BoxData[
 RowBox[{"cp", "=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"\[Rho]DISPXY", "*", 
     RowBox[{"UnitStep", "[", "\[Rho]DISPXY", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "r0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "r0"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Contours", "\[Rule]", 
     RowBox[{"\[Rho]0", 
      RowBox[{"{", 
       RowBox[{
       "0.01", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.4", ",", "0.5", 
        ",", "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1.0"}], 
       "}"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.507090178828556*^9, 3.5070902462094107`*^9}, {
   3.507093236043419*^9, 3.5070932383955536`*^9}, {3.507296568678384*^9, 
   3.507296571268532*^9}, {3.507785620440456*^9, 3.5077856375944366`*^9}, 
   3.5077856712603626`*^9, {3.5078040809636374`*^9, 3.507804082197708*^9}, {
   3.507804200314464*^9, 3.507804239327696*^9}, {3.5091120733865037`*^9, 
   3.509112075475623*^9}, {3.5091574423388767`*^9, 3.509157449498286*^9}, {
   3.663576654208815*^9, 3.663576671135783*^9}}],

Cell[BoxData[
 RowBox[{"dp", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]DISPXY", "*", 
       RowBox[{"UnitStep", "[", "\[Rho]DISPXY", "]"}]}], "+", 
      RowBox[{
       RowBox[{"UnitStep", "[", 
        RowBox[{"x", "-", 
         RowBox[{"1.75", "r0"}]}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"y", "-", 
         RowBox[{"0.75", "r0"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "r0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "r0"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Rho]0"}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5072966684760914`*^9, 3.5072966707622223`*^9}, {
  3.507524649474677*^9, 3.5075246568951015`*^9}, {3.5075247135833435`*^9, 
  3.507524715334444*^9}, {3.507524751485512*^9, 3.507524801318362*^9}, {
  3.507524840147583*^9, 3.507524909941575*^9}, {3.5078036481788836`*^9, 
  3.5078036486459103`*^9}, {3.5078038009006186`*^9, 3.5078038356996093`*^9}, {
  3.5078039422717047`*^9, 3.5078040624615793`*^9}, {3.5091120931286325`*^9, 
  3.5091120949007344`*^9}, {3.5091574690314035`*^9, 3.509157473907682*^9}, {
  3.509162329692417*^9, 3.5091623497335634`*^9}, {3.5091623983443437`*^9, 
  3.509162435803486*^9}, {3.509162546177799*^9, 3.509162585057023*^9}, {
  3.5091626385320816`*^9, 3.509162640416189*^9}, {3.509163377049322*^9, 
  3.509163380923544*^9}, {3.663576716992406*^9, 3.663576735511465*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "surf", ",", 
   RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.50780365021*^9, 3.507803662906726*^9}, {
  3.507804088801086*^9, 3.507804089028099*^9}, {3.507804133030616*^9, 
  3.507804134866721*^9}, {3.5091623107823353`*^9, 3.509162315686616*^9}, {
  3.509162909534582*^9, 3.5091629162589664`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<H:\\\\misiek\\\\Articles\\\\SurfaceTracking\\\\figs\\\\j-const_A_02_J_\
02.png\>\"", ",", "%", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5091629959625254`*^9, 3.50916305810608*^9}, {
   3.5091632738114176`*^9, 3.509163274002428*^9}, {3.5091633887299905`*^9, 
   3.5091634161625595`*^9}, {3.5091634851795073`*^9, 
   3.5091634854505224`*^9}, {3.5091636446166267`*^9, 3.509163648769864*^9}, {
   3.5091638984381437`*^9, 3.5091638986661572`*^9}, {3.5091641741659145`*^9, 
   3.509164177705117*^9}, {3.5091642516923494`*^9, 3.5091642523133845`*^9}, {
   3.5091900785307264`*^9, 3.509190082168935*^9}, 3.657506528369314*^9}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{"\[Rho]DISPXY", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"2.5", "r0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", 
     RowBox[{"2.5", "r0"}]}], "}"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.507780438797083*^9, 3.507780442959321*^9}, {
  3.5081399530547976`*^9, 3.5081399531268015`*^9}, {3.5091122053520517`*^9, 
  3.5091122208189363`*^9}, {3.509269087566562*^9, 3.5092690881875978`*^9}, {
  3.657506540658061*^9, 3.657506541905232*^9}, {3.6635767465360956`*^9, 
  3.663576748863229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NT", ",", "NR", ",", "NL"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"C", ",", "\[CapitalOmega]0", ",", 
      RowBox[{"R", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
  RowBox[{"dat", "[", "Jtest", "]"}]}]], "Input",
 CellChangeTimes->{{3.5081399770371695`*^9, 3.5081400102520695`*^9}, 
   3.6574460261712008`*^9, {3.658645697444034*^9, 3.6586456989800587`*^9}, {
   3.6586458429143972`*^9, 3.658645904657494*^9}, {3.6586476543823957`*^9, 
   3.658647669117798*^9}, {3.660974930667313*^9, 3.6609749532115498`*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", "\[CapitalOmega]0"}], "}"}], "/.", 
    RowBox[{"dat", "[", "j", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], "}"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rsun", " ", 
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", "rozw"}]], "Input",
 CellChangeTimes->{{3.6635798644334292`*^9, 3.6635798754890614`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "\[CapitalOmega]0"}], "}"}], "/.", 
      RowBox[{"dat", "[", "j", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.657600492140768*^9, 3.6576005837716703`*^9}, {
   3.658647289010109*^9, 3.6586473617938747`*^9}, {3.6586475302399817`*^9, 
   3.65864754814384*^9}, {3.658647606927536*^9, 3.658647613854493*^9}, 
   3.661341723982383*^9, {3.663576764896146*^9, 3.66357677247958*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}], "/.", "rozw"}]], "Input",
 CellChangeTimes->{{3.6635799245098658`*^9, 3.663579949968322*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", 
         RowBox[{"R", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "/.", 
      RowBox[{"dat", "[", "j", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658647678334565*^9, 3.658647697918109*^9}, 
   3.66134172939021*^9, {3.6635768614956713`*^9, 3.66357687143824*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalOmega]0", ",", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", 
         RowBox[{"R", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "/.", 
      RowBox[{"dat", "[", "j", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.658647755324985*^9, 3.6586477577083073`*^9}, 
   3.661341743774225*^9, {3.663576878559647*^9, 3.6635768829899006`*^9}}],

Cell[BoxData[
 RowBox[{"colorlabel", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "\[Rho]0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "/", "20"}]}], "}"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "20"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.509271682018956*^9, 3.509271700472012*^9}, {
   3.5092717365180736`*^9, 3.5092718416060843`*^9}, {3.5092718778861594`*^9, 
   3.5092719136442046`*^9}, {3.5092720228954535`*^9, 3.509272029145811*^9}, {
   3.509272182183564*^9, 3.5092721823625746`*^9}, 3.509272247635308*^9, {
   3.6635768944795575`*^9, 3.6635768953906097`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1.9", ",", "0.0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "\[Rho]C"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
                    RowBox[{"\[Rho]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", "1"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "/.", 
          RowBox[{"dat", "[", "jj", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2", "r0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "r0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"1", "\[Rho]0"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
       RowBox[{"Mesh", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ListPolarPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], "/.", 
           RowBox[{"dat", "[", "jj", "]"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ListPolarPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "NR"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
           RowBox[{"dat", "[", "jj", "]"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"powSpline", "[", "jj", "]"}], "[", 
          RowBox[{
           RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}], "r0"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "\[IndentingNewLine]", 
      RowBox[{"\"\<C=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"C", "/.", 
         RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(c\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[Rho]C", "/.", 
         RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[CapitalOmega]0", "/.", 
         RowBox[{"dat", "[", "jj", "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}], 
   RowBox[{"(*", 
    RowBox[{"Show", " ", "ends"}], " ", "*)"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"jj", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], "}"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5089983087857013`*^9, 3.508998347632923*^9}, {
   3.50899838149286*^9, 3.5089984075673513`*^9}, {3.509000527550607*^9, 
   3.509000587621043*^9}, {3.5090941579688005`*^9, 3.5090941744057407`*^9}, {
   3.5090942053555107`*^9, 3.509094230026922*^9}, {3.509112307494894*^9, 
   3.50911232595795*^9}, {3.5091124296988835`*^9, 3.509112431296975*^9}, {
   3.509157533351082*^9, 3.5091575356152115`*^9}, {3.5092692785114837`*^9, 
   3.5092692832817564`*^9}, {3.5092693788352222`*^9, 3.509269380934342*^9}, {
   3.509269435505463*^9, 3.509269435948488*^9}, {3.5092695099217196`*^9, 
   3.5092695553893204`*^9}, {3.50926959839778*^9, 3.5092696035640755`*^9}, 
   3.6584835491284747`*^9, 3.66142579052595*^9, {3.6635769045371327`*^9, 
   3.663576951853839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid1", "=", 
   RowBox[{"Show", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPolarPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "-", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], "/.", 
         RowBox[{"dat", "[", "Jtest", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5089992527896953`*^9, 3.508999395205841*^9}, {
   3.5089995705998726`*^9, 3.50899960517085*^9}, {3.5089997234786167`*^9, 
   3.508999723754633*^9}, {3.5089997699462748`*^9, 3.5089997702182903`*^9}, {
   3.509000053571497*^9, 3.5090000825841565`*^9}, 3.5090004787048135`*^9, {
   3.5091123856413636`*^9, 3.509112387345461*^9}, {3.5091575949676065`*^9, 
   3.5091575973357415`*^9}, {3.65744515744598*^9, 3.6574451590776453`*^9}, {
   3.65750744651896*^9, 3.65750744927064*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid2", "=", 
   RowBox[{"Show", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPolarPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "-", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "NR"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
         RowBox[{"dat", "[", "Jtest", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.508999425535576*^9, 3.508999611411207*^9}, {
   3.5089997288759255`*^9, 3.50899972911994*^9}, {3.5090001211253614`*^9, 
   3.509000165571903*^9}, 3.509000481127952*^9, {3.509112391450696*^9, 
   3.5091123929477816`*^9}, {3.5091576030820704`*^9, 3.509157604767167*^9}, {
   3.657445164612012*^9, 3.657445165109147*^9}, {3.657507454054987*^9, 
   3.6575074560395*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "grid1", ",", "grid2", ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<NT=\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<\\tNR=\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<\\tNL=\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<\\tJ=\>\"", "<>", 
     RowBox[{"ToString", "[", "Jtest", "]"}]}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"2", "/", "3"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.508999583620618*^9, 3.50899958751384*^9}, {
  3.508999740352582*^9, 3.5089997411516275`*^9}, {3.509000032215276*^9, 
  3.5090000342463923`*^9}, {3.657600385182806*^9, 3.6576004656131773`*^9}, {
  3.6584836881404257`*^9, 3.658483739364356*^9}, {3.6584837944605074`*^9, 
  3.6584837950435405`*^9}, {3.659261062283946*^9, 3.6592610668272676`*^9}, {
  3.6592613548885117`*^9, 3.6592613568562098`*^9}}],

Cell[BoxData[
 RowBox[{"R", "/.", 
  RowBox[{"dat", "[", "Jtest", "]"}]}]], "Input",
 CellChangeTimes->{{3.658483759181489*^9, 3.658483764660803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"jj", "=", "0.0"}], ",", 
     RowBox[{"jj", "<=", "0.235"}], ",", 
     RowBox[{"jj", "=", 
      RowBox[{"jj", "+", "0.1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"frame", "=", "\[IndentingNewLine]", 
       RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListDensityPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1.9", ",", "0.0", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "\[Rho]C"}], "}"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
                    RowBox[{"\[Rho]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], 
                    "\[IndentingNewLine]", ",", "1"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "/.", 
                  RowBox[{"dat", "[", "jj", "]"}]}]}], "\[IndentingNewLine]", 
                "}"}], "\[IndentingNewLine]", ",", 
               RowBox[{"AspectRatio", "\[Rule]", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
               RowBox[{"Mesh", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
              "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Show", "@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"ListPolarPlot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], "-", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], "/.", 
                   RowBox[{"dat", "[", "jj", "]"}]}], ",", 
                  RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"Show", "@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"ListPolarPlot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Pi", "/", "2"}], "-", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "NR"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                   "/.", 
                   RowBox[{"dat", "[", "jj", "]"}]}], ",", 
                  RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                  RowBox[{"PlotStyle", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"PolarPlot", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"powSpline", "[", "jj", "]"}], "[", 
                  RowBox[{
                   RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}],
                  ",", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
                 RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
               RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1.5"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}]}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameLabel", "\[Rule]", "\[IndentingNewLine]", 
              RowBox[{"\"\<J=\>\"", "<>", 
               RowBox[{"ToString", "[", "jj", "]"}], "<>", "\"\<, C=\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"C", "/.", 
                 RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
               "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(c\)]\)=\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"\[Rho]C", "/.", 
                 RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
               "\"\<, \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0\)]\)=\>\"", 
               "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"\[CapitalOmega]0", "/.", 
                 RowBox[{"dat", "[", "jj", "]"}]}], "]"}]}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\<j-const, A=\[Infinity]\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"1.5", ",", "0.8"}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], 
           RowBox[{"(*", 
            RowBox[{"Show", " ", "ends"}], " ", "*)"}], "\[IndentingNewLine]",
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "colorlabel", "}"}]}], "\[IndentingNewLine]", "}"}], 
        "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"GraphicsGrid", " ", "ends"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"dir", "<>", "\"\<frames//frame_\>\"", "<>", 
         RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"10000", "+", 
           RowBox[{"Rationalize", "[", 
            RowBox[{"1000", "*", "jj"}], "]"}]}], "]"}], "<>", 
         "\"\<.png\>\""}], ",", "frame", ",", 
        RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Frame \>\"", ",", 
        RowBox[{"ToString", "[", 
         RowBox[{"Rationalize", "[", 
          RowBox[{"1000", "*", "jj"}], "]"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5092697946950073`*^9, 3.509269985390915*^9}, {
  3.5092700493395724`*^9, 3.509270106830861*^9}, {3.5092719312292104`*^9, 
  3.509271994100806*^9}, {3.509272054493261*^9, 3.5092720916963882`*^9}, {
  3.509272268199484*^9, 3.509272288916669*^9}, {3.509272800871951*^9, 
  3.509272842234317*^9}, {3.5092728877499204`*^9, 3.50927294840839*^9}, {
  3.509273002664493*^9, 3.5092730065907173`*^9}, {3.509273543452424*^9, 
  3.509273579843506*^9}, {3.509274793935948*^9, 3.509274836934407*^9}, {
  3.6574457487863894`*^9, 3.657445756017482*^9}, {3.65926142353168*^9, 
  3.659261460857604*^9}, {3.66097434937963*^9, 3.660974349603444*^9}}],

Cell[BoxData[
 RowBox[{"timer4", "=", 
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "totalTimer"}]}]], "Input",
 CellChangeTimes->{{3.661426042793364*^9, 3.66142604680932*^9}, 
   3.661426156240909*^9, {3.6614264183912907`*^9, 3.661426420726903*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"timer1", ",", "timer2", ",", "timer3", ",", "timer4"}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.6614264295268908`*^9, 3.6614264366146593`*^9}}],

Cell[BoxData[{
 RowBox[{"timer1load", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_load_dKlmijk_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timer1generate", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_generate_dKlmijk_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timer2load", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_load_dlmijkOLD_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timer2generate", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_generate_dlmijkOLD_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timer3load", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_load_jac_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"timer3generate", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"dir", "<>", "\"\<timer_generate_jac_\>\"", "<>", 
    RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
    RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<.m\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6614267550288897`*^9, 3.661426859621455*^9}, {
  3.661426986332691*^9, 3.661426995019582*^9}}]
},
WindowSize->{2560, 1500},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>2. Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 217, 4, 60, "Input"],
Cell[777, 26, 1386, 27, 479, "Input"],
Cell[2166, 55, 168, 3, 60, "Input"],
Cell[2337, 60, 1307, 31, 137, "Input"],
Cell[3647, 93, 519, 13, 60, "Input"],
Cell[4169, 108, 112, 1, 60, "Input"],
Cell[4284, 111, 106, 1, 60, "Input"],
Cell[4393, 114, 452, 10, 60, "Input"],
Cell[4848, 126, 340, 8, 60, "Input"],
Cell[5191, 136, 219, 5, 60, "Input"],
Cell[5413, 143, 5774, 82, 60, "Input"],
Cell[11190, 227, 6109, 88, 60, "Input"],
Cell[17302, 317, 3955, 61, 137, "Input"],
Cell[21260, 380, 863, 18, 60, "Input"],
Cell[22126, 400, 1009, 24, 60, "Input"],
Cell[23138, 426, 1221, 29, 137, "Input"],
Cell[24362, 457, 910, 23, 60, "Input"],
Cell[25275, 482, 1498, 38, 60, "Input"],
Cell[26776, 522, 1158, 27, 175, "Input"],
Cell[27937, 551, 504, 10, 60, "Input"],
Cell[28444, 563, 651, 17, 60, "Input"],
Cell[29098, 582, 736, 16, 60, "Input"],
Cell[29837, 600, 279, 8, 60, "Input"],
Cell[30119, 610, 610, 14, 89, "Input"],
Cell[30732, 626, 1095, 28, 70, "Input"],
Cell[31830, 656, 135, 2, 60, "Input"],
Cell[31968, 660, 280, 7, 60, "Input"],
Cell[32251, 669, 2789, 66, 479, "Input"],
Cell[35043, 737, 81, 1, 60, "Input"],
Cell[35127, 740, 64, 1, 60, "Input"],
Cell[35194, 743, 106, 1, 60, "Input"],
Cell[35303, 746, 140, 3, 60, "Input"],
Cell[35446, 751, 1119, 28, 137, "Input"],
Cell[36568, 781, 300, 6, 60, "Input"],
Cell[36871, 789, 845, 24, 137, "Input"],
Cell[37719, 815, 231, 5, 60, "Input"],
Cell[37953, 822, 975, 28, 137, "Input"],
Cell[38931, 852, 929, 27, 137, "Input"],
Cell[39863, 881, 923, 27, 137, "Input"],
Cell[40789, 910, 931, 27, 137, "Input"],
Cell[41723, 939, 1798, 44, 175, "Input"],
Cell[43524, 985, 1121, 30, 175, "Input"],
Cell[44648, 1017, 926, 26, 137, "Input"],
Cell[45577, 1045, 958, 24, 137, "Input"],
Cell[46538, 1071, 677, 17, 60, "Input"],
Cell[47218, 1090, 318, 8, 60, "Input"],
Cell[47539, 1100, 640, 13, 60, "Input"],
Cell[48182, 1115, 641, 15, 60, "Input"],
Cell[48826, 1132, 925, 22, 137, "Input"],
Cell[49754, 1156, 659, 16, 99, "Input"],
Cell[50416, 1174, 871, 22, 137, "Input"],
Cell[51290, 1198, 2668, 63, 512, "Input"],
Cell[53961, 1263, 69, 1, 60, "Input"],
Cell[54033, 1266, 125, 2, 60, "Input"],
Cell[54161, 1270, 395, 10, 60, "Input"],
Cell[54559, 1282, 176, 3, 60, "Input"],
Cell[54738, 1287, 1766, 47, 137, "Input"],
Cell[56507, 1336, 1128, 22, 60, "Input"],
Cell[57638, 1360, 1997, 45, 175, "Input"],
Cell[59638, 1407, 2311, 53, 251, "Input"],
Cell[61952, 1462, 1148, 23, 175, "Input"],
Cell[63103, 1487, 8283, 179, 1011, "Input"],
Cell[71389, 1668, 4991, 117, 783, "Input"],
Cell[76383, 1787, 260, 6, 60, "Input"],
Cell[76646, 1795, 1609, 34, 213, "Input"],
Cell[78258, 1831, 887, 24, 60, "Input"],
Cell[79148, 1857, 748, 22, 60, "Input"],
Cell[79899, 1881, 373, 8, 60, "Input"],
Cell[80275, 1891, 969, 23, 60, "Input"],
Cell[81247, 1916, 917, 22, 60, "Input"],
Cell[82167, 1940, 106, 3, 60, "Input"],
Cell[82276, 1945, 5583, 122, 593, "Input"],
Cell[87862, 2069, 851, 21, 60, "Input"],
Cell[88716, 2092, 106, 3, 60, "Input"],
Cell[88825, 2097, 5014, 108, 631, "Input"],
Cell[93842, 2207, 100, 1, 60, "Input"],
Cell[93945, 2210, 106, 3, 60, "Input"],
Cell[94054, 2215, 10471, 235, 1657, "Input"],
Cell[104528, 2452, 129, 2, 60, "Input"],
Cell[104660, 2456, 333, 5, 60, "Input"],
Cell[104996, 2463, 133, 2, 60, "Input"],
Cell[105132, 2467, 130, 2, 60, "Input"],
Cell[105265, 2471, 98, 1, 60, "Input"],
Cell[105366, 2474, 294, 6, 60, "Input"],
Cell[105663, 2482, 1819, 48, 99, "Input"],
Cell[107485, 2532, 229, 6, 60, "Input"],
Cell[107717, 2540, 489, 10, 60, "Input"],
Cell[108209, 2552, 227, 6, 60, "Input"],
Cell[108439, 2560, 1327, 28, 60, "Input"],
Cell[109769, 2590, 990, 28, 251, "Input"],
Cell[110762, 2620, 765, 15, 60, "Input"],
Cell[111530, 2637, 167, 4, 60, "Input"],
Cell[111700, 2643, 211, 5, 60, "Input"],
Cell[111914, 2650, 169, 4, 60, "Input"],
Cell[112086, 2656, 671, 18, 60, "Input"],
Cell[112760, 2676, 449, 11, 60, "Input"],
Cell[113212, 2689, 540, 12, 60, "Input"],
Cell[113755, 2703, 324, 9, 60, "Input"],
Cell[114082, 2714, 605, 12, 60, "Input"],
Cell[114690, 2728, 182, 4, 60, "Input"],
Cell[114875, 2734, 129, 2, 60, "Input"],
Cell[115007, 2738, 225, 5, 60, "Input"],
Cell[115235, 2745, 145, 2, 60, "Input"],
Cell[115383, 2749, 174, 5, 60, "Input"],
Cell[115560, 2756, 525, 10, 60, "Input"],
Cell[116088, 2768, 237, 6, 60, "Input"],
Cell[116328, 2776, 307, 7, 60, "Input"],
Cell[116638, 2785, 168, 4, 60, "Input"],
Cell[116809, 2791, 192, 5, 60, "Input"],
Cell[117004, 2798, 98, 1, 60, "Input"],
Cell[117105, 2801, 69, 1, 60, "Input"],
Cell[117177, 2804, 99, 1, 60, "Input"],
Cell[117279, 2807, 286, 6, 60, "Input"],
Cell[117568, 2815, 267, 6, 85, "Input"],
Cell[117838, 2823, 417, 9, 60, "Input"],
Cell[118258, 2834, 179, 3, 60, "Input"],
Cell[118440, 2839, 99, 1, 60, "Input"],
Cell[118542, 2842, 1523, 46, 99, "Input"],
Cell[120068, 2890, 2636, 64, 175, "Input"],
Cell[122707, 2956, 95, 1, 60, "Input"],
Cell[122805, 2959, 575, 12, 60, "Input"],
Cell[123383, 2973, 617, 12, 60, "Input"],
Cell[124003, 2987, 1878, 37, 251, "Input"],
Cell[125884, 3026, 214, 5, 60, "Input"],
Cell[126101, 3033, 285, 6, 60, "Input"],
Cell[126389, 3041, 240, 6, 60, "Input"],
Cell[126632, 3049, 309, 5, 60, "Input"],
Cell[126944, 3056, 96, 1, 60, "Input"],
Cell[127043, 3059, 97, 1, 60, "Input"],
Cell[127143, 3062, 255, 5, 60, "Input"],
Cell[127401, 3069, 2711, 49, 137, "Input"],
Cell[130115, 3120, 101, 1, 60, "Input"],
Cell[130219, 3123, 226, 6, 85, "Input"],
Cell[130448, 3131, 334, 10, 85, "Input"],
Cell[130785, 3143, 178, 4, 85, "Input"],
Cell[130966, 3149, 127, 2, 85, "Input"],
Cell[131096, 3153, 226, 5, 85, "Input"],
Cell[131325, 3160, 149, 3, 85, "Input"],
Cell[131477, 3165, 129, 2, 60, "Input"],
Cell[131609, 3169, 236, 4, 60, "Input"],
Cell[131848, 3175, 98, 1, 60, "Input"],
Cell[131949, 3178, 98, 1, 60, "Input"],
Cell[132050, 3181, 96, 1, 85, "Input"],
Cell[132149, 3184, 175, 4, 85, "Input"],
Cell[132327, 3190, 128, 2, 60, "Input"],
Cell[132458, 3194, 128, 2, 60, "Input"],
Cell[132589, 3198, 69, 1, 60, "Input"],
Cell[132661, 3201, 221, 4, 60, "Input"],
Cell[132885, 3207, 134, 2, 60, "Input"],
Cell[133022, 3211, 9691, 177, 669, "Input"],
Cell[142716, 3390, 1447, 20, 60, "Input"],
Cell[144166, 3412, 275, 7, 85, "Input"],
Cell[144444, 3421, 959, 17, 60, "Input"],
Cell[145406, 3440, 329, 8, 60, "Input"],
Cell[145738, 3450, 481, 11, 85, "Input"],
Cell[146222, 3463, 238, 6, 85, "Input"],
Cell[146463, 3471, 130, 2, 60, "Input"],
Cell[146596, 3475, 1302, 23, 60, "Input"],
Cell[147901, 3500, 258, 5, 60, "Input"],
Cell[148162, 3507, 134, 2, 60, "Input"],
Cell[148299, 3511, 391, 9, 60, "Input"],
Cell[148693, 3522, 1724, 32, 238, "Input"],
Cell[150420, 3556, 203, 3, 60, "Input"],
Cell[150626, 3561, 144, 3, 85, "Input"],
Cell[150773, 3566, 431, 10, 85, "Input"],
Cell[151207, 3578, 2420, 50, 124, "Input"],
Cell[153630, 3630, 171, 4, 85, "Input"],
Cell[153804, 3636, 163, 4, 85, "Input"],
Cell[153970, 3642, 120, 2, 85, "Input"],
Cell[154093, 3646, 71, 1, 85, "Input"],
Cell[154167, 3649, 1148, 30, 85, "Input"],
Cell[155318, 3681, 2132, 61, 99, "Input"],
Cell[157453, 3744, 276, 7, 60, "Input"],
Cell[157732, 3753, 298, 8, 60, "Input"],
Cell[158033, 3763, 317, 9, 85, "Input"],
Cell[158353, 3774, 267, 7, 85, "Input"],
Cell[158623, 3783, 167, 3, 60, "Input"],
Cell[158793, 3788, 895, 22, 85, "Input"],
Cell[159691, 3812, 941, 17, 85, "Input"],
Cell[160635, 3831, 798, 13, 85, "Input"],
Cell[161436, 3846, 3053, 67, 251, "Input"],
Cell[164492, 3915, 2681, 51, 213, "Input"],
Cell[167176, 3968, 577, 16, 60, "Input"],
Cell[167756, 3986, 1265, 28, 99, "Input"],
Cell[169024, 4016, 1774, 38, 99, "Input"],
Cell[170801, 4056, 393, 7, 60, "Input"],
Cell[171197, 4065, 759, 13, 60, "Input"],
Cell[171959, 4080, 740, 17, 60, "Input"],
Cell[172702, 4099, 723, 17, 60, "Input"],
Cell[173428, 4118, 296, 9, 60, "Input"],
Cell[173727, 4129, 224, 6, 60, "Input"],
Cell[173954, 4137, 704, 16, 60, "Input"],
Cell[174661, 4155, 193, 5, 60, "Input"],
Cell[174857, 4162, 727, 20, 60, "Input"],
Cell[175587, 4184, 746, 20, 60, "Input"],
Cell[176336, 4206, 1067, 25, 99, "Input"],
Cell[177406, 4233, 8310, 196, 1467, "Input"],
Cell[185719, 4431, 1565, 36, 137, "Input"],
Cell[187287, 4469, 1375, 34, 60, "Input"],
Cell[188665, 4505, 1202, 24, 99, "Input"],
Cell[189870, 4531, 150, 3, 60, "Input"],
Cell[190023, 4536, 11127, 236, 1885, "Input"],
Cell[201153, 4774, 260, 5, 340, "Input"],
Cell[201416, 4781, 185, 4, 340, "Input"],
Cell[201604, 4787, 2262, 44, 1426, "Input"]
}
]
*)

