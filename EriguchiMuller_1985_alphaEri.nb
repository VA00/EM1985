(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    145137,       3889]
NotebookOptionsPosition[    136803,       3677]
NotebookOutlinePosition[    137267,       3695]
CellTagsIndexPosition[    137224,       3692]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Quit", "[", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.507275123100278*^9, 3.507275124377351*^9}, {
   3.507516405718161*^9, 3.5075164068292246`*^9}, 3.658661243355674*^9}],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "TODO", "\[IndentingNewLine]", "\[IndentingNewLine]", "1.", " ", "Update", 
    " ", "trapezoidal", " ", "integration", " ", "with", " ", "something", 
    " ", "more", " ", "accurate"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", "Gauss"}], " ", "integration", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"EM1985", " ", "used", " ", "Simpson", " ", "rule"}], ",", " ", 
       RowBox[{
       "but", " ", "only", " ", "in", " ", "radial", " ", "direction"}]}], 
      ")"}], "\[IndentingNewLine]", "2.", " ", "Update", " ", "to", " ", 
     "handle", " ", "n"}], "\[NotEqual]", 
    RowBox[{"1", " ", "polytropic", " ", 
     RowBox[{"index", ".", "\[IndentingNewLine]", "3."}], " ", "Replace", " ",
      "LegendereP", " ", "with", " ", "stable", " ", 
     RowBox[{"implementation", ".", "\[IndentingNewLine]", "4."}], " ", 
     "Replace", " ", "kernels", " ", "with", " ", "something", " ", "free", 
     " ", "of", " ", "Legendere", " ", "expansion"}]}], ",", " ", 
   RowBox[{
    RowBox[{"e", ".", "g", ".", " ", "EllipticK"}], " ", "kernels"}]}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.663583144203021*^9, 3.663583338288122*^9}}],

Cell[BoxData[
 RowBox[{"totalTimer", " ", "=", " ", 
  RowBox[{"AbsoluteTime", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.661426013983589*^9, 3.661426023978047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
     "\"\<http://adsabs.harvard.edu/abs/1985A%26A...146..260E\>\"", ",", 
      "\"\<HTML\>\""}], "]"}], ";"}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Uncomment", " ", "line", " ", "above", " ", "to", " ", "get", " ", 
     "main", " ", "reference", " ", "for", " ", "the", " ", 
     RowBox[{"method", ".", " ", "\[IndentingNewLine]", "Eriguchi"}]}], ",", 
    RowBox[{
     RowBox[{"Y", "."}], ";", "Mueller"}], ",", 
    RowBox[{"E", "."}], ",", " ", 
    RowBox[{"Astronomy", " ", "and", " ", "Astrophysics", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ISSN", " ", "0004"}], "-", "6361"}], ")"}]}], ",", 
    RowBox[{"vol", ".", "146"}], ",", 
    RowBox[{"no", ".", "2"}], ",", 
    RowBox[{"May", " ", "1985"}], ",", 
    RowBox[{
     RowBox[{"p", ".", "260"}], "-", "268."}]}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"conv", " ", "\[Rule]", " ", 
     RowBox[{
     "convert", " ", "rationals", " ", "onto", " ", "machine", " ", 
      "precision", " ", "numbers"}]}], ";", " ", 
    RowBox[{
    "if", " ", "you", " ", "prefer", " ", "to", " ", "keep", " ", 
     "rationals"}]}], ",", " ", "use", " ", ",", ",", 
   RowBox[{
    RowBox[{"identity", "''"}], " ", "conv"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5077785992268653`*^9, 3.507778656450138*^9}}],

Cell[BoxData["$OperatingSystem"], "Input",
 CellChangeTimes->{{3.6578705493581047`*^9, 3.6578705527542987`*^9}}],

Cell[BoxData["$HomeDirectory"], "Input",
 CellChangeTimes->{{3.658484359260812*^9, 3.658484360819901*^9}}],

Cell[BoxData[
 RowBox[{"dir", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$OperatingSystem", "==", "\"\<Windows\>\""}], ",", 
    "\"\<H:\\\\misiek/RotatingStars/EM/alphaEri/\>\"", ",", " ", 
    "\"\</home/misiek/RotatingStars/EM/alphaEri/\>\""}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"conv", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"N", "[", "#", "]"}], "&"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.507692044454732*^9, 3.507692056254407*^9}, {
   3.507692114099715*^9, 3.507692114388732*^9}, 3.659261504592897*^9, 
   3.663566625799223*^9, 3.6635689394425554`*^9}],

Cell[BoxData[
 RowBox[{"conv", "=", 
  RowBox[{"(", 
   RowBox[{"#", "&"}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"NT", "=", "7", 
   RowBox[{"(*", " ", 
    RowBox[{"angular", " ", "rays", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAX", " ", "NT"}], "=", 
       RowBox[{"32", " ", "tested"}]}], ")"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.671543700625744*^9, {3.671544256179451*^9, 3.671544273402964*^9}, {
   3.67154586780042*^9, 3.671545868576112*^9}, {3.67154748096525*^9, 
   3.671547481493236*^9}, {3.67154882469247*^9, 3.671548825308249*^9}, 
   3.671618724474581*^9, {3.671620187369074*^9, 3.671620187816636*^9}, {
   3.671640530045051*^9, 3.6716405326449966`*^9}}],

Cell[BoxData[
 RowBox[{"NR", "=", "6", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"radial", " ", "slices"}], ",", " ", 
    RowBox[{"including", " ", "surface"}], ",", " ", 
    RowBox[{"without", " ", "center", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAX", " ", "NR"}], "=", 
       RowBox[{"32", " ", "tested"}]}], " ", ")"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.671544259187002*^9, 3.6715442759708223`*^9}, {
   3.671547477645596*^9, 3.67154747822129*^9}, {3.67154882737999*^9, 
   3.6715488280920687`*^9}, 3.671618726258559*^9, {3.6716201894570217`*^9, 
   3.671620189904731*^9}, {3.67164053504506*^9, 3.671640537445283*^9}}],

Cell[BoxData[
 RowBox[{"NL", "=", "8", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "Legendre", " ", "polynomials", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAX", " ", "NL"}], "=", 
       RowBox[{"20", " ", "tested"}]}], ")"}], ".", " ", 
     RowBox[{"WARNING", ":", " ", 
      RowBox[{"too", " ", "large", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"e", ".", "g", ".", " ", "NL"}], "=", "32"}], ")"}], " ", 
       "number", " ", "of", " ", "Legendere", " ", "polynomials", " ", 
       "might", " ", "cause", " ", "numerical", " ", "instability", " ", 
       "and", " ", "catastrophic", " ", 
       RowBox[{"errors", " ", "!"}]}]}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.671544265315061*^9, 3.6715442654264727`*^9}, {
  3.671547483877221*^9, 3.671547484173255*^9}, {3.671548829940218*^9, 
  3.671548830308085*^9}, {3.671618728146682*^9, 3.67161872912262*^9}, {
  3.671620191297077*^9, 3.671620191768732*^9}, {3.6716405398930902`*^9, 
  3.671640541341004*^9}}],

Cell[BoxData[
 RowBox[{"R", " ", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"\"\<R\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"radius", " ", "of", " ", "the", " ", "stellar", " ", "surface"}], 
   " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"abc", ",", "weights", ",", "err"}], "}"}], "=", 
    RowBox[{
     RowBox[{"NIntegrate`TrapezoidalRuleData", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NR", "/", "2"}], "+", "1"}], ",", "64"}], "]"}], "//", 
     "Rationalize"}]}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "interesuj\:0105", " ", "nas", " ", "wagi", " ", "i", " ", "punkty", " ", 
    "opr\[OAcute]cz", " ", "1", " ", "i", " ", "ostatniej"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NIntegrate`NewtonCotesRuleData", "[", 
    RowBox[{"NR", ",", "$MachinePrecision"}], "]"}], "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"abc", ",", "weights", ",", "err"}], "}"}], "=", 
   RowBox[{
    RowBox[{"NIntegrate`NewtonCotesRuleData", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NR", "/", "2"}], "+", "1"}], ",", "64"}], "]"}], "//", 
    "Rationalize"}]}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"abc", ",", "weights", ",", "err"}], "}"}], "=", 
   RowBox[{"NIntegrate`GaussBerntsenEspelidRuleData", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NR", "/", "2"}], "+", "1"}], ",", "4"}], "]"}]}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"abc", ",", "weights", ",", "err"}], "}"}], "=", 
   RowBox[{"NIntegrate`GaussRuleData", "[", 
    RowBox[{"NR", ",", "64"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671543712166671*^9, 3.671543712326675*^9}, 
   3.6715487740922127`*^9}],

Cell[BoxData[
 RowBox[{"Length", "[", "abc", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"abc", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "*", 
      RowBox[{"R", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.67154466649964*^9, {3.671544754073024*^9, 3.671544754199391*^9}, {
   3.671548745839015*^9, 3.671548772492701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"j", "/", "NR"}], "*", 
        RowBox[{"R", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], "//", "conv"}]}], 
   "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"discretized", " ", "radial", " ", "grid", " ", "coordinates"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.671544658848037*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]r", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"weights", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "*", 
      RowBox[{"R", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6715446879504128`*^9, 3.67154469216833*^9}, 
   3.671548777084786*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[CapitalDelta]r", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"weights", "[", 
         RowBox[{"[", 
          RowBox[{"j", "+", "1"}], "]"}], "]"}], "*", 
        RowBox[{"R", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[CapitalDelta]r", "=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "/", "NR"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], "//", "conv"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"trapezoidal", " ", "integration", " ", "rule"}], ",", " ", 
    RowBox[{"central", " ", "point", " ", "not", " ", "included"}], ",", " ", 
    RowBox[{"surface", " ", "weigth", " ", "assumed", " ", "ZERO"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{3.6715446739289103`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[Theta]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Pi", "/", "2"}], "*", 
         RowBox[{"i", "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"NT", "-", "1"}]}], "}"}]}], "]"}], "//", "conv"}], "//", 
     "N"}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"angular", " ", "grid"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070001792198253`*^9, 3.5070002821447124`*^9}, {
   3.5074335813638725`*^9, 3.507433582003909*^9}, {3.50743833578281*^9, 
   3.5074383384729643`*^9}, {3.5074460113021564`*^9, 
   3.5074460116571765`*^9}, {3.5076883672114058`*^9, 3.507688367563426*^9}, {
   3.5077014832869844`*^9, 3.507701484331044*^9}, {3.5077787717937355`*^9, 
   3.507778776172986*^9}, 3.660975316135915*^9, {3.6715450193739567`*^9, 
   3.671545036658304*^9}, {3.6715452863261957`*^9, 3.671545292876431*^9}, {
   3.671546215855192*^9, 3.67154621624583*^9}, 3.671546565778247*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[Theta]", "=", 
   RowBox[{
    RowBox[{"Pi", "/", "2"}], " ", 
    RowBox[{
     RowBox[{"NIntegrate`GaussRuleData", "[", 
      RowBox[{"NT", ",", "64"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.671544995245976*^9, 3.671545040485713*^9}, {
   3.671545302364994*^9, 3.67154530355558*^9}, 3.67154656207314*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[Theta]", "=", 
   RowBox[{
    RowBox[{"Pi", "/", "2"}], " ", 
    RowBox[{
     RowBox[{"NIntegrate`NewtonCotesRuleData", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NT", "+", "1"}], ")"}], "/", "2"}], ",", "64"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.671545792944713*^9, 3.671545834568098*^9}, {
   3.6715458954724092`*^9, 3.671545909439946*^9}, 3.671546558521472*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{
    RowBox[{"Pi", "/", "2"}], " ", 
    RowBox[{
     RowBox[{"NIntegrate`LobattoKronrodRuleData", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NT", "+", "1"}], ")"}], "/", "2"}], ",", "64"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6715465253880568`*^9, 3.671546550891515*^9}, 
   3.671548782204783*^9}],

Cell[BoxData[
 RowBox[{"Length", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.671545818058683*^9, 3.67154581973641*^9}}],

Cell[BoxData["NT"], "Input",
 CellChangeTimes->{{3.671545823058826*^9, 3.671545823219728*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.671545781776022*^9, 3.671545783968623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[CapitalDelta]\[Theta]", "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], "/", "2"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"NT", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "/", 
          RowBox[{"(", 
           RowBox[{"NT", "-", "1"}], ")"}]}], "/", "2"}], "}"}]}], "]"}], " ",
      "//", "conv"}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"trapezoidal", " ", "rule"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.50700534603835*^9, 3.507005369691703*^9}, {
   3.5070911960887403`*^9, 3.5070912214471908`*^9}, {3.5070912537560387`*^9, 
   3.507091270163977*^9}, {3.5070913382078695`*^9, 3.5070913704017105`*^9}, {
   3.5070914763377695`*^9, 3.5070914831491594`*^9}, {3.5074335899803658`*^9, 
   3.50743359040739*^9}, {3.5074383423961887`*^9, 3.507438342667204*^9}, {
   3.507446015634404*^9, 3.507446016017426*^9}, {3.50768837270072*^9, 
   3.507688373004737*^9}, {3.507701487939251*^9, 3.507701489240325*^9}, 
   3.657446639509211*^9, {3.671545059622151*^9, 3.671545065539769*^9}, {
   3.671546260787677*^9, 3.671546270101618*^9}, {3.671546571203773*^9, 
   3.671546573660017*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[CapitalDelta]\[Theta]", "=", 
   RowBox[{
    RowBox[{"NIntegrate`GaussRuleData", "[", 
     RowBox[{"NT", ",", "64"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.671545071597595*^9, 3.671545075733445*^9}, 
   3.6715459184485683`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[CapitalDelta]\[Theta]", "=", 
   RowBox[{
    RowBox[{"NIntegrate`NewtonCotesRuleData", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"NT", "+", "1"}], ")"}], "/", "2"}], ",", "64"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.671545928135776*^9, 3.671545940095624*^9}, {
  3.671546584779935*^9, 3.671546592894141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Theta]", "=", 
   RowBox[{
    RowBox[{"Pi", "/", "2"}], " ", 
    RowBox[{
     RowBox[{"NIntegrate`LobattoKronrodRuleData", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"NT", "+", "1"}], ")"}], "/", "2"}], ",", "64"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671546597811349*^9, 3.671546600075138*^9}, 
   3.671548785340474*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<\[Rho]\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<x\>\"", "<>", 
          RowBox[{"ToString", "[", "j", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "unknown", " ", "densities", " ", "at", " ", "grid", " ", "points"}], ";",
     " ", 
    RowBox[{"zero", " ", "at", " ", "surface"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5070013888920145`*^9, 3.5070014724917965`*^9}, {
   3.5070015040926037`*^9, 3.507001520266529*^9}, {3.507546951397534*^9, 
   3.5075469814592533`*^9}, {3.507547058276647*^9, 3.507547062508889*^9}, {
   3.5077787993833137`*^9, 3.507778829751051*^9}, 3.6574466456691427`*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"\[CapitalOmega]", "=", 
   RowBox[{"(", 
    RowBox[{"\[CapitalOmega]0", "&"}], ")"}], " ", 
   RowBox[{"(*", 
    RowBox[{"solid", " ", "body", " ", "rotation"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.5074452177997704`*^9, 3.507445232325601*^9}, {
   3.5074452789072657`*^9, 3.5074452869117236`*^9}, {3.5076131645981865`*^9, 
   3.507613172058614*^9}, {3.5079055990643635`*^9, 3.5079056054237275`*^9}, 
   3.6572800346566544`*^9, 3.657281082105565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"\[CapitalOmega]", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalOmega]0", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"#", "^", "2"}], "/", 
          RowBox[{"A", "^", "2"}]}]}], ")"}]}], "&"}], ")"}]}], "*)"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"j", "-", 
    RowBox[{"const", " ", "rotation", " ", "law"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072952811287403`*^9, 3.5072953005858526`*^9}, {
   3.50744520486003*^9, 3.507445212186449*^9}, {3.507778837502494*^9, 
   3.5077788460819845`*^9}, 3.6572810746401377`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"-", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"\[Zeta]", " ", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "\[Zeta]", "]"}], "^", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]", ",", "0", ",", "x"}], "}"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.5072749843903437`*^9, 3.5072749847063622`*^9}, {
   3.507275149987816*^9, 3.5072751501248236`*^9}, {3.507278140165844*^9, 
   3.5072781406658726`*^9}, 3.5072782637329116`*^9, 3.507278337904154*^9, {
   3.507278403673916*^9, 3.50727840374292*^9}, 3.5072786230424633`*^9, {
   3.5072787122795672`*^9, 3.5072787124285755`*^9}, {3.507295401903648*^9, 
   3.507295467771415*^9}, 3.6575237568182487`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Refine", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{"x", ">", "0"}], "&&", 
     RowBox[{"A", ">", "0"}]}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5074453477942057`*^9, 3.507445378954988*^9}, 
   3.65752375920151*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"\[CapitalPhi]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     SuperscriptBox["#", "2"], " ", 
     SuperscriptBox["\[CapitalOmega]0", "2"]}], "&"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"solid", " ", "body", " ", "rotation"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.507295486700498*^9, 3.50729550666364*^9}, {
   3.50729572258899*^9, 3.5072957358227468`*^9}, {3.507690614948969*^9, 
   3.507690618049146*^9}, {3.5079056097499747`*^9, 3.507905614274234*^9}, 
   3.6572800606901436`*^9, 3.6572810965443907`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[CapitalPhi]C", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"A", "^", "2"}], 
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalOmega]0", "^", "2"}], "/", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"#", "^", "2"}], "/", 
          RowBox[{"A", "^", "2"}]}]}], ")"}]}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["A", "2"], " ", 
      SuperscriptBox["\[CapitalOmega]0", "2"]}]}], "&"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"centrifugal", " ", "potential"}], ";", " ", 
    RowBox[{"normalized", " ", "to", " ", "zero", " ", "at", " ", 
     RowBox[{"center", " ", "!"}]}]}], " ", "*)"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5074404308956437`*^9, 3.507440452738893*^9}, {
   3.5074406692812786`*^9, 3.50744068417113*^9}, 3.5074454044374456`*^9, {
   3.5074731040269547`*^9, 3.507473107182135*^9}, {3.5074738537558365`*^9, 
   3.507473859466163*^9}, {3.507778850292226*^9, 3.507778865650104*^9}, 
   3.657281090854066*^9}],

Cell[BoxData[
 RowBox[{"\[CapitalPhi]C", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.507778873122531*^9, 3.5077788762367096`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"\[CapitalPhi]C", "[", "x", "]"}], ",", 
    RowBox[{"x", "\[Rule]", "Infinity"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.507778884357174*^9, 3.507778894691765*^9}, 
   3.657523764015202*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"kernel0", "[", 
     RowBox[{
      RowBox[{"ra_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
      RowBox[{"rb_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
      RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"rb", "^", 
           RowBox[{"(", 
            RowBox[{"2", "n"}], ")"}]}], "/", 
          RowBox[{"ra", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", " ", "n"}], ",", " ", "Cos\[Theta]a"}], "]"}], "*", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", "n"}], " ", ",", "Cos\[Theta]b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "nLeg"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ra", "^", 
           RowBox[{"(", 
            RowBox[{"2", "n"}], ")"}]}], "/", 
          RowBox[{"rb", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", " ", "n"}], ",", " ", "Cos\[Theta]a"}], "]"}], "*", 
         RowBox[{"LegendreP", "[", 
          RowBox[{
           RowBox[{"2", "n"}], " ", ",", "Cos\[Theta]b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "0", ",", "nLeg"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.507438428518114*^9, 3.5074385456068115`*^9}, {
   3.5074386156118155`*^9, 3.507438628039526*^9}, {3.5074388330972548`*^9, 
   3.5074388360294223`*^9}, 3.507439050142669*^9, 3.5074391073129387`*^9, {
   3.5074398373596954`*^9, 3.5074398488463526`*^9}, 3.507461132722235*^9, {
   3.5075221409411974`*^9, 3.507522215945487*^9}, {3.5076133116856003`*^9, 
   3.507613316710887*^9}, {3.5076478832459745`*^9, 3.5076478855041037`*^9}, {
   3.507650506376009*^9, 3.507650515165511*^9}, {3.5076508003818245`*^9, 
   3.5076508042450457`*^9}, {3.507702785886489*^9, 3.5077027943709745`*^9}, {
   3.659675776733437*^9, 3.659675782350647*^9}, {3.659689392639531*^9, 
   3.6596893975658293`*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CCompilerDriver`\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DefaultCCompiler", "[", "]"}]], "Input"],

Cell[BoxData["$CCompiler"], "Input",
 CellChangeTimes->{{3.5076487220409503`*^9, 3.5076487220419507`*^9}}],

Cell[BoxData[
 RowBox[{"$CCompiler", "=", 
  RowBox[{"DefaultCCompiler", "[", "]"}]}]], "Input",
 CellChangeTimes->{3.5076488032365947`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rb", "^", 
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}]}], "/", 
       RowBox[{"ra", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507689464916191*^9, 3.507689509395735*^9}, 
   3.5076906369382267`*^9, {3.5076950391223993`*^9, 3.5076950423725853`*^9}, 
   3.6596886062641478`*^9, {3.659688814053831*^9, 3.6596888164206743`*^9}, {
   3.659689126738173*^9, 3.659689128033052*^9}, {3.6596892247531013`*^9, 
   3.659689237839781*^9}, {3.659689621500389*^9, 3.6596896513353357`*^9}, {
   3.659690342085038*^9, 3.659690342434844*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ra", "^", 
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}]}], "/", 
       RowBox[{"rb", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076895216674366`*^9, 3.5076895310359726`*^9}, 
   3.507690639825392*^9, {3.5076950474138737`*^9, 3.5076950489799633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1Da", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "ra"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507689902179201*^9, 3.507689927845669*^9}, 
   3.5076906419355125`*^9, {3.507695051809125*^9, 3.507695053255208*^9}, {
   3.657437286856653*^9, 3.657437287992927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part1Db", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "rb"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899397653503`*^9, 3.5076899421784887`*^9}, 
   3.507690644229644*^9, {3.5076950585145082`*^9, 3.507695060200605*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2Da", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "ra"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899598585*^9, 3.5076899784725647`*^9}, 
   3.5076906468167915`*^9, {3.507695063993822*^9, 3.5076950653539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"part2Db", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ra", "^", 
          RowBox[{"(", 
           RowBox[{"2", "n"}], ")"}]}], "/", 
         RowBox[{"rb", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "1"}], ")"}]}]}], ",", "rb"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", " ", "n"}], ",", " ", "ca"}], "]"}], "*", 
      RowBox[{"LegendreP", "[", 
       RowBox[{
        RowBox[{"2", "n"}], " ", ",", "cb"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "NL"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5076899944314775`*^9, 3.5076900005278263`*^9}, 
   3.5076906493359356`*^9, {3.507695069766152*^9, 3.5076950713472424`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kernel5", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
         RowBox[{
          RowBox[{"Evaluate", "[", "part1", "]"}], "//", "Evaluate"}], ",", 
         RowBox[{"Evaluate", "[", "part2", "]"}]}], "]"}], "//", "Evaluate"}],
       ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "False"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "kernel", " ", "seems", " ", "to", " ", "be", " ", 
     "fastest"}], ";", " ", 
    RowBox[{
    "tested", " ", "on", " ", "Microsoft", " ", "Visual", " ", "Studio", " ", 
     "Compiler", " ", "and", " ", "GCC"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.5076895352162113`*^9, 3.507689569843192*^9}, {
   3.507689612955658*^9, 3.5076896698039093`*^9}, 3.507690367556819*^9, {
   3.507778970571105*^9, 3.5077789939484425`*^9}, {3.6596760297236147`*^9, 
   3.659676044298897*^9}, 3.6596760853555*^9, {3.659676139402717*^9, 
   3.659676140569154*^9}, {3.659676614276845*^9, 3.65967661558779*^9}, {
   3.659677045678934*^9, 3.65967704902274*^9}, {3.6609769578147573`*^9, 
   3.6609769662457523`*^9}, 3.670738963391366*^9, {3.670739527407819*^9, 
   3.670739540090616*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"kernel5Da", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
         RowBox[{"Evaluate", "[", "part1Da", "]"}], ",", 
         RowBox[{"Evaluate", "[", "part2Da", "]"}]}], "]"}], "//", 
       "Evaluate"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"derivatives", " ", "of", " ", "the", " ", "kernel"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.5076900708688493`*^9, 3.507690080796417*^9}, 
   3.5076903715680485`*^9, {3.5077790051120806`*^9, 3.507779014526619*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kernel5Db", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ra", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ca", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rb", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"cb", ",", "_Real"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ra", "\[GreaterEqual]", "rb"}], ",", 
        RowBox[{"Evaluate", "[", "part1Db", "]"}], ",", 
        RowBox[{"Evaluate", "[", "part2Db", "]"}]}], "]"}], "//", 
      "Evaluate"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.507690092574091*^9, 3.5076900974423695`*^9}, 
   3.5076903737211714`*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"kernel", "[", 
     RowBox[{
      RowBox[{"ra_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
      RowBox[{"rb_", "?", "NumericQ"}], ",", 
      RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
      RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"kernel5", "[", 
     RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "wrapper", " ", "for", " ", "convenient", " ", "use", " ", "within", " ",
       "Mathematica"}], ";", " ", 
     RowBox[{
     "note", " ", "that", " ", "this", " ", "slow", " ", "down", " ", "by", 
      " ", "a", " ", "factor", " ", "of", " ", "two"}]}], " ", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.50769012141274*^9, 3.507690121493745*^9}, {
  3.5077790203389516`*^9, 3.507779053585853*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
    "kernel", "]"}], "[", 
   RowBox[{
    RowBox[{"ra_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
    RowBox[{"rb_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
    RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"kernel5Da", "[", 
   RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "derivatives", " ", "of", " ", "the", " ", "kernel", " ", "required", " ", 
    "for", " ", "Jacobian", " ", "generation"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5076901733117085`*^9, 3.5076902045174932`*^9}, {
  3.5077790819574757`*^9, 3.5077790948512135`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], "[", 
    "kernel", "]"}], "[", 
   RowBox[{
    RowBox[{"ra_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]a_", "?", "NumericQ"}], ",", 
    RowBox[{"rb_", "?", "NumericQ"}], ",", 
    RowBox[{"Cos\[Theta]b_", "?", "NumericQ"}], ",", 
    RowBox[{"nLeg_", "?", "NumericQ"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"kernel5Db", "[", 
   RowBox[{"ra", ",", "Cos\[Theta]a", ",", "rb", ",", "Cos\[Theta]b"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5076902147770805`*^9, 3.5076902213224545`*^9}}],

Cell[BoxData[
 RowBox[{"kernel5", "[", 
  RowBox[{"0", ",", 
   RowBox[{"1", "/", "2"}], ",", "1", ",", 
   RowBox[{"1", "/", "3"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671543948970888*^9, 3.6715439959248123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Most", "[", "R", "]"}], ",", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", "\[Rho]", "]"}], ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"C", ",", "\[Rho]C", ",", "K"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.671553419061081*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"potencjal", " ", "w", " ", "centrum"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.507006050245629*^9, 3.5070060558899517`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalPhi]0", "=", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "Pi", " ", "G", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
        "\[Theta]", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
        "]"}], " ", 
       RowBox[{
       "\[CapitalDelta]\[Theta]", "\[LeftDoubleBracket]", "l", 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], 
          RowBox[{"\[CapitalDelta]r", "\[LeftDoubleBracket]", 
           RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"\[Rho]", "\[LeftDoubleBracket]", 
           RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "NT"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "gravitational", " ", "potential", " ", "at", " ", "the", " ", 
      "center"}], ";", " ", 
     RowBox[{"NOTE", ":", " ", 
      RowBox[{
      "this", " ", "is", " ", "exact", " ", "discretized", " ", 
       "formula"}]}]}], ",", " ", 
    RowBox[{"no", " ", "Legendre", " ", "expansion", " ", "used"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.507087785548669*^9, 3.5070878951099353`*^9}, {
   3.507088438005987*^9, 3.507088439508073*^9}, {3.507271843024668*^9, 
   3.5072718499210625`*^9}, {3.50768843424424*^9, 3.50768843651637*^9}, {
   3.507691442954328*^9, 3.5076914504817586`*^9}, 3.507692564284847*^9, {
   3.5077791799270797`*^9, 3.5077792316950407`*^9}, {3.671555060169786*^9, 
   3.67155509259359*^9}, {3.671618743298661*^9, 3.6716187435386677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fLHS", "=", "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", " ", "K", " ", "\[Rho]C"}], "+", 
          RowBox[{"\[CapitalPhi]C", "[", "0", "]"}], "+", "\[CapitalPhi]0", 
          "-", "C"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"M", "-", 
          RowBox[{"2", " ", "Pi", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{
               "\[Theta]", "\[LeftDoubleBracket]", "l", 
                "\[RightDoubleBracket]"}], "]"}], 
              RowBox[{
              "\[CapitalDelta]\[Theta]", "\[LeftDoubleBracket]", "l", 
               "\[RightDoubleBracket]"}], " ", 
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], "^", 
               "2"}], " ", 
              RowBox[{"\[CapitalDelta]r", "\[LeftDoubleBracket]", 
               RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], " ", 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "\[LeftDoubleBracket]", 
               RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", " ", "K", " ", 
            RowBox[{"\[Rho]", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], "+", 
           RowBox[{"\[CapitalPhi]C", "[", " ", 
            RowBox[{
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
              "\[Theta]", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}]}], " ", "]"}], "-", 
           RowBox[{"2", " ", "Pi", " ", "G", " ", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{
                "\[Theta]", "\[LeftDoubleBracket]", "l", 
                 "\[RightDoubleBracket]"}], "]"}], 
               RowBox[{
               "\[CapitalDelta]\[Theta]", "\[LeftDoubleBracket]", "l", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{
                RowBox[{"r", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], "^", 
                "2"}], " ", 
               RowBox[{"\[CapitalDelta]r", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "m"}], "\[RightDoubleBracket]"}], " ", 
               "\[IndentingNewLine]", 
               RowBox[{"kernel", "[", " ", 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"r", "[", 
                  RowBox[{"[", 
                   RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Theta]", "[", 
                   RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
               "*", 
               RowBox[{"\[Rho]", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "-", 
           "C"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], "//", "Flatten"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}], 
        "}"}]}], ",", " ", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671555126809997*^9, 3.6715552318573008`*^9}, {
  3.671555294456634*^9, 3.671555348016399*^9}, {3.671618748667742*^9, 
  3.671618749035577*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"G", ",", "M", ",", "K", ",", "\[Rho]C", ",", "\[Rho]0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6635669380850844`*^9, 3.663566941868301*^9}, {
  3.663567968798038*^9, 3.663567969581083*^9}, {3.663568008381302*^9, 
  3.6635680091243443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"h", "[", "\[Zeta]", "]"}], "/", "2"}], "/", "K"}], "/.", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", 
               RowBox[{"\[Zeta]", "^", "2"}]}], 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Zeta]", "^", "2"}], " ", 
                 RowBox[{
                  RowBox[{"h", "'"}], "[", "\[Zeta]", "]"}]}], ",", 
                "\[Zeta]"}], "]"}]}], "+", 
             RowBox[{"4", " ", "Pi", " ", 
              RowBox[{
               RowBox[{"G", " ", "/", "2"}], "/", "K"}], " ", 
              RowBox[{"h", "[", "\[Zeta]", "]"}]}]}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"h", "[", "0", "]"}], "\[Equal]", 
            RowBox[{"2", "K", " ", "\[Rho]0"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"h", "'"}], "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], 
         ",", 
         RowBox[{"h", "[", "\[Zeta]", "]"}], ",", "\[Zeta]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "//", "ComplexExpand"}], ",", 
    RowBox[{
     RowBox[{"K", ">", "0"}], "&&", 
     RowBox[{"G", ">", "0"}]}]}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"initial", " ", "values", " ", "from", " ", "Lane"}], "-", 
    RowBox[{"Emden", " ", "equation"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.6635669629565067`*^9, 3.663566988811986*^9}, {
  3.663567644671499*^9, 3.663567645703558*^9}, {3.6635676931912737`*^9, 
  3.663567697263507*^9}, {3.663568004710092*^9, 3.6635680050691123`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{
    RowBox[{"G", ">", "0"}], "&&", 
    RowBox[{"K", ">", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6584955726882706`*^9, 3.6584955938204794`*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]LE", "=", 
  RowBox[{"Refine", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{"G", ">", "0"}], "&&", 
     RowBox[{"K", ">", "0"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5072949160838604`*^9, 3.5072949273375044`*^9}, 
   3.507307145808361*^9, {3.508385610018305*^9, 3.5083856111193676`*^9}, 
   3.5083857109110756`*^9, {3.508908177794629*^9, 3.5089081887962584`*^9}, {
   3.5089083391718597`*^9, 3.5089083427400637`*^9}, 3.6635673765211616`*^9}],

Cell[BoxData[
 RowBox[{"r0", "=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"K", " ", 
    RowBox[{
     RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6635682815969286`*^9, 3.6635683087384815`*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]0", "=", 
  RowBox[{"\[Rho]0", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"M", "==", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"4", " ", "Pi", " ", 
            RowBox[{"\[Zeta]", "^", "2"}], " ", "\[Rho]LE"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Zeta]", ",", "0", ",", "r0"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"G", ">", "0"}], "&&", 
          RowBox[{"K", ">", "0"}]}]}], "]"}]}], " ", 
      RowBox[{"(*", " ", "MASS", " ", "*)"}], ",", "\[Rho]0"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5072947213767242`*^9, 3.5072947966750307`*^9}, {
  3.5073070750533137`*^9, 3.5073070753603315`*^9}, {3.5073071552389*^9, 
  3.5073071560849485`*^9}, {3.5073072017765617`*^9, 3.507307213001204*^9}, {
  3.50730728601438*^9, 3.5073072867954245`*^9}, {3.5083859298655987`*^9, 
  3.508385941996293*^9}, {3.6635674486172853`*^9, 3.6635674556486874`*^9}, {
  3.6635674952809544`*^9, 3.663567538473425*^9}, {3.6635679031182814`*^9, 
  3.663567904757375*^9}, {3.663567964653801*^9, 3.6635679650288224`*^9}, {
  3.6635680206450033`*^9, 3.6635680548759613`*^9}, {3.663568318747054*^9, 
  3.6635683188270583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[IndentingNewLine]", 
           RowBox[{"Units", " ", 
            RowBox[{"tested", ":", "\[IndentingNewLine]", "1"}]}], ")"}], " ",
           "K"}], "=", 
         RowBox[{"1", "/", "2"}]}], ",", " ", 
        RowBox[{"G", "=", "1"}], ",", " ", 
        RowBox[{"\[Rho]0", "=", 
         RowBox[{"1", "\[IndentingNewLine]", "\t", "2"}]}]}], ")"}], " ", 
      "G"}], " ", "=", " ", 
     RowBox[{"4", " ", 
      RowBox[{"Pi", "^", "2"}]}]}], ",", " ", 
    RowBox[{"M", "=", "Msun"}], ",", " ", 
    RowBox[{"R", "=", "Rsun"}], ",", " ", 
    RowBox[{"Tsun", " ", "=", " ", 
     RowBox[{
      RowBox[{"Keplerian", " ", "period", " ", "at", " ", "R"}], "=", 
      "Rsun"}]}]}], " ", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.663578755162983*^9, 3.663578856984806*^9}}],

Cell[BoxData[
 RowBox[{"G0", "=", 
  RowBox[{"6.67384", "*", 
   RowBox[{"10", "^", 
    RowBox[{"-", "11", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"From", " ", "CODATA"}], ",", " ", 
       RowBox[{"used", " ", "in", " ", "Kong", " ", 
        RowBox[{"et", ".", " ", "al", "."}]}]}], " ", "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5070880395881987`*^9, 3.5070880400322247`*^9}, {
  3.5077799509011765`*^9, 3.5077799615137835`*^9}, {3.6635665486068077`*^9, 
  3.663566553911111*^9}, {3.6635696569775963`*^9, 3.66356967837682*^9}, {
  3.6635716865466805`*^9, 3.6635716891468296`*^9}, {3.6635722691580043`*^9, 
  3.663572270414076*^9}, {3.6635723198779054`*^9, 3.6635723235901175`*^9}, {
  3.6635790109116106`*^9, 3.6635790719100995`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"G", "=", "1"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6635694801654835`*^9, 3.663569480746516*^9}, 
   3.66357271071526*^9}],

Cell[BoxData[
 RowBox[{"G", "=", 
  RowBox[{"4", " ", 
   RowBox[{"Pi", "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.663571691682975*^9, 3.663571693922103*^9}, 
   3.663573230886012*^9, 3.663574598351227*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"G", "=", "G0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.663573233037135*^9, 3.663573237111368*^9}, 
   3.6635746020064354`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"M", "=", 
    RowBox[{
     RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}]}], "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Lane", "-", 
     RowBox[{"Emden", " ", "with", " ", "R"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}], " ", "radius", " ", 
      "and", " ", "rhoC"}], "=", "1"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5072950451642437`*^9, 3.507295047484376*^9}, {
   3.50730709998474*^9, 3.507307129670438*^9}, {3.5073072664902635`*^9, 
   3.507307270265479*^9}, 3.663566780993099*^9, 3.663569488269947*^9, 
   3.6635732514001856`*^9}],

Cell[BoxData[
 RowBox[{"QuantityMagnitude", "@", 
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<Star\>\"", ",", "\"\<Sun\>\""}], "]"}], "[", "\"\<Mass\>\"", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Msun", "=", 
  RowBox[{"1.98855", "*", 
   RowBox[{"10", "^", "30", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"QuantityMagnitude", "@", 
      RowBox[{
       RowBox[{"Entity", "[", 
        RowBox[{"\"\<Star\>\"", ",", "\"\<Sun\>\""}], "]"}], "[", 
       "\"\<Mass\>\"", "]"}]}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.663572189268435*^9, 3.663572191071538*^9}, {
  3.6705631659166207`*^9, 3.6705631745991173`*^9}}],

Cell[BoxData[
 RowBox[{"Rsun", "=", "695700000.0", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"QuantityMagnitude", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Entity", "[", 
       RowBox[{"\"\<Star\>\"", ",", "\"\<Sun\>\""}], "]"}], "[", 
      "\"\<Radius\>\"", "]"}], ",", "\"\<Meters\>\""}], "]"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.663572195041765*^9, 3.6635722062544065`*^9}, {
  3.663572545860831*^9, 3.663572547300913*^9}, {3.6635725790767307`*^9, 
  3.663572588116248*^9}, {3.670563250380452*^9, 3.670563266486373*^9}}],

Cell[BoxData[
 RowBox[{"Tsun", "=", 
  RowBox[{"2", "Pi", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rsun", "^", "3"}], "/", "Msun"}], "/", "G0"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.663572228814697*^9, 3.6635722637346945`*^9}, {
  3.6635723470864615`*^9, 3.6635723474624834`*^9}}],

Cell[BoxData[
 RowBox[{"M", "=", 
  RowBox[{"9.7466", "*", 
   RowBox[{
    RowBox[{"10", "^", "30"}], "/", "Msun", " ", 
    RowBox[{"(*", 
     RowBox[{"\[Alpha]", " ", "Eridani"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6635667841492796`*^9, 3.66356679288478*^9}, {
   3.663569685809245*^9, 3.663569689985484*^9}, {3.6635716998584423`*^9, 
   3.6635717036426587`*^9}, {3.6635718029623394`*^9, 3.66357181713015*^9}, {
   3.663572680028505*^9, 3.6635726812915773`*^9}, 3.663573271973362*^9, {
   3.663574577311023*^9, 3.6635745782460766`*^9}, {3.6635790836067686`*^9, 
   3.6635791062300625`*^9}}],

Cell[BoxData[
 RowBox[{"R\[Alpha]Eri", "=", 
  RowBox[{"8.83520", "*", 
   RowBox[{"10", "^", "9"}]}]}]], "Input",
 CellChangeTimes->{{3.6635792344533963`*^9, 3.663579260412881*^9}}],

Cell[BoxData[
 RowBox[{"R\[Alpha]Eri", "/", "Rsun"}]], "Input",
 CellChangeTimes->{{3.663579265688183*^9, 3.663579272364565*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "=", " ", 
  RowBox[{"2.9725", "*", 
   RowBox[{"10", "^", 
    RowBox[{"-", "5"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6635796174453025`*^9, 3.663579635394329*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "Tsun"}]], "Input",
 CellChangeTimes->{{3.6635796382534924`*^9, 3.663579650850213*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"M", "=", 
   RowBox[{"9.7466", "*", 
    RowBox[{"10", "^", "30"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{3.6635745762669635`*^9}],

Cell[BoxData[
 RowBox[{"K0", "=", 
  RowBox[{"1.75", "*", 
   RowBox[{"10", "^", "9", "  ", 
    RowBox[{"(*", " ", 
     RowBox[{"from", " ", "Kong", " ", 
      RowBox[{"et", ".", " ", "al", "."}]}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.5089082405452185`*^9, 3.5089082419843006`*^9}, {
   3.663566566118809*^9, 3.66356656979902*^9}, {3.6635696948487625`*^9, 
   3.6635696986169777`*^9}, 3.6635726300996494`*^9, {3.663574612782052*^9, 
   3.663574615638215*^9}, {3.6635791097982664`*^9, 3.663579122501993*^9}}],

Cell[BoxData[
 RowBox[{"Kinit", "=", 
  RowBox[{"K0", " ", 
   RowBox[{"Tsun", "^", "2"}], " ", 
   RowBox[{"Msun", "/", 
    RowBox[{"Rsun", "^", "5"}]}]}]}]], "Input",
 CellChangeTimes->{{3.663668765917859*^9, 3.6636687725662394`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"K", "=", 
   RowBox[{"K0", " ", 
    RowBox[{"Tsun", "^", "2"}], " ", 
    RowBox[{"Msun", "/", 
     RowBox[{"Rsun", "^", "5"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6635726330628185`*^9, 3.663572643187398*^9}, 
   3.663573277092655*^9, {3.6635745627111883`*^9, 3.663574569111554*^9}, 
   3.6706509745360537`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"K", "=", "K0"}], "*)"}]], "Input",
 CellChangeTimes->{{3.66357328032784*^9, 3.6635732815429096`*^9}, 
   3.663574561393113*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"K", "=", 
   RowBox[{"1", "/", "2"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6635695388768415`*^9, 3.663569540793951*^9}, 
   3.663572705587967*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NT", "*", "NR"}], "+", "2", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "equations"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "[", "vars", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "variables"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"init", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"NT", "*", "NR"}], "+", "2"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5070880528869596`*^9, 3.5070880676488037`*^9}, {
  3.507088451015731*^9, 3.5070884734550147`*^9}, {3.507294700116508*^9, 
  3.507294700430526*^9}, {3.5073079713755803`*^9, 3.50730797311668*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"initial", " ", "starting", " ", "guess"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5077800186530523`*^9, 3.507780039723257*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Most", "[", "R", "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"K", " ", 
              RowBox[{
               RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], "&"}], 
         ")"}], "/@", "R"}]}], ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Rho]LE", "/.", 
            RowBox[{"\[Zeta]", "\[Rule]", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"K", " ", 
                  RowBox[{
                   RowBox[{"Pi", "/", "2"}], "/", "G"}]}], "]"}]}], "]"}], 
              "&"}], ")"}], "/@", "R"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"NR", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "G"}], " ", 
         RowBox[{"M", "/", "r0"}]}], ",", "\[Rho]0", ",", "K"}], "}"}]}], 
     "]"}], "/.", 
    RowBox[{"K", "\[Rule]", "Kinit"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Short"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"start", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"vars", ",", "init"}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.670739609786359*^9}],

Cell[BoxData[
 RowBox[{"start", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "3"}], ";;"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6593376822525177`*^9, 3.6593376839137297`*^9}, {
  3.663572908082549*^9, 3.663572917874109*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]0", "=", 
  RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "Tsun"}]}]], "Input",
 CellChangeTimes->{{3.657444273316474*^9, 3.657444275133006*^9}, {
   3.6636688776692505`*^9, 3.6636688802854004`*^9}, {3.663669236090751*^9, 
   3.6636693182824526`*^9}, 3.663669349722251*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Evaluate", "[", 
   RowBox[{"R", "\[LeftDoubleBracket]", 
    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], "=", 
  RowBox[{"R\[Alpha]Eri", "/", "Rsun", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Thank", " ", "Krzysztof", " ", "G\[LSlash]\[OAcute]d", " ", "for", " ", 
     RowBox[{"this", "!"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.670739624303679*^9, 3.670739657945485*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"wynik", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
        RowBox[{"e", " ", "=", " ", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"fLHS", "@@", "vars"}], ",", "start", ",", 
            RowBox[{"MaxIterations", "\[Rule]", "400"}], ",", 
            RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
             RowBox[{"e", "++"}]}], ",", " ", 
            RowBox[{"StepMonitor", "\[RuleDelayed]", " ", 
             RowBox[{"s", "++"}]}]}], "]"}], "//", "Chop"}], "//", 
         "AbsoluteTiming"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "e"}], "}"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]max", "=", "0.4"}]], "Input",
 CellChangeTimes->{{3.671613946675264*^9, 3.6716139471944647`*^9}, {
   3.671614548239469*^9, 3.6716145501507883`*^9}, {3.6716187696021852`*^9, 
   3.671618770394177*^9}, {3.6716219618129473`*^9, 3.671621962204631*^9}, 
   3.6716403297827263`*^9, 3.671640423077794*^9, {3.6716405014851847`*^9, 
   3.671640506357047*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalDelta]\[CapitalOmega]", "=", "0.05"}]], "Input",
 CellChangeTimes->{{3.671640336214202*^9, 3.671640336325865*^9}, {
  3.671640426205604*^9, 3.671640426821652*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalOmega]0", "]"}]], "Input",
 CellChangeTimes->{{3.670651286439047*^9, 3.670651290138217*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"\[CapitalOmega]0", "=", "0.0"}], ",", 
    RowBox[{"\[CapitalOmega]0", "<=", "\[CapitalOmega]max"}], ",", 
    RowBox[{"\[CapitalOmega]0", "=", 
     RowBox[{"\[CapitalOmega]0", "+", "\[CapitalDelta]\[CapitalOmega]"}]}], 
    "  ", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"A", "=", "1.02"}], ",", 
       RowBox[{"A", ">", "0"}], ",", 
       RowBox[{"A", "=", 
        RowBox[{"A", "-", 
         RowBox[{"1", "/", "1000"}]}]}], ","}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timer", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
          RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
          "\"\<.m\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
            RowBox[{"e", " ", "=", " ", "0"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"FindRoot", "[", 
               RowBox[{
                RowBox[{"fLHS", "@@", "vars"}], ",", "start", ",", 
                RowBox[{"MaxIterations", "\[Rule]", "400"}], ",", 
                RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"e", "++"}]}], ",", " ", 
                RowBox[{"StepMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"s", "++"}]}]}], "]"}], "//", "Chop"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "e"}], "}"}]}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
           RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
           "\"\<.m\>\""}], ",", "rozw"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
            RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
            "\"\<.m\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<From disk\>\"", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"initPREV", "=", 
      RowBox[{"vars", "/.", "rozw"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"vars", ",", "initPREV"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "Now", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[CapitalOmega]=\>\"", ",", 
       RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], ",", 
       "\"\<\\t Time = \>\"", ",", " ", 
       RowBox[{
        RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}], ",", 
       "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Evaluations=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\\tStep=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", ",", "\"\<\\n\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Rp/Re= \>\"", ",", 
       RowBox[{"FullForm", "[", 
        RowBox[{
         RowBox[{"R1", "/", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "/.", "rozw"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]max", "=", "0.33"}]], "Input",
 CellChangeTimes->{{3.6716404352611933`*^9, 3.671640448245563*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalDelta]\[CapitalOmega]", "=", "0.001"}]], "Input",
 CellChangeTimes->{{3.671640450957829*^9, 3.671640458901516*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalOmega]0", "]"}]], "Input",
 CellChangeTimes->{{3.671640472385808*^9, 3.671640476341017*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"\[CapitalOmega]0", "=", "0.3"}], ",", 
    RowBox[{"\[CapitalOmega]0", "\[LessEqual]", "\[CapitalOmega]max"}], ",", 
    RowBox[{"\[CapitalOmega]0", "=", 
     RowBox[{"\[CapitalOmega]0", "+", "\[CapitalDelta]\[CapitalOmega]"}]}], 
    "  ", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"A", "=", "1.02"}], ",", 
       RowBox[{"A", ">", "0"}], ",", 
       RowBox[{"A", "=", 
        RowBox[{"A", "-", 
         RowBox[{"1", "/", "1000"}]}]}], ","}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"timer", "=", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
          RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
          "\"\<.m\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", " ", "=", " ", "0"}], ",", " ", 
            RowBox[{"e", " ", "=", " ", "0"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"FindRoot", "[", 
               RowBox[{
                RowBox[{"fLHS", "@@", "vars"}], ",", "start", ",", 
                RowBox[{"MaxIterations", "\[Rule]", "400"}], ",", 
                RowBox[{"EvaluationMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"e", "++"}]}], ",", " ", 
                RowBox[{"StepMonitor", "\[RuleDelayed]", " ", 
                 RowBox[{"s", "++"}]}]}], "]"}], "//", "Chop"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", "e"}], "}"}]}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
           RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
           RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
           "\"\<.m\>\""}], ",", "rozw"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rozw", ",", "evals"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
            RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], "]"}], "<>", 
            "\"\<.m\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<From disk\>\"", ",", "0", ",", "0"}], "}"}]}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"initPREV", "=", 
      RowBox[{"vars", "/.", "rozw"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"start", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"vars", ",", "initPREV"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "Now", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[CapitalOmega]=\>\"", ",", 
       RowBox[{"N", "[", "\[CapitalOmega]0", "]"}], ",", 
       "\"\<\\t Time = \>\"", ",", " ", 
       RowBox[{
        RowBox[{"AbsoluteTime", "[", "]"}], "-", "timer"}], ",", 
       "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Evaluations=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\\tStep=\>\"", ",", 
       RowBox[{"evals", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", ",", "\"\<\\n\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Rp/Re= \>\"", ",", 
       RowBox[{"FullForm", "[", 
        RowBox[{
         RowBox[{"R1", "/", 
          RowBox[{"R", "\[LeftDoubleBracket]", 
           RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "/.", "rozw"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.671640380975728*^9, 3.671640407806703*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]\[Alpha]Eri", " ", "Tsun"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]test", "=", "0.30"}]], "Input",
 CellChangeTimes->{{3.6715542896871147`*^9, 3.6715542897352047`*^9}, {
  3.671556668103096*^9, 3.671556668806881*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "dat", "]"}]], "Input",
 CellChangeTimes->{{3.5073766055607004`*^9, 3.5073766069147778`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat", "[", "enum_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dat", "[", "enum", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "enum", "]"}], "]"}], "<>", "\"\<.m\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.507376506454032*^9, 3.50737653649475*^9}, {
   3.507476240279338*^9, 3.5074762478937736`*^9}, {3.5078029017491903`*^9, 
   3.507802918369141*^9}, 3.507809332229993*^9, {3.5081397826530514`*^9, 
   3.5081397846691666`*^9}, {3.5090938900794783`*^9, 3.50909389186058*^9}, {
   3.509163596447871*^9, 3.509163601919184*^9}, {3.5091641097632313`*^9, 
   3.509164131001446*^9}, 3.5091899509914317`*^9, 3.5092735230302563`*^9, {
   3.509274718514634*^9, 3.5092747274231434`*^9}, {3.657347773458592*^9, 
   3.657347776754591*^9}, {3.6573480315204372`*^9, 3.657348040015616*^9}, {
   3.657348086111442*^9, 3.657348087999237*^9}, 3.657348183838628*^9, {
   3.6574447513852654`*^9, 3.657444751816897*^9}, {3.659260315555888*^9, 
   3.6592603176834927`*^9}, {3.670652478508972*^9, 3.6706524881089067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}], "//", "Short"}]], "Input",
 CellChangeTimes->{{3.6573481041362534`*^9, 3.6573481072463284`*^9}, {
  3.657507313208527*^9, 3.6575073152400846`*^9}, {3.657600210752247*^9, 
  3.657600211967126*^9}, {3.670652527228785*^9, 3.670652528348485*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "powSpline", "]"}]], "Input",
 CellChangeTimes->{{3.5078033649266825`*^9, 3.507803368513888*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"powSpline", "[", "enum_", "]"}], ":=", 
  RowBox[{
   RowBox[{"powSpline", "[", "enum", "]"}], "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", 
      RowBox[{"Import", "[", 
       RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
        RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "enum", "]"}], "]"}], "<>", "\"\<.m\>\""}], 
       "]"}]}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<Hermite\>\""}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"powSpline", "[", "\[CapitalOmega]test", "]"}]], "Input",
 CellChangeTimes->{{3.507803379554519*^9, 3.50780338219067*^9}, 
   3.657348491290833*^9, {3.657507327864524*^9, 3.657507330296027*^9}, {
   3.670652550316472*^9, 3.6706525546527452`*^9}}],

Cell[BoxData[
 RowBox[{"\[Alpha]Eri", "=", 
  RowBox[{"Interpolation", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "R"}], "}"}], "]"}], "/.", 
     RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ",", 
    RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.670652613919232*^9, 3.670652617787965*^9}, {
  3.670652653292062*^9, 3.670652659291473*^9}, {3.670652868169599*^9, 
  3.670652873432705*^9}}],

Cell[BoxData[
 RowBox[{"R0", "=", 
  RowBox[{"r0", "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"surf", "=", 
  RowBox[{"PolarPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]Eri", "[", 
       RowBox[{
        RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{"r0", "/.", 
        RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ")"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
      RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "}"}], 
      RowBox[{"R", "\[LeftDoubleBracket]", 
       RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.6716054648539667`*^9, 3.671605508860496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"PolarPlot", ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"2", "/", "3"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Medium", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Dotted", ",", "Black", ",", "Medium"}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"R0", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5"}], ",", "1.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}]}], "}"}]}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.657521095777029*^9, 3.657521110330892*^9}, {
  3.65848109891133*^9, 3.658481100071397*^9}, {3.658645202938484*^9, 
  3.6586452137369547`*^9}, {3.6609914397651043`*^9, 3.660991442004664*^9}, {
  3.660991516532745*^9, 3.660991520436364*^9}, {3.6609921675008993`*^9, 
  3.660992176972555*^9}, {3.661341476895075*^9, 3.661341484102963*^9}, {
  3.66357629134006*^9, 3.663576291499069*^9}, {3.670652773178454*^9, 
  3.6706527735145073`*^9}}],

Cell[BoxData[
 RowBox[{"surfNEW", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "\[CapitalOmega]test", "]"}], "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
        "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
        RowBox[{"Pi", "/", "2"}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "\[CapitalOmega]test", "]"}], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Pi"}], "/", "2"}], "+", "\[Theta]\[Theta]"}], "]"}], 
        ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", 
        RowBox[{"Pi", "/", "2"}], ",", " ", "Pi"}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "\[CapitalOmega]test", "]"}], "[", 
         RowBox[{
          RowBox[{"-", "\[Theta]\[Theta]"}], "+", 
          RowBox[{"3", 
           RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", "Pi", ",", 
        RowBox[{"3", " ", 
         RowBox[{"Pi", "/", "2"}]}]}], "}"}]}], "]"}], " ", ",", 
    RowBox[{"PolarPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"powSpline", "[", "\[CapitalOmega]test", "]"}], "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], "/", "2"}], "Pi"}], "+", "\[Theta]\[Theta]"}],
          "]"}], ",", "r0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]\[Theta]", ",", 
        RowBox[{
         RowBox[{"3", "/", "2"}], "Pi"}], ",", " ", 
        RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.657521041594685*^9, 3.657521393976375*^9}, {
  3.6575214460084553`*^9, 3.657521500134912*^9}, {3.6635762983084583`*^9, 
  3.6635763189546394`*^9}, {3.670652777898676*^9, 3.670652791434816*^9}}],

Cell[BoxData[
 RowBox[{"b", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.657521518247138*^9, 3.65752156077351*^9}, {
  3.657521632997253*^9, 3.657521633205551*^9}, {3.6706529187125187`*^9, 
  3.670652919912712*^9}}],

Cell[BoxData[
 RowBox[{"a", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.657521563761141*^9, 3.657521568213973*^9}, {
  3.657521634277841*^9, 3.657521634437419*^9}, {3.670652922824629*^9, 
  3.6706529237846193`*^9}}],

Cell[BoxData[
 RowBox[{"bKong", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "/", "3"}], 
    RowBox[{"R", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", "rozw"}]}]], "Input",
 CellChangeTimes->{{3.6705652524289627`*^9, 3.670565260447421*^9}, {
  3.670568877350296*^9, 3.6705688793504105`*^9}, {3.6716053840846653`*^9, 
  3.671605384852784*^9}}],

Cell[BoxData[
 RowBox[{"aKong", "=", 
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}], "/.", "rozw"}]}]], "Input",
 CellChangeTimes->{{3.65760061401073*^9, 3.657600614490794*^9}, {
  3.6705652621675196`*^9, 3.670565266966794*^9}, {3.671605389180751*^9, 
  3.671605391332612*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalOmega]0", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"elipsa", "=", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"Cos", "[", "t", "]"}]}], ",", 
      RowBox[{"b", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", "Dashed", ",", "Black"}], "}"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6575215708028383`*^9, 3.657521572325902*^9}, {
  3.6575216149496307`*^9, 3.657521646244975*^9}, {3.6584810619122143`*^9, 
  3.658481091279894*^9}, {3.660991427205578*^9, 3.66099142821336*^9}, {
  3.66099150778122*^9, 3.6609915095886908`*^9}, {3.66134149519106*^9, 
  3.661341498135022*^9}, {3.6705653783841667`*^9, 3.670565381872366*^9}}],

Cell[BoxData[
 RowBox[{"elipsaKong", "=", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aKong", " ", 
       RowBox[{"Cos", "[", "t", "]"}]}], ",", 
      RowBox[{"bKong", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", 
      RowBox[{"2", "Pi"}]}], "}"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Thin", ",", "Black"}], "}"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671605402940914*^9, 3.671605414972756*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"surf", ",", "elipsa", ",", "elipsaKong", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\[CurlyPi] [\!\(\*SubscriptBox[\(R\), \(\[CircleDot]\)]\)]\>\"", 
      ",", "\"\<z [\!\(\*SubscriptBox[\(R\), \(\[CircleDot]\)]\)]\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Alpha] Eri\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.657521647945179*^9, 3.657521656101206*^9}, {
   3.6575216908382187`*^9, 3.657521693860387*^9}, {3.658481136086457*^9, 
   3.6584811526144023`*^9}, {3.658484207553135*^9, 3.6584842088092065`*^9}, 
   3.6584851032103634`*^9, {3.6592604334903812`*^9, 3.659260441666088*^9}, {
   3.6705652766073456`*^9, 3.6705652878159866`*^9}, {3.670565456359627*^9, 
   3.6705654584557467`*^9}, {3.670565528173734*^9, 3.670565653877924*^9}, {
   3.670565899974*^9, 3.6705659319958315`*^9}, {3.6705660096912756`*^9, 
   3.670566016498665*^9}, {3.671605420364806*^9, 3.671605423740749*^9}}],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"dir", "<>", "\"\<Surface_alphaEri.pdf\>\""}], ",", "%"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6584849340926905`*^9, 3.6584849531957827`*^9}, {
   3.6584851128269134`*^9, 3.658485114009981*^9}, {3.658645233705751*^9, 
   3.65864523416912*^9}, {3.658645281545088*^9, 3.658645285256835*^9}, {
   3.659321129411806*^9, 3.659321130403623*^9}, 3.660974421350081*^9, {
   3.660991388725807*^9, 3.660991389861367*^9}, {3.660992084061357*^9, 
   3.660992085084756*^9}, {3.661341512366804*^9, 3.661341513198669*^9}, {
   3.6614228700896587`*^9, 3.661422871417027*^9}, {3.661492682784581*^9, 
   3.6614926839998407`*^9}, {3.661492979446599*^9, 3.661492980341792*^9}, 
   3.6635766055620327`*^9, {3.670565694381241*^9, 3.670565702180687*^9}}],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]list", "=", 
  RowBox[{
   RowBox[{"ToExpression", "/@", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"Last", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"StringSplit", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<_Omega_\>\"", ",", "\"\<.m\>\""}], "}"}]}], "]"}], 
          "&"}], ")"}], "/@", 
        RowBox[{"FileNames", "[", 
         RowBox[{"dir", "<>", "\"\<alphaEri_\>\"", "<>", 
          RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<_\>\"", "<>", 
          RowBox[{"ToString", "[", "NL", "]"}], "<>", "\"\<_Omega_\>\"", 
          "<>", "\"\<*\>\"", "<>", "\"\<.m\>\""}], "]"}]}], ")"}]}], ")"}]}], 
   "//", "Sort"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PolarPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"powSpline", "[", "i", "]"}], "[", 
        RowBox[{
         RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{"r0", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], ")"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
       RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"2", "/", "3"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1.0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2", "/", "3"}]}], "}"}]}], "}"}], " ", 
       RowBox[{"R\[Alpha]Eri", "/", "Rsun"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\"\<Re/Rp=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", 
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}], "<>", 
       "\[IndentingNewLine]", "\"\< C=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"C", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}], "<>", "\"\<, K=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"K", "/.", 
         RowBox[{"dat", "[", "i", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "\[CapitalOmega]test"}], "}"}], ",", 
     "\[CapitalOmega]list"}], "}"}], ",", 
   RowBox[{"ControlType", "\[Rule]", 
    RowBox[{"Slider", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", "\[CapitalOmega]list", "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6716136848141327`*^9, 3.671613720008174*^9}, {
  3.6716210960999527`*^9, 3.671621117699626*^9}, {3.6716211580836887`*^9, 
  3.6716211672513313`*^9}, {3.671622457123472*^9, 3.671622470440982*^9}, {
  3.671622562954166*^9, 3.671622567961603*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]DISP", "=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
            RowBox[{"\[Rho]", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "\[Rho]C"}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "NR"}], "}"}]}], "]"}], "/.", 
      RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ",", "1"}], "]"}], "//",
    "Interpolation"}]}]], "Input",
 CellChangeTimes->{{3.507089978040072*^9, 3.5070900570025883`*^9}, {
   3.507090124260435*^9, 3.5070901274706187`*^9}, {3.5070930231232405`*^9, 
   3.5070930458115387`*^9}, {3.507093084615758*^9, 3.507093086659875*^9}, {
   3.5070932665051613`*^9, 3.507093329045738*^9}, {3.5075174495458646`*^9, 
   3.5075174501518993`*^9}, {3.507524633336754*^9, 3.5075246350268507`*^9}, {
   3.5078038908937664`*^9, 3.5078038923988523`*^9}, {3.5078094226361637`*^9, 
   3.507809423639221*^9}, {3.5081399207529497`*^9, 3.508139921699004*^9}, {
   3.5089374672218885`*^9, 3.5089374675869093`*^9}, {3.5091120601607475`*^9, 
   3.5091120630499125`*^9}, {3.5091574270940046`*^9, 3.509157429445139*^9}, {
   3.5091622602274437`*^9, 3.5091622608374786`*^9}, {3.5091629373091707`*^9, 
   3.5091629375151825`*^9}, {3.50916298292578*^9, 3.509162983022785*^9}, {
   3.5091632579365096`*^9, 3.5091632582715287`*^9}, {3.5091633716650143`*^9, 
   3.5091633718550253`*^9}, {3.509163404178874*^9, 3.50916340446189*^9}, {
   3.509163473440836*^9, 3.5091634737888556`*^9}, {3.5091636319098997`*^9, 
   3.5091636321769147`*^9}, {3.5091638800900946`*^9, 
   3.5091638801891003`*^9}, {3.509164161104168*^9, 3.50916416236524*^9}, {
   3.509164239871673*^9, 3.509164240501709*^9}, {3.5091900456268444`*^9, 
   3.5091900458858595`*^9}, {3.5092690365446444`*^9, 3.509269036802659*^9}, 
   3.657348891958817*^9, 3.657445389586131*^9, {3.657507345240912*^9, 
   3.6575073473207808`*^9}, {3.663576690256877*^9, 3.6635766974562883`*^9}, {
   3.6706531137374907`*^9, 3.670653114631188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]DISPXY", "=", 
   RowBox[{
    RowBox[{"\[Rho]DISP", "[", 
     RowBox[{"\[Theta]\[Theta]", ",", "rr"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rr", "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "]"}]}], ",", 
      RowBox[{"\[Theta]\[Theta]", "\[Rule]", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", "/", "y"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5070901426184855`*^9, 3.507090198976709*^9}}],

Cell[BoxData[
 RowBox[{"cp", "=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"\[Rho]DISPXY", "*", 
     RowBox[{"UnitStep", "[", "\[Rho]DISPXY", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "R0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "R0"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.507090178828556*^9, 3.5070902462094107`*^9}, {
   3.507093236043419*^9, 3.5070932383955536`*^9}, {3.507296568678384*^9, 
   3.507296571268532*^9}, {3.507785620440456*^9, 3.5077856375944366`*^9}, 
   3.5077856712603626`*^9, {3.5078040809636374`*^9, 3.507804082197708*^9}, {
   3.507804200314464*^9, 3.507804239327696*^9}, {3.5091120733865037`*^9, 
   3.509112075475623*^9}, {3.5091574423388767`*^9, 3.509157449498286*^9}, {
   3.663576654208815*^9, 3.663576671135783*^9}, {3.6706531257029552`*^9, 
   3.6706531322618628`*^9}, {3.670653184839601*^9, 3.670653195526456*^9}, {
   3.671554343784461*^9, 3.6715543442387114`*^9}, {3.671605637044285*^9, 
   3.6716056439874697`*^9}}],

Cell[BoxData[
 RowBox[{"dp", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]DISPXY", "*", 
       RowBox[{"UnitStep", "[", "\[Rho]DISPXY", "]"}]}], "+", 
      RowBox[{
       RowBox[{"UnitStep", "[", 
        RowBox[{"x", "-", 
         RowBox[{"1.75", "R0"}]}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"y", "-", 
         RowBox[{"0.75", "R0"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"2", "R0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "R0"}]}], "}"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"2", "\[Rho]0"}], "/.", 
        RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}], "}"}]}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "50"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "surf", ",", 
   RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.50780365021*^9, 3.507803662906726*^9}, {
  3.507804088801086*^9, 3.507804089028099*^9}, {3.507804133030616*^9, 
  3.507804134866721*^9}, {3.5091623107823353`*^9, 3.509162315686616*^9}, {
  3.509162909534582*^9, 3.5091629162589664`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<H:\\\\misiek\\\\Articles\\\\SurfaceTracking\\\\figs\\\\j-const_A_02_J_\
02.png\>\"", ",", "%", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "150"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.5091629959625254`*^9, 3.50916305810608*^9}, {
   3.5091632738114176`*^9, 3.509163274002428*^9}, {3.5091633887299905`*^9, 
   3.5091634161625595`*^9}, {3.5091634851795073`*^9, 
   3.5091634854505224`*^9}, {3.5091636446166267`*^9, 3.509163648769864*^9}, {
   3.5091638984381437`*^9, 3.5091638986661572`*^9}, {3.5091641741659145`*^9, 
   3.509164177705117*^9}, {3.5091642516923494`*^9, 3.5091642523133845`*^9}, {
   3.5091900785307264`*^9, 3.509190082168935*^9}, 3.657506528369314*^9}],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{"\[Rho]DISPXY", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"2.5", "r0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", 
     RowBox[{"2.5", "r0"}]}], "}"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.507780438797083*^9, 3.507780442959321*^9}, {
  3.5081399530547976`*^9, 3.5081399531268015`*^9}, {3.5091122053520517`*^9, 
  3.5091122208189363`*^9}, {3.509269087566562*^9, 3.5092690881875978`*^9}, {
  3.657506540658061*^9, 3.657506541905232*^9}, {3.6635767465360956`*^9, 
  3.663576748863229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NT", ",", "NR", ",", "NL"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"C", ",", "\[CapitalOmega]0", ",", 
      RowBox[{"R", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.5081399770371695`*^9, 3.5081400102520695`*^9}, 
   3.6574460261712008`*^9, {3.658645697444034*^9, 3.6586456989800587`*^9}, {
   3.6586458429143972`*^9, 3.658645904657494*^9}, {3.6586476543823957`*^9, 
   3.658647669117798*^9}, {3.660974930667313*^9, 3.6609749532115498`*^9}, {
   3.670654032892317*^9, 3.670654033932185*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "\[CapitalOmega]0"}], "}"}], "/.", 
     RowBox[{"dat", "[", "j", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
     "j", ",", "0.0", ",", "\[CapitalOmega]max", ",", 
      "\[CapitalDelta]\[CapitalOmega]"}], "}"}]}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rsun", " ", 
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], "/.", "rozw"}]], "Input",
 CellChangeTimes->{{3.6635798644334292`*^9, 3.6635798754890614`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot", "[", " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", "\[CapitalOmega]0"}], "}"}], "/.", 
       RowBox[{"dat", "[", "j", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "j", ",", "0.0", ",", "\[CapitalOmega]max", ",", 
        "\[CapitalDelta]\[CapitalOmega]"}], "}"}]}], "]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}], "/.", "rozw"}]], "Input",
 CellChangeTimes->{{3.6635799245098658`*^9, 3.663579949968322*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ListPlot", "[", " ", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", 
          RowBox[{"R", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "/.", 
       RowBox[{"dat", "[", "j", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0.0", ",", "Jmax", ",", "\[CapitalDelta]J"}], 
       "}"}]}], "]"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"colorlabel", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", 
      RowBox[{"(", 
       RowBox[{"\[Rho]0", "/.", 
        RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ")"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", 
      RowBox[{"1", "/", "20"}]}], "}"}], ",", 
    RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", 
     RowBox[{"1", "/", "20"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameTicks", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.509271682018956*^9, 3.509271700472012*^9}, {
   3.5092717365180736`*^9, 3.5092718416060843`*^9}, {3.5092718778861594`*^9, 
   3.5092719136442046`*^9}, {3.5092720228954535`*^9, 3.509272029145811*^9}, {
   3.509272182183564*^9, 3.5092721823625746`*^9}, 3.509272247635308*^9, {
   3.6635768944795575`*^9, 3.6635768953906097`*^9}, {3.670654076108979*^9, 
   3.670654085180319*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1.9", ",", "0.0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "\[Rho]C"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[Equal]", "NR"}], ",", "0", ",", 
                    RowBox[{"\[Rho]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}], 
              "\[IndentingNewLine]", ",", "1"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "/.", 
          RowBox[{"dat", "[", "jj", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", "r0"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1", "r0"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"1", "\[Rho]0"}]}], "}"}]}], "}"}], "/.", 
          RowBox[{"dat", "[", "jj", "]"}]}], ")"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}], ",", 
       RowBox[{"Mesh", "\[Rule]", "False"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Show", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ListPolarPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], "/.", 
           RowBox[{"dat", "[", "jj", "]"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"Show", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ListPolarPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "-", 
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "NR"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
           RowBox[{"dat", "[", "jj", "]"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"PolarPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"powSpline", "[", "jj", "]"}], "[", 
          RowBox[{
           RowBox[{"Pi", "/", "2"}], "-", "\[Theta]\[Theta]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "Pi", "]"}], "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]\[Theta]", ",", "0", ",", " ", 
         RowBox[{"Pi", "/", "2"}]}], "}"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"DotDashed", ",", "Black"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}], 
         RowBox[{"(", 
          RowBox[{"r0", "/.", 
           RowBox[{"dat", "[", "jj", "]"}]}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "\[IndentingNewLine]", 
      RowBox[{"\"\<C=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"C", "/.", 
         RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(c\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"\[Rho]C", "/.", 
         RowBox[{"dat", "[", "jj", "]"}]}], "]"}], "<>", 
       "\"\<, \!\(\*SubscriptBox[\(\[CapitalOmega]\), \(0\)]\)=\>\"", "<>", 
       RowBox[{"ToString", "[", "jj", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}], 
   RowBox[{"(*", 
    RowBox[{"Show", " ", "ends"}], " ", "*)"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"jj", ",", "\[CapitalOmega]test"}], "}"}], ",", 
     "\[CapitalOmega]list"}], "}"}], ",", 
   RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6716057341338673`*^9, 3.671605775512643*^9}, {
  3.671614442619452*^9, 3.671614446459779*^9}}],

Cell[BoxData[
 RowBox[{"\[Rho]C", "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.671605806482017*^9, 3.671605809593822*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid1", "=", 
   RowBox[{"Show", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPolarPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "-", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}], "/.", 
         RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grid2", "=", 
   RowBox[{"Show", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ListPolarPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Pi", "/", "2"}], "-", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"r", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "NR"}], "]"}], "]"}]}], "}"}]}], "}"}], "/.", 
         RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Thin", ",", "Black"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}]}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"dp", ",", "grid1", ",", "grid2", ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"\"\<NT=\>\"", "<>", 
     RowBox[{"ToString", "[", "NT", "]"}], "<>", "\"\<\\tNR=\>\"", "<>", 
     RowBox[{"ToString", "[", "NR", "]"}], "<>", "\"\<\\tNL=\>\"", "<>", 
     RowBox[{"ToString", "[", "NL", "]"}], "<>", 
     "\"\<\\t\[CapitalOmega]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[CapitalOmega]test", "]"}]}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], 
     RowBox[{"(", 
      RowBox[{"r0", "/.", 
       RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ")"}]}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"2", "/", "3"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omega", ",", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", 
         RowBox[{"R", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "/.", 
      RowBox[{"dat", "[", "omega", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6716406876046143`*^9, 3.6716406919002323`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", " ", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omega", ",", "K"}], "}"}], "/.", 
      RowBox[{"dat", "[", "omega", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671640696932671*^9, 3.671640701294527*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalOmega]0", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"jomega", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"omega", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Pi", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], "]"}], 
              RowBox[{"\[CapitalDelta]\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "4"}], " ", 
              RowBox[{"\[CapitalDelta]r", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", 
              "\[IndentingNewLine]", 
              RowBox[{"\[CapitalOmega]", "[", "  ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"dat", "[", "omega", "]"}]}], ")"}], "/.", 
        RowBox[{"\[CapitalOmega]0", "\[Rule]", "omega"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], "//", 
   "Interpolation"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"NMaximize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"jomega", "[", "x", "]"}], ",", 
     RowBox[{"0.3", "<", "x", "<", "0.5"}]}], "}"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.671614334420436*^9, 3.6716143933040237`*^9}, {
  3.671622651048533*^9, 3.671622651480205*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"jomega", "'"}], ",", " ", 
    RowBox[{"{", "0.41", "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6715445556253242`*^9, 3.671544556113021*^9}}],

Cell[BoxData[
 RowBox[{"jomega", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.671544558098588*^9, 3.671544561024921*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"omega", ",", 
       RowBox[{"jomega", "[", "omega", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671618934321446*^9, 3.67161894132927*^9}, {
  3.6716407203641357`*^9, 3.67164072359844*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalOmega]0", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[CapitalOmega]test", "=", "0.0"}]], "Input",
 CellChangeTimes->{{3.671618982642025*^9, 3.671618988288715*^9}}],

Cell[BoxData[
 RowBox[{"Ek", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Pi", " ", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", 
           RowBox[{"[", "l", "]"}], "]"}], "]"}], 
         RowBox[{"\[CapitalDelta]\[Theta]", "[", 
          RowBox[{"[", "l", "]"}], "]"}], " ", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "4"}], " ", 
         RowBox[{"\[CapitalDelta]r", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]", 
         "*", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "m"}], "]"}], "]"}], "*", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalOmega]", "[", "  ", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"l", ",", "m"}], "]"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}], "^", "2"}]}], 
        " ", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
     RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ")"}], "/.", 
   RowBox[{
   "\[CapitalOmega]0", "\[Rule]", "\[CapitalOmega]test"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Eg", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "2", "Pi", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Pi", " ", "G", " ", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "l", "]"}], "]"}], "]"}], 
              RowBox[{"\[CapitalDelta]\[Theta]", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
              RowBox[{"\[CapitalDelta]r", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", 
              "\[IndentingNewLine]", 
              RowBox[{"kernel", "[", " ", 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"r", "[", 
                 RowBox[{"[", 
                  RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
                RowBox[{"Cos", "[", 
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
              "\[IndentingNewLine]", "*", 
              RowBox[{"\[Rho]", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
          RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], 
        RowBox[{"\[CapitalDelta]\[Theta]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "^", "2"}], " ", 
        RowBox[{"\[CapitalDelta]r", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], ")"}], "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.67154554977172*^9, 3.671545584419565*^9, {3.671545679891004*^9, 
   3.671545680562449*^9}, 3.671546872140182*^9, 3.6715513674849787`*^9, 
   3.6715545473191757`*^9, {3.671618970682682*^9, 3.671618970962199*^9}, {
   3.6716196041263237`*^9, 3.671619610221833*^9}, {3.671619673621903*^9, 
   3.671619674789584*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Eg", "=", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"Pi", "^", "2"}], "G", " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"[", "l", "]"}], "]"}], "]"}], 
        RowBox[{"\[CapitalDelta]\[Theta]", "[", 
         RowBox[{"[", "l", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
        RowBox[{"\[CapitalDelta]r", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]", 
        RowBox[{"kernel", "[", " ", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "]"}], ",", "NL"}], "]"}], 
        "\[IndentingNewLine]", "*", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], 
        RowBox[{"\[CapitalDelta]\[Theta]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "^", "2"}], " ", 
        RowBox[{"\[CapitalDelta]r", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "NR"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
    RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.671619452920059*^9, 3.6716195311263933`*^9}, {
  3.671619643142956*^9, 3.671619683397438*^9}, {3.671619886452093*^9, 
  3.671619887195813*^9}}],

Cell[BoxData[
 RowBox[{"%", "-", "%%"}]], "Input",
 CellChangeTimes->{{3.671619547702474*^9, 3.671619548388895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pi", " ", "\[Rho]C", " ", "\[CapitalPhi]0"}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"pV", "=", 
  RowBox[{
   RowBox[{"2", "Pi", "*", "3", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"K", " ", 
       RowBox[{
        RowBox[{"\[Rho]", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "^", "2"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], 
       RowBox[{"\[CapitalDelta]\[Theta]", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], "^", "2"}], " ", 
       RowBox[{"\[CapitalDelta]r", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "NT"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{"pV", "-", "Eg"}], ")"}]], "Input",
 CellChangeTimes->{{3.671619586452959*^9, 3.67161958902063*^9}, {
   3.6716196961321707`*^9, 3.671619714299871*^9}, 3.671619866275118*^9}],

Cell[BoxData[
 RowBox[{"%", "/", "%%"}]], "Input",
 CellChangeTimes->{{3.671619597272305*^9, 3.671619597660572*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"4", "/", "3"}], " ", "Pi", " ", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "^", "3"}], " ", "\[Rho]C", " ", 
   "\[CapitalPhi]0"}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.6716197341928473`*^9, 3.671619745267685*^9}, {
  3.671619780987866*^9, 3.671619801795001*^9}, {3.671619834211213*^9, 
  3.671619839787137*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Pi", " ", 
   RowBox[{"Sum", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{"[", "l", "]"}], "]"}], "]"}], 
      RowBox[{"\[CapitalDelta]\[Theta]", "[", 
       RowBox[{"[", "l", "]"}], "]"}], " ", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"[", 
         RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
      RowBox[{"\[CapitalDelta]r", "[", 
       RowBox[{"[", 
        RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]", 
      "*", 
      RowBox[{"\[Rho]", "[", 
       RowBox[{"[", 
        RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.671544082716539*^9, 3.671544087028166*^9}}],

Cell[BoxData["M"], "Input",
 CellChangeTimes->{{3.671544090387138*^9, 3.67154409430781*^9}, 
   3.6715441274048367`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pi", " ", "\[Rho]C", " ", "\[CapitalPhi]0"}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.6716192528228903`*^9, 3.671619254534994*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pV", "-", "Eg"}], ")"}], "/", "Pi"}], "/", "\[Rho]C"}], "/", 
   "\[CapitalPhi]0"}], "/.", 
  RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}]], "Input",
 CellChangeTimes->{{3.6715469494089127`*^9, 3.671546974264543*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "Ek"}], "-", " ", "Eg", "+", "pV"}]], "Input"],

Cell[BoxData[
 RowBox[{"%", "/", "Eg"}]], "Input"],

Cell[BoxData[
 RowBox[{"Ek", "/", "Eg"}]], "Input"],

Cell[BoxData["  "], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/", 
    RowBox[{"R", "\[LeftDoubleBracket]", 
     RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "/.", 
   RowBox[{"dat", "[", "\[CapitalOmega]test", "]"}]}], "//", 
  "FullForm"}]], "Input",
 CellChangeTimes->{{3.67154446669401*^9, 3.671544491881463*^9}, {
  3.671551407754929*^9, 3.671551409410531*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "equatorialForce", "]"}]], "Input",
 CellChangeTimes->{{3.671616839214283*^9, 3.671616841158983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equatorialForce", "[", "omega_", "]"}], ":=", 
  RowBox[{
   RowBox[{"equatorialForce", "[", "omega", "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"2", " ", "Pi", " ", "G", " ", 
     RowBox[{"Sum", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", 
          RowBox[{"[", "l", "]"}], "]"}], "]"}], 
        RowBox[{"\[CapitalDelta]\[Theta]", "[", 
         RowBox[{"[", "l", "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"[", 
           RowBox[{"l", ",", "m"}], "]"}], "]"}], "^", "2"}], " ", 
        RowBox[{"\[CapitalDelta]r", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}], " ", "\[IndentingNewLine]", 
        RowBox[{"kernel5Da", "[", " ", 
         RowBox[{
          RowBox[{"R\[Alpha]Eri", "/", "Rsun"}], " ", ",", "0", ",", 
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"l", ",", "m"}], "]"}], "]"}], ",", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "l", "]"}], "]"}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", "*", 
        RowBox[{"\[Rho]", "[", 
         RowBox[{"[", 
          RowBox[{"l", ",", "m"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "NT"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "NR"}], "}"}]}], "]"}]}], "/.", 
    RowBox[{"dat", "[", "omega", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.671615934770514*^9, 3.671615938406063*^9}, {
   3.671615974172858*^9, 3.6716160244926243`*^9}, {3.671616807808474*^9, 
   3.671616821784053*^9}, {3.671619318807563*^9, 3.671619319103064*^9}, {
   3.671620009651362*^9, 3.671620014906416*^9}, 3.671620051314907*^9, {
   3.6716201408583508`*^9, 3.671620142457803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalOmega]test", "^", "2"}], " ", 
  RowBox[{"R", "[", 
   RowBox[{"[", 
    RowBox[{"-", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6716162499448147`*^9, 3.671616255739215*^9}}],

Cell[BoxData[
 RowBox[{"equatorialForce", "[", "0.0", "]"}]], "Input",
 CellChangeTimes->{{3.671616849807605*^9, 3.67161685475097*^9}, {
  3.671619927402824*^9, 3.6716199295863857`*^9}, {3.671620127505501*^9, 
  3.671620128953102*^9}, {3.671622709103887*^9, 3.671622710111596*^9}}],

Cell[BoxData[
 RowBox[{"%", "<", "%%"}]], "Input",
 CellChangeTimes->{{3.671616326745903*^9, 3.671616328594603*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"omega", ",", 
       RowBox[{"equatorialForce", "[", "omega", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671616729867611*^9, 3.671616753776699*^9}, {
  3.671616873816136*^9, 3.671616881159198*^9}, {3.671640753764428*^9, 
  3.6716407573476954`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"omega", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"omega", "^", "2"}]}], " ", 
        RowBox[{"R", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671617384696472*^9, 3.671617436307478*^9}, {
  3.6716174772199173`*^9, 3.671617479483265*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"%", ",", "%%"}], "]"}]], "Input",
 CellChangeTimes->{{3.671617449328719*^9, 3.671617451042966*^9}}],

Cell[BoxData[
 RowBox[{"fC", "=", 
  RowBox[{"Interpolation", "[", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"omega", ",", 
       RowBox[{"equatorialForce", "[", "omega", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omega", ",", "\[CapitalOmega]list"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.671621268180331*^9, 3.67162127576134*^9}, {
  3.671621325466374*^9, 3.6716213397529583`*^9}}],

Cell[BoxData[
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fC", "[", "omega", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"omega", "^", "2"}]}], " ", 
     RowBox[{"R\[Alpha]Eri", "/", "Rsun"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"omega", ",", "0.3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.671621343104491*^9, 3.6716213746014433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"jomega", "'"}], ",", " ", 
    RowBox[{"{", "0.31", "}"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.671621399176526*^9, 3.671621399480394*^9}}],

Cell[BoxData[
 RowBox[{"G", " ", 
  RowBox[{"M", "/", 
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], "^", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.671617219627578*^9, 3.671617241724633*^9}}],

Cell[BoxData[
 RowBox[{"equatorialForce", "[", "0.0", "]"}]], "Input",
 CellChangeTimes->{{3.671617302990974*^9, 3.671617305420066*^9}}],

Cell[BoxData[
 RowBox[{"%", "+", "%%"}]], "Input",
 CellChangeTimes->{{3.671617343827739*^9, 3.671617344595418*^9}, {
  3.671620166385038*^9, 3.67162016704074*^9}}]
},
WindowSize->{2554, 1500},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>1.5 Inherited,
FrontEndVersion->"10.4 for Linux x86 (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 217, 4, 46, "Input"],
Cell[777, 26, 1386, 27, 377, "Input"],
Cell[2166, 55, 168, 3, 46, "Input"],
Cell[2337, 60, 966, 26, 107, "Input"],
Cell[3306, 88, 519, 13, 46, "Input"],
Cell[3828, 103, 112, 1, 46, "Input"],
Cell[3943, 106, 106, 1, 46, "Input"],
Cell[4052, 109, 276, 6, 46, "Input"],
Cell[4331, 117, 340, 8, 46, "Input"],
Cell[4674, 127, 94, 3, 46, "Input"],
Cell[4771, 132, 647, 14, 77, "Input"],
Cell[5421, 148, 673, 15, 46, "Input"],
Cell[6097, 165, 1045, 22, 107, "Input"],
Cell[7145, 189, 405, 11, 46, "Input"],
Cell[7553, 202, 696, 19, 77, "Input"],
Cell[8252, 223, 325, 10, 46, "Input"],
Cell[8580, 235, 292, 9, 46, "Input"],
Cell[8875, 246, 309, 8, 46, "Input"],
Cell[9187, 256, 61, 1, 46, "Input"],
Cell[9251, 259, 551, 16, 46, "Input"],
Cell[9805, 277, 614, 19, 46, "Input"],
Cell[10422, 298, 523, 15, 46, "Input"],
Cell[10948, 315, 583, 17, 46, "Input"],
Cell[11534, 334, 896, 24, 77, "Input"],
Cell[12433, 360, 1121, 26, 46, "Input"],
Cell[13557, 388, 406, 10, 46, "Input"],
Cell[13966, 400, 503, 13, 46, "Input"],
Cell[14472, 415, 453, 13, 46, "Input"],
Cell[14928, 430, 124, 2, 46, "Input"],
Cell[15055, 434, 94, 1, 46, "Input"],
Cell[15152, 437, 92, 1, 46, "Input"],
Cell[15247, 440, 1651, 40, 46, "Input"],
Cell[16901, 482, 325, 8, 46, "Input"],
Cell[17229, 492, 436, 11, 46, "Input"],
Cell[17668, 505, 466, 13, 46, "Input"],
Cell[18137, 520, 1158, 27, 107, "Input"],
Cell[19298, 549, 504, 10, 46, "Input"],
Cell[19805, 561, 651, 17, 46, "Input"],
Cell[20459, 580, 736, 16, 46, "Input"],
Cell[21198, 598, 279, 8, 46, "Input"],
Cell[21480, 608, 610, 14, 81, "Input"],
Cell[22093, 624, 1095, 28, 61, "Input"],
Cell[23191, 654, 135, 2, 46, "Input"],
Cell[23329, 658, 280, 7, 46, "Input"],
Cell[23612, 667, 2789, 66, 377, "Input"],
Cell[26404, 735, 81, 1, 46, "Input"],
Cell[26488, 738, 64, 1, 46, "Input"],
Cell[26555, 741, 106, 1, 46, "Input"],
Cell[26664, 744, 140, 3, 46, "Input"],
Cell[26807, 749, 1119, 28, 107, "Input"],
Cell[27929, 779, 845, 24, 107, "Input"],
Cell[28777, 805, 975, 28, 107, "Input"],
Cell[29755, 835, 929, 27, 107, "Input"],
Cell[30687, 864, 923, 27, 107, "Input"],
Cell[31613, 893, 931, 27, 107, "Input"],
Cell[32547, 922, 1894, 45, 137, "Input"],
Cell[34444, 969, 1121, 30, 137, "Input"],
Cell[35568, 1001, 926, 26, 107, "Input"],
Cell[36497, 1029, 958, 24, 107, "Input"],
Cell[37458, 1055, 925, 22, 107, "Input"],
Cell[38386, 1079, 659, 16, 77, "Input"],
Cell[39048, 1097, 219, 5, 46, "Input"],
Cell[39270, 1104, 397, 12, 46, "Input"],
Cell[39670, 1118, 176, 3, 46, "Input"],
Cell[39849, 1123, 1935, 47, 107, "Input"],
Cell[41787, 1172, 5269, 118, 587, "Input"],
Cell[47059, 1292, 294, 6, 46, "Input"],
Cell[47356, 1300, 1819, 48, 77, "Input"],
Cell[49178, 1350, 229, 6, 46, "Input"],
Cell[49410, 1358, 489, 10, 46, "Input"],
Cell[49902, 1370, 227, 6, 46, "Input"],
Cell[50132, 1378, 1327, 28, 46, "Input"],
Cell[51462, 1408, 990, 28, 197, "Input"],
Cell[52455, 1438, 765, 15, 46, "Input"],
Cell[53223, 1455, 167, 4, 46, "Input"],
Cell[53393, 1461, 211, 5, 46, "Input"],
Cell[53607, 1468, 169, 4, 46, "Input"],
Cell[53779, 1474, 671, 18, 46, "Input"],
Cell[54453, 1494, 188, 5, 46, "Input"],
Cell[54644, 1501, 449, 11, 46, "Input"],
Cell[55096, 1514, 540, 12, 46, "Input"],
Cell[55639, 1528, 324, 9, 46, "Input"],
Cell[55966, 1539, 605, 12, 46, "Input"],
Cell[56574, 1553, 182, 4, 46, "Input"],
Cell[56759, 1559, 129, 2, 46, "Input"],
Cell[56891, 1563, 225, 5, 46, "Input"],
Cell[57119, 1570, 145, 2, 46, "Input"],
Cell[57267, 1574, 174, 5, 46, "Input"],
Cell[57444, 1581, 525, 10, 46, "Input"],
Cell[57972, 1593, 237, 6, 46, "Input"],
Cell[58212, 1601, 364, 9, 46, "Input"],
Cell[58579, 1612, 168, 4, 46, "Input"],
Cell[58750, 1618, 192, 5, 46, "Input"],
Cell[58945, 1625, 167, 4, 46, "Input"],
Cell[59115, 1631, 172, 4, 46, "Input"],
Cell[59290, 1637, 417, 9, 46, "Input"],
Cell[59710, 1648, 179, 3, 46, "Input"],
Cell[59892, 1653, 1704, 51, 77, "Input"],
Cell[61599, 1706, 207, 6, 46, "Input"],
Cell[61809, 1714, 240, 6, 46, "Input"],
Cell[62052, 1722, 309, 5, 46, "Input"],
Cell[62364, 1729, 438, 10, 46, "Input"],
Cell[62805, 1741, 894, 25, 46, "Input"],
Cell[63702, 1768, 390, 6, 46, "Input"],
Cell[64095, 1776, 196, 3, 46, "Input"],
Cell[64294, 1781, 139, 2, 46, "Input"],
Cell[64436, 1785, 4896, 110, 467, "Input"],
Cell[69335, 1897, 137, 2, 46, "Input"],
Cell[69475, 1901, 148, 2, 46, "Input"],
Cell[69626, 1905, 139, 2, 46, "Input"],
Cell[69768, 1909, 4972, 111, 467, "Input"],
Cell[74743, 2022, 77, 1, 46, "Input"],
Cell[74823, 2025, 189, 3, 46, "Input"],
Cell[75015, 2030, 130, 2, 46, "Input"],
Cell[75148, 2034, 1357, 23, 46, "Input"],
Cell[76508, 2059, 318, 5, 46, "Input"],
Cell[76829, 2066, 134, 2, 46, "Input"],
Cell[76966, 2070, 884, 20, 107, "Input"],
Cell[77853, 2092, 269, 4, 46, "Input"],
Cell[78125, 2098, 408, 10, 46, "Input"],
Cell[78536, 2110, 414, 11, 46, "Input"],
Cell[78953, 2123, 124, 3, 46, "Input"],
Cell[79080, 2128, 1203, 35, 46, "Input"],
Cell[80286, 2165, 1199, 31, 46, "Input"],
Cell[81488, 2198, 2234, 61, 77, "Input"],
Cell[83725, 2261, 341, 8, 46, "Input"],
Cell[84069, 2271, 363, 9, 46, "Input"],
Cell[84435, 2282, 372, 10, 46, "Input"],
Cell[84810, 2294, 320, 8, 46, "Input"],
Cell[85133, 2304, 73, 1, 46, "Input"],
Cell[85209, 2307, 895, 22, 46, "Input"],
Cell[86107, 2331, 593, 17, 46, "Input"],
Cell[86703, 2350, 1006, 17, 46, "Input"],
Cell[87712, 2369, 798, 13, 46, "Input"],
Cell[88513, 2384, 870, 21, 77, "Input"],
Cell[89386, 2407, 2684, 69, 167, "Input"],
Cell[92073, 2478, 2747, 52, 167, "Input"],
Cell[94823, 2532, 577, 16, 46, "Input"],
Cell[95403, 2550, 1201, 24, 46, "Input"],
Cell[96607, 2576, 1063, 30, 77, "Input"],
Cell[97673, 2608, 393, 7, 46, "Input"],
Cell[98069, 2617, 759, 13, 46, "Input"],
Cell[98831, 2632, 740, 17, 46, "Input"],
Cell[99574, 2651, 787, 18, 46, "Input"],
Cell[100364, 2671, 366, 11, 46, "Input"],
Cell[100733, 2684, 224, 6, 46, "Input"],
Cell[100960, 2692, 489, 14, 46, "Input"],
Cell[101452, 2708, 193, 5, 46, "Input"],
Cell[101648, 2715, 631, 19, 46, "Input"],
Cell[102282, 2736, 1232, 30, 46, "Input"],
Cell[103517, 2768, 7907, 195, 1097, "Input"],
Cell[111427, 2965, 170, 3, 46, "Input"],
Cell[111600, 2970, 1081, 29, 46, "Input"],
Cell[112684, 3001, 1000, 28, 46, "Input"],
Cell[113687, 3031, 950, 23, 77, "Input"],
Cell[114640, 3056, 692, 19, 46, "Input"],
Cell[115335, 3077, 500, 13, 46, "Input"],
Cell[115838, 3092, 73, 1, 46, "Input"],
Cell[115914, 3095, 1928, 48, 167, "Input"],
Cell[117845, 3145, 330, 9, 46, "Input"],
Cell[118178, 3156, 262, 7, 46, "Input"],
Cell[118443, 3165, 125, 2, 46, "Input"],
Cell[118571, 3169, 519, 13, 46, "Input"],
Cell[119093, 3184, 73, 1, 46, "Input"],
Cell[119169, 3187, 135, 2, 46, "Input"],
Cell[119307, 3191, 1554, 41, 167, "Input"],
Cell[120864, 3234, 3252, 77, 227, "Input"],
Cell[124119, 3313, 2520, 65, 137, "Input"],
Cell[126642, 3380, 116, 2, 46, "Input"],
Cell[126761, 3384, 151, 3, 46, "Input"],
Cell[126915, 3389, 981, 26, 46, "Input"],
Cell[127899, 3417, 213, 4, 46, "Input"],
Cell[128115, 3423, 116, 2, 46, "Input"],
Cell[128234, 3427, 472, 12, 46, "Input"],
Cell[128709, 3441, 1026, 27, 137, "Input"],
Cell[129738, 3470, 120, 2, 46, "Input"],
Cell[129861, 3474, 219, 4, 46, "Input"],
Cell[130083, 3480, 317, 9, 46, "Input"],
Cell[130403, 3491, 90, 2, 46, "Input"],
Cell[130496, 3495, 50, 1, 46, "Input"],
Cell[130549, 3498, 51, 1, 46, "Input"],
Cell[130603, 3501, 28, 0, 46, "Input"],
Cell[130634, 3503, 430, 10, 46, "Input"],
Cell[131067, 3515, 138, 2, 46, "Input"],
Cell[131208, 3519, 1887, 44, 167, "Input"],
Cell[133098, 3565, 230, 6, 46, "Input"],
Cell[133331, 3573, 281, 4, 46, "Input"],
Cell[133615, 3579, 116, 2, 46, "Input"],
Cell[133734, 3583, 602, 14, 77, "Input"],
Cell[134339, 3599, 605, 17, 46, "Input"],
Cell[134947, 3618, 147, 3, 46, "Input"],
Cell[135097, 3623, 497, 12, 107, "Input"],
Cell[135597, 3637, 390, 11, 46, "Input"],
Cell[135990, 3650, 260, 7, 46, "Input"],
Cell[136253, 3659, 240, 7, 46, "Input"],
Cell[136496, 3668, 136, 2, 46, "Input"],
Cell[136635, 3672, 164, 3, 46, "Input"]
}
]
*)

